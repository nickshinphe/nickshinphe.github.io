{"version":3,"sources":["webpack://phenix/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://phenix/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://phenix/./node_modules/@babel/runtime/helpers/createClass.js","webpack://phenix/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://phenix/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPrimitive.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPropertyKey.js","webpack://phenix/./node_modules/@babel/runtime/helpers/typeof.js","webpack://phenix/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://phenix/./src/dom/BrowserDetector.ts","webpack://phenix/./src/sdk/transformation/SurrogateFrameDataPerCodec.ts","webpack://phenix/./src/sdk/transformation/WorkerTransformStream.ts"],"names":["module","exports","arr","len","length","i","arr2","Array","__esModule","arrayLikeToArray","isArray","instance","Constructor","TypeError","toPropertyKey","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","obj","value","iter","Symbol","iterator","from","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","_typeof","t","r","e","toPrimitive","call","String","Number","o","constructor","minLen","n","toString","slice","name","test","BrowserDetector","_classCallCheck","_createClass","get","_browserNameAndVersion","this","_browserName","_browserMajorVersion","_isChrome69","_isChrome70","_isChrome71","_isChrome72","_isChrome74","_isChrome75","_isChrome76","_isChrome77","_navigator","navigator","userAgent","browserNameAndVersion","match","_browserNameAndVersionRegex","parseBrowserNameAndVersionForIE","browserNameList","split","browserVersionList","fullVersion","msie","indexOf","concat","parseInt","substring","version","_class","_defineProperty","parseBrowserNameAndVersion","parseBrowserName","parseBrowserMajorVersion","includes","_dummy2x2VideoIFramePerCodec","H264","Uint8Array","VP8","VP9","_dummy2x2VideoPFramePerCodec","_dummy82x82H264","IFrame","_toConsumableArray","fill","PFrame","_dummy82x82H264PFrameFrameNumberIndex","_dummyAudioSilentPerCodec","opus","_singleZeroByte","_isAndroidChrome","browserName","_isMobileChrome","_navigator2","_navigator3","_isSafari","_use82x82Frames","_pFrameNumber","_requestForIFrame","invalidFrame","codec","type","skipEnqueue","buffer","setDummy82x82H264PFrameAndIncrementFrameNumber","byte1","byte2","self","onmessage","event","WorkerTransformStream","forceInvalidFrame","data","RTCTransformEvent","onrtctransform","transformer","options","transformFunction","kind","videoTransformFunction","audioTransformFunction","transformStream","TransformStream","transform","source","readable","sink","pipeThrough","pipeTo","Error","chunk","controller","postMessage","timestamp","surrogate","surrogateVideoIFramePerCodec","undefined","surrogateVideoPFramePerCodec","enqueue","surrogateAudioSilentPerCodec"],"mappings":"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","file":"745.js","sourcesContent":["function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport default class BrowserDetector {\n  private static readonly _browserNameAndVersionRegex = /(MSIE|(?!Gecko.+)Firefox|(?!AppleWebKit.+Chrome.+)Safari|(?!AppleWebKit.+)Chrome|AppleWebKit(?!.+Chrome|.+Safari)|Gecko(?!.+Firefox))(?: |\\/)([\\d.apre]+)/g;\n  private static readonly _browserNameAndVersion = BrowserDetector.parseBrowserNameAndVersion();\n  private static readonly _browserName = BrowserDetector.parseBrowserName();\n  private static readonly _browserMajorVersion = BrowserDetector.parseBrowserMajorVersion();\n\n  private static readonly _isChrome69 = BrowserDetector._browserNameAndVersion.includes('Chrome/69.');\n  private static readonly _isChrome70 = BrowserDetector._browserNameAndVersion.includes('Chrome/70.');\n  private static readonly _isChrome71 = BrowserDetector._browserNameAndVersion.includes('Chrome/71.');\n  private static readonly _isChrome72 = BrowserDetector._browserNameAndVersion.includes('Chrome/72.');\n  private static readonly _isChrome74 = BrowserDetector._browserNameAndVersion.includes('Chrome/74.');\n  private static readonly _isChrome75 = BrowserDetector._browserNameAndVersion.includes('Chrome/75.');\n  private static readonly _isChrome76 = BrowserDetector._browserNameAndVersion.includes('Chrome/76.');\n  private static readonly _isChrome77 = BrowserDetector._browserNameAndVersion.includes('Chrome/77.');\n\n  static get browserNameAndVersion(): string {\n    return BrowserDetector._browserNameAndVersion;\n  }\n\n  static get browserName(): string {\n    return this._browserName;\n  }\n\n  static get browserMajorVersion(): number {\n    return this._browserMajorVersion;\n  }\n\n  static get isChrome69(): boolean {\n    return BrowserDetector._isChrome69;\n  }\n\n  static get isChrome70(): boolean {\n    return BrowserDetector._isChrome70;\n  }\n\n  static get isChrome71(): boolean {\n    return BrowserDetector._isChrome71;\n  }\n\n  static get isChrome72(): boolean {\n    return BrowserDetector._isChrome72;\n  }\n\n  static get isChrome74(): boolean {\n    return BrowserDetector._isChrome74;\n  }\n\n  static get isChrome75(): boolean {\n    return BrowserDetector._isChrome75;\n  }\n\n  static get isChrome76(): boolean {\n    return BrowserDetector._isChrome76;\n  }\n\n  static get isChrome77(): boolean {\n    return BrowserDetector._isChrome77;\n  }\n\n  static isMobile(): boolean {\n    return (/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini/i).test(navigator?.userAgent);\n  }\n\n  private static parseBrowserNameAndVersion(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const browserNameAndVersion = navigator.userAgent.match(BrowserDetector._browserNameAndVersionRegex);\n\n    if (browserNameAndVersion && browserNameAndVersion[0]) {\n      return browserNameAndVersion[0];\n    }\n\n    return BrowserDetector.parseBrowserNameAndVersionForIE();\n  }\n\n  private static parseBrowserName(): string {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return '';\n    }\n\n    const browserNameList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserNameList || !browserNameList[0]) {\n      return '';\n    }\n\n    return browserNameList[0];\n  }\n\n  private static parseBrowserMajorVersion(): number {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return 0;\n    }\n\n    const browserVersionList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserVersionList || !browserVersionList[1]) {\n      return 0;\n    }\n\n    const fullVersion = browserVersionList[1];\n\n    if (!fullVersion) {\n      return 0;\n    }\n\n    return Number(fullVersion.split('.')[0]) || 0;\n  }\n\n  private static parseBrowserNameAndVersionForIE(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const userAgent = navigator.userAgent;\n    const msie = userAgent.indexOf('MSIE ');\n\n    if (msie > 0) {\n      // IE 10 or older => return version number\n      return `IE/${parseInt(userAgent.substring(msie + 5, userAgent.indexOf('.', msie)), 10)}`;\n    }\n\n    const trident = userAgent.indexOf('Trident/');\n\n    if (trident > 0) {\n      // IE 11 => return version number\n      const version = userAgent.indexOf('rv:');\n\n      return `IE/${parseInt(userAgent.substring(version + 3, userAgent.indexOf('.', version)), 10)}`;\n    }\n\n    return '';\n  }\n}","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport BrowserDetector from '../../dom/BrowserDetector';\n\nexport type SurrogateFrameType = {\n  skipEnqueue: boolean;\n  buffer?: ArrayBuffer | undefined;\n};\n\nconst _dummy2x2VideoIFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x67, 0xf4, 0x00, 0x0a, 0x91, 0x9b, 0x2b, 0xf1, 0xf1, 0xf8, 0x08, 0x80, 0x00, 0x00, 0x03, 0x00, 0x80, 0x00, 0x00, 0x19, 0x07, 0x89, 0x12, 0xcb, // Sequence parameter set\n    0x00, 0x00, 0x00, 0x01, 0x68, 0xeb, 0xe3, 0xc4, 0x48, 0x44, // Picture paramter set\n    /* */ 0x00, 0x00, 0x01, 0x65, 0x88, 0x82, 0x00, 0x3f, 0x70, 0x23, 0x86, 0xe6, 0xd1, 0x80, 0x09, 0xaf, 0x0a, 0x41, 0x66, 0x6b, 0x54, 0x46, 0xfb, 0x71, 0xd9, 0x7f, 0xff, 0xff, 0xf9]), // Slice layer: idr data\n  VP8: new Uint8Array([0xb0, 0x02, 0x00, 0x9d, 0x01, 0x2a, 0x01, 0x00, 0x01, 0x00, 0x39, 0x6b, 0x00, 0x27, 0x1c, 0x24, 0x0c, 0x2c, 0x2c, 0x44, 0xcc, 0x24, 0x41, 0xa8, 0x00, 0x13, 0xa7, 0xa3, 0x7a, 0x50, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x82, 0x49, 0x83, 0x42, 0x00, 0x00, 0x00, 0x00, 0x06, 0x76, 0x38, 0x24, 0x1c, 0x19, 0xa0, 0x00, 0x00, 0x20, 0x40, 0x00, 0x11, 0xbf, 0xdd, 0x77, 0xff, 0x40, 0x7f, 0xb1, 0x00])\n};\nconst _dummy2x2VideoPFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x68, 0x49, 0xa8, 0x41, 0x68, 0x99, 0x4c, 0x0f, 0xff, 0x92, 0x81]), // Slice layer: non idr data\n  VP8: new Uint8Array([0x31, 0x03, 0x00, 0xe4, 0xe0, 0xa8, 0x9b, 0x37, 0xaf, 0x10, 0x4f, 0x4f, 0xb1, 0x0a, 0x2f, 0xe4, 0x92, 0xc0, 0x1f, 0xe7, 0x4f, 0x46, 0xff, 0xee, 0x51, 0xc1, 0x5d, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x86, 0x00, 0x40, 0x92, 0x9c, 0x24, 0x48, 0x00, 0x00, 0x03, 0x70, 0x00, 0x00, 0x4b, 0x40])\n};\nconst _dummy82x82H264 = {\n  IFrame: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x67, 0x42, 0xc0, 0x0d, 0xda, 0x18, 0xde, 0x22, 0x22, 0x10, 0x00, 0x00, 0x03, 0x00, 0x10, 0x00, 0x00, 0x03, 0x03, 0xc8, 0xf1, 0x42, 0xaa, // Sequence parameter set\n    0x00, 0x00, 0x00, 0x01, 0x68, 0xce, 0x0f, 0xc8, // Picture parameter set\n    0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0x5f, ...new Uint8Array(10295).fill(0xff), 0x80, // Supplemental enhancement information (SEI)\n    0x00, 0x00, 0x00, 0x01, 0x65, 0x88, 0x84, 0x05, ...new Uint8Array(3).fill(0xff), 0x0f, 0x45, 0x00, 0x01, 0x57, 0x9f, 0x27, 0x27, 0x27, 0x27, 0x27, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x78]), // Slice layer: Idr data\n  PFrame: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0xa4, ...new Uint8Array(10364).fill(0xff), 0x80, // SEI\n    0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x20, 0x15, 0xf0, 0x4b]) // Slice layer: non idr data\n};\nconst _dummy82x82H264PFrameFrameNumberIndex = 10418;\nconst _dummyAudioSilentPerCodec = {opus: new Uint8Array([0x68, 0x07, 0xd9, 0xab, 0xbc, 0x79, 0x87, 0xab, 0x8e, 0x4a, 0x14, 0xf3, 0xa7, 0x1c, 0xf2, 0x9a, 0x7a, 0x45, 0xa7, 0x2d, 0x44, 0x25, 0x74, 0x4c, 0xad, 0x16, 0xb3, 0x0e, 0x51, 0x57, 0xea, 0xe7, 0xad, 0x2a, 0x38, 0xce, 0x33])};\nconst _singleZeroByte = new Uint8Array([0x00]);\nconst _isAndroidChrome = BrowserDetector.browserName === 'Chrome' && (/Android/i).test(navigator?.userAgent);\nconst _isMobileChrome = BrowserDetector.browserName === 'Chrome' && ((/Android/i).test(navigator?.userAgent) || (/IPhone/i).test(navigator?.userAgent));\nconst _isSafari = BrowserDetector.browserName === 'Safari';\nconst _use82x82Frames = _isMobileChrome || _isSafari;\nconst _pFrameNumberReset = 1;\nlet _pFrameNumber = _pFrameNumberReset;\nlet _requestForIFrame = false;\n\nfunction surrogateVideoIFramePerCodec(codec: string) : ArrayBuffer | undefined {\n  switch (codec) {\n    case 'H264': {\n      if (_use82x82Frames) {\n        _requestForIFrame = false;\n        _pFrameNumber = _pFrameNumberReset;\n\n        return _dummy82x82H264['IFrame']['buffer'];\n      }\n\n      // MUST for isMacDesktopChrome\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP8': {\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP9': {\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction surrogateVideoPFramePerCodec(codec: string) : SurrogateFrameType {\n  switch (codec) {\n    case 'H264': {\n      if (_use82x82Frames) {\n        if (_requestForIFrame) {\n          return invalidFrame(codec, 'delta');\n        }\n\n        return setDummy82x82H264PFrameAndIncrementFrameNumber();\n      }\n\n      // MUST for isMacDesktopChrome\n      return {\n        skipEnqueue: false,\n        buffer: _dummy2x2VideoPFramePerCodec[codec]['buffer']\n      };\n    }\n\n    case 'VP8': {\n      return {\n        skipEnqueue: false,\n        buffer: _dummy2x2VideoPFramePerCodec[codec]['buffer']\n      };\n    }\n\n    case 'VP9': {\n      return {\n        skipEnqueue: false,\n        buffer: _dummy2x2VideoPFramePerCodec[codec]['buffer']\n      };\n    }\n\n    default: {\n      return {\n        skipEnqueue: false,\n        buffer: undefined\n      };\n    }\n  }\n}\n\nfunction surrogateAudioSilentPerCodec(codec: string) : ArrayBuffer | undefined {\n  switch (codec) {\n    case 'opus': {\n      return _dummyAudioSilentPerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction invalidFrame(codec: string, type?: string) : SurrogateFrameType {\n  if (codec === 'H264' && (_use82x82Frames)) {\n    if ((type === 'key') || (_pFrameNumber > _pFrameNumberReset)) {\n      _requestForIFrame = false;\n      _pFrameNumber = _pFrameNumberReset;\n\n      if (_isAndroidChrome) {\n        return {skipEnqueue: true};\n      }\n\n      return {\n        skipEnqueue: false,\n        buffer: _singleZeroByte['buffer']\n      };\n    }\n\n    _requestForIFrame = true;\n\n    return setDummy82x82H264PFrameAndIncrementFrameNumber();\n  }\n\n  return {\n    skipEnqueue: false,\n    buffer: _singleZeroByte['buffer']\n  };\n}\n\nfunction setDummy82x82H264PFrameAndIncrementFrameNumber() : SurrogateFrameType {\n  const byte1 = 0x9a | ((_pFrameNumber & 0x0e) >> 1);\n  const byte2 = 0x20 | ((_pFrameNumber & 0x01) << 7);\n  const buffer = _dummy82x82H264['PFrame']['buffer'];\n\n  buffer[_dummy82x82H264PFrameFrameNumberIndex] = byte1;\n  buffer[_dummy82x82H264PFrameFrameNumberIndex + 1] = byte2;\n  _pFrameNumber++;\n\n  return {\n    skipEnqueue: false,\n    buffer\n  };\n}\n\nexport {\n  surrogateVideoIFramePerCodec,\n  surrogateVideoPFramePerCodec,\n  surrogateAudioSilentPerCodec,\n  invalidFrame\n};","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {surrogateVideoIFramePerCodec, surrogateVideoPFramePerCodec, surrogateAudioSilentPerCodec, invalidFrame} from './SurrogateFrameDataPerCodec';\n\ntype TransformStreamPostMessage = {\n  options: {\n    kind: string;\n    codec: string;\n  };\n  readable: ReadableStream;\n  writable: WritableStream;\n};\n\ntype ForceInvalidFramePostMessage = {\n  forceInvalidFrame: boolean;\n};\n\ninterface IResponseWorker {\n  onmessage: (message: MessageEvent<ForceInvalidFramePostMessage>) => void;\n}\n\nconst worker: IResponseWorker = self as IResponseWorker;\n\nworker.onmessage = event => {\n  WorkerTransformStream.forceInvalidFrame = event.data.forceInvalidFrame;\n};\n\nif (self.RTCTransformEvent) {\n  self.onrtctransform = event => {\n    const transformer = event.transformer as TransformStreamPostMessage;\n\n    WorkerTransformStream.codec = transformer.options.codec;\n    WorkerTransformStream.transformFunction = transformer.options.kind === 'video' ? WorkerTransformStream.videoTransformFunction : WorkerTransformStream.audioTransformFunction;\n    WorkerTransformStream.forceInvalidFrame = false;\n\n    const transformStream = new TransformStream({transform: WorkerTransformStream.transformFunction});\n    const source = transformer.readable;\n    const sink = transformer.writable;\n\n    source\n      .pipeThrough(transformStream)\n      .pipeTo(sink);\n  };\n}\n\nclass WorkerTransformStream {\n  static codec: string;\n  static transformFunction: TransformerTransformCallback<AudioData | VideoFrame, TransformStreamDefaultController> | undefined;\n  static forceInvalidFrame: boolean;\n\n  static videoTransformFunction(chunk, controller): void {\n    postMessage({\n      chunk: {\n        type: chunk.type,\n        timestamp: chunk.timestamp,\n        data: chunk.data\n      }\n    });\n\n    if (WorkerTransformStream.forceInvalidFrame) {\n      const surrogate = invalidFrame(WorkerTransformStream.codec, chunk.type);\n\n      WorkerTransformStream.forceInvalidFrame = false;\n\n      if (surrogate.skipEnqueue) {\n        return;\n      }\n\n      chunk.data = surrogate.buffer || chunk.data;\n    } else {\n      if (chunk.type === 'key') {\n        chunk.data = surrogateVideoIFramePerCodec(WorkerTransformStream.codec) || chunk.data;\n      } else {\n        const surrogate = surrogateVideoPFramePerCodec(WorkerTransformStream.codec) || chunk.data;\n\n        if (surrogate.skipEnqueue) {\n          return;\n        }\n\n        chunk.data = surrogate.buffer || chunk.data;\n      }\n    }\n\n    controller.enqueue(chunk);\n  }\n\n  static audioTransformFunction(chunk, controller): void {\n    postMessage({\n      chunk: {\n        timestamp: chunk.timestamp,\n        data: chunk.data\n      }\n    });\n\n    if (WorkerTransformStream.forceInvalidFrame) {\n      WorkerTransformStream.forceInvalidFrame = false;\n      chunk.data = invalidFrame(WorkerTransformStream.codec).buffer || chunk.data;\n    } else {\n      chunk.data = surrogateAudioSilentPerCodec(WorkerTransformStream.codec) || chunk.data;\n    }\n\n    controller.enqueue(chunk);\n  }\n\n  private constructor() {\n    throw new Error('WorkerTransformStream is a static class that may not be instantiated');\n  }\n}\n\nexport {};"],"sourceRoot":""}