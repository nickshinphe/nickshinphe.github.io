{"version":3,"sources":["webpack://phenix/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://phenix/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://phenix/./node_modules/@babel/runtime/helpers/createClass.js","webpack://phenix/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://phenix/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPrimitive.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPropertyKey.js","webpack://phenix/./node_modules/@babel/runtime/helpers/typeof.js","webpack://phenix/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://phenix/./src/dom/BrowserDetector.ts","webpack://phenix/./src/sdk/transformation/SurrogateFrameDataPerCodec.ts","webpack://phenix/./src/sdk/transformation/WorkerTransformStream.ts"],"names":["module","exports","arr","len","length","i","arr2","Array","__esModule","arrayLikeToArray","isArray","instance","Constructor","TypeError","toPropertyKey","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","obj","value","iter","Symbol","iterator","from","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","_typeof","input","hint","prim","toPrimitive","undefined","res","call","String","Number","arg","o","constructor","minLen","n","toString","slice","name","test","BrowserDetector","_classCallCheck","_createClass","get","_browserNameAndVersion","this","_browserName","_browserMajorVersion","_isChrome69","_isChrome70","_isChrome71","_isChrome72","_isChrome74","_isChrome75","_isChrome76","_isChrome77","_isAndroid","_navigator","navigator","userAgent","browserNameAndVersion","match","_browserNameAndVersionRegex","parseBrowserNameAndVersionForIE","browserNameList","split","browserVersionList","fullVersion","msie","indexOf","concat","parseInt","substring","version","_class","_defineProperty","parseBrowserNameAndVersion","parseBrowserName","parseBrowserMajorVersion","includes","_navigator2","SkipFrame","_dummy2x2VideoIFramePerCodec","H264","Uint8Array","VP8","VP9","_dummy2x2VideoPFramePerCodec","_dummy82x82H264","IFrame","_toConsumableArray","fill","PFrame","_dummyAudioSilentPerCodec","opus","_singleZeroByte","_isAndroidChrome","browserName","isAndroid","_isMobileChrome","isMobile","_isSafari","_useCountingFrameNumber","_pFrameFrameNumber","updatePFrameFrameNumber","byte1","byte2","buffer","_dummy82x82H264PFrameFrameNumberIndex","self","onmessage","event","WorkerTransformStream","forceInvalidFrame","data","RTCTransformEvent","onrtctransform","transformer","codec","options","transformFunction","kind","videoTransformFunction","audioTransformFunction","transformStream","TransformStream","transform","source","readable","sink","pipeThrough","pipeTo","Error","chunk","controller","postMessage","type","timestamp","surrogate","getInvalidVideoPFrame","getSurrogateVideoIFramePerCodec","getSurrogateVideoPFramePerCodec","enqueue","getSurrogateAudioSilentPerCodec"],"mappings":"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","file":"745.js","sourcesContent":["function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nmodule.exports = _toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}\nmodule.exports = _toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport default class BrowserDetector {\n  private static readonly _browserNameAndVersionRegex = /(MSIE|(?!Gecko.+)Firefox|(?!AppleWebKit.+Chrome.+)Safari|(?!AppleWebKit.+)Chrome|AppleWebKit(?!.+Chrome|.+Safari)|Gecko(?!.+Firefox))(?: |\\/)([\\d.apre]+)/g;\n  private static readonly _browserNameAndVersion = BrowserDetector.parseBrowserNameAndVersion();\n  private static readonly _browserName = BrowserDetector.parseBrowserName();\n  private static readonly _browserMajorVersion = BrowserDetector.parseBrowserMajorVersion();\n\n  private static readonly _isChrome69 = BrowserDetector._browserNameAndVersion.includes('Chrome/69.');\n  private static readonly _isChrome70 = BrowserDetector._browserNameAndVersion.includes('Chrome/70.');\n  private static readonly _isChrome71 = BrowserDetector._browserNameAndVersion.includes('Chrome/71.');\n  private static readonly _isChrome72 = BrowserDetector._browserNameAndVersion.includes('Chrome/72.');\n  private static readonly _isChrome74 = BrowserDetector._browserNameAndVersion.includes('Chrome/74.');\n  private static readonly _isChrome75 = BrowserDetector._browserNameAndVersion.includes('Chrome/75.');\n  private static readonly _isChrome76 = BrowserDetector._browserNameAndVersion.includes('Chrome/76.');\n  private static readonly _isChrome77 = BrowserDetector._browserNameAndVersion.includes('Chrome/77.');\n\n  private static readonly _isAndroid = (/Android/i).test(navigator?.userAgent);\n\n  static get browserNameAndVersion(): string {\n    return BrowserDetector._browserNameAndVersion;\n  }\n\n  static get browserName(): string {\n    return this._browserName;\n  }\n\n  static get browserMajorVersion(): number {\n    return this._browserMajorVersion;\n  }\n\n  static get isChrome69(): boolean {\n    return BrowserDetector._isChrome69;\n  }\n\n  static get isChrome70(): boolean {\n    return BrowserDetector._isChrome70;\n  }\n\n  static get isChrome71(): boolean {\n    return BrowserDetector._isChrome71;\n  }\n\n  static get isChrome72(): boolean {\n    return BrowserDetector._isChrome72;\n  }\n\n  static get isChrome74(): boolean {\n    return BrowserDetector._isChrome74;\n  }\n\n  static get isChrome75(): boolean {\n    return BrowserDetector._isChrome75;\n  }\n\n  static get isChrome76(): boolean {\n    return BrowserDetector._isChrome76;\n  }\n\n  static get isChrome77(): boolean {\n    return BrowserDetector._isChrome77;\n  }\n\n  static get isAndroid(): boolean {\n    return BrowserDetector._isAndroid;\n  }\n\n  static isMobile(): boolean {\n    return (/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini/i).test(navigator?.userAgent);\n  }\n\n  private static parseBrowserNameAndVersion(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const browserNameAndVersion = navigator.userAgent.match(BrowserDetector._browserNameAndVersionRegex);\n\n    if (browserNameAndVersion && browserNameAndVersion[0]) {\n      return browserNameAndVersion[0];\n    }\n\n    return BrowserDetector.parseBrowserNameAndVersionForIE();\n  }\n\n  private static parseBrowserName(): string {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return '';\n    }\n\n    const browserNameList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserNameList || !browserNameList[0]) {\n      return '';\n    }\n\n    return browserNameList[0];\n  }\n\n  private static parseBrowserMajorVersion(): number {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return 0;\n    }\n\n    const browserVersionList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserVersionList || !browserVersionList[1]) {\n      return 0;\n    }\n\n    const fullVersion = browserVersionList[1];\n\n    if (!fullVersion) {\n      return 0;\n    }\n\n    return Number(fullVersion.split('.')[0]) || 0;\n  }\n\n  private static parseBrowserNameAndVersionForIE(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const userAgent = navigator.userAgent;\n    const msie = userAgent.indexOf('MSIE ');\n\n    if (msie > 0) {\n      // IE 10 or older => return version number\n      return `IE/${parseInt(userAgent.substring(msie + 5, userAgent.indexOf('.', msie)), 10)}`;\n    }\n\n    const trident = userAgent.indexOf('Trident/');\n\n    if (trident > 0) {\n      // IE 11 => return version number\n      const version = userAgent.indexOf('rv:');\n\n      return `IE/${parseInt(userAgent.substring(version + 3, userAgent.indexOf('.', version)), 10)}`;\n    }\n\n    return '';\n  }\n}","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport BrowserDetector from '../../dom/BrowserDetector';\n\nconst SkipFrame = Symbol();\n\ntype SurrogateFrameType = ArrayBuffer | undefined | typeof SkipFrame;\n\nconst _dummy2x2VideoIFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x67, 0xf4, 0x00, 0x0a, 0x91, 0x9b, 0x2b, 0xf1, 0xf1, 0xf8, 0x08, 0x80, 0x00, 0x00, 0x03, 0x00, 0x80, 0x00, 0x00, 0x19, 0x07, 0x89, 0x12, 0xcb, // Sequence parameter set\n    0x00, 0x00, 0x00, 0x01, 0x68, 0xeb, 0xe3, 0xc4, 0x48, 0x44, // Picture paramter set\n    /* */ 0x00, 0x00, 0x01, 0x65, 0x88, 0x82, 0x00, 0x3f, 0x70, 0x23, 0x86, 0xe6, 0xd1, 0x80, 0x09, 0xaf, 0x0a, 0x41, 0x66, 0x6b, 0x54, 0x46, 0xfb, 0x71, 0xd9, 0x7f, 0xff, 0xff, 0xf9]), // Slice layer: idr data\n  VP8: new Uint8Array([0xb0, 0x02, 0x00, 0x9d, 0x01, 0x2a, 0x01, 0x00, 0x01, 0x00, 0x39, 0x6b, 0x00, 0x27, 0x1c, 0x24, 0x0c, 0x2c, 0x2c, 0x44, 0xcc, 0x24, 0x41, 0xa8, 0x00, 0x13, 0xa7, 0xa3, 0x7a, 0x50, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x82, 0x49, 0x83, 0x42, 0x00, 0x00, 0x00, 0x00, 0x06, 0x76, 0x38, 0x24, 0x1c, 0x19, 0xa0, 0x00, 0x00, 0x20, 0x40, 0x00, 0x11, 0xbf, 0xdd, 0x77, 0xff, 0x40, 0x7f, 0xb1, 0x00])\n};\nconst _dummy2x2VideoPFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x68, 0x49, 0xa8, 0x41, 0x68, 0x99, 0x4c, 0x0f, 0xff, 0x92, 0x81]), // Slice layer: non idr data\n  VP8: new Uint8Array([0x31, 0x03, 0x00, 0xe4, 0xe0, 0xa8, 0x9b, 0x37, 0xaf, 0x10, 0x4f, 0x4f, 0xb1, 0x0a, 0x2f, 0xe4, 0x92, 0xc0, 0x1f, 0xe7, 0x4f, 0x46, 0xff, 0xee, 0x51, 0xc1, 0x5d, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x86, 0x00, 0x40, 0x92, 0x9c, 0x24, 0x48, 0x00, 0x00, 0x03, 0x70, 0x00, 0x00, 0x4b, 0x40])\n};\nconst _dummy82x82H264 = {\n  IFrame: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x67, 0x42, 0xc0, 0x0d, 0xda, 0x18, 0xde, 0x22, 0x22, 0x10, 0x00, 0x00, 0x03, 0x00, 0x10, 0x00, 0x00, 0x03, 0x03, 0xc8, 0xf1, 0x42, 0xaa, // Sequence parameter set\n    0x00, 0x00, 0x00, 0x01, 0x68, 0xce, 0x0f, 0xc8, // Picture parameter set\n    0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0x5f, ...new Uint8Array(10295).fill(0xff), 0x80, // Supplemental enhancement information (SEI)\n    0x00, 0x00, 0x00, 0x01, 0x65, 0x88, 0x84, 0x05, ...new Uint8Array(3).fill(0xff), 0x0f, 0x45, 0x00, 0x01, 0x57, 0x9f, 0x27, 0x27, 0x27, 0x27, 0x27, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x78]), // Slice layer: Idr data\n  PFrame: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0xa4, ...new Uint8Array(10364).fill(0xff), 0x80, // SEI\n    0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x20, 0x15, 0xf0, 0x4b]) // Slice layer: non idr data\n};\nconst _dummy82x82H264PFrameFrameNumberIndex = 10418;\nconst _dummyAudioSilentPerCodec = {opus: new Uint8Array([0x68, 0x07, 0xd9, 0xab, 0xbc, 0x79, 0x87, 0xab, 0x8e, 0x4a, 0x14, 0xf3, 0xa7, 0x1c, 0xf2, 0x9a, 0x7a, 0x45, 0xa7, 0x2d, 0x44, 0x25, 0x74, 0x4c, 0xad, 0x16, 0xb3, 0x0e, 0x51, 0x57, 0xea, 0xe7, 0xad, 0x2a, 0x38, 0xce, 0x33])};\nconst _singleZeroByte = new Uint8Array([0x00]);\nconst _isAndroidChrome = BrowserDetector.browserName === 'Chrome' && BrowserDetector.isAndroid;\nconst _isMobileChrome = BrowserDetector.browserName === 'Chrome' && BrowserDetector.isMobile();\nconst _isSafari = BrowserDetector.browserName === 'Safari';\nconst _useCountingFrameNumber = _isMobileChrome || _isSafari;\nconst _pFrameFrameNumberReset = 1;\nlet _pFrameFrameNumber = _pFrameFrameNumberReset;\n\nfunction getSurrogateVideoIFramePerCodec(codec: string): ArrayBuffer | undefined {\n  switch (codec) {\n    case 'H264': {\n      if (_useCountingFrameNumber) {\n        _pFrameFrameNumber = _pFrameFrameNumberReset;\n\n        return _dummy82x82H264['IFrame']['buffer'];\n      }\n\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP8': {\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP9': {\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction getSurrogateVideoPFramePerCodec(codec: string): ArrayBuffer | undefined {\n  switch (codec) {\n    case 'H264': {\n      if (_useCountingFrameNumber) {\n        const buffer = updatePFrameFrameNumber();\n\n        return buffer;\n      }\n\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP8': {\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP9': {\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction getSurrogateAudioSilentPerCodec(codec: string): ArrayBuffer | undefined {\n  switch (codec) {\n    case 'opus': {\n      return _dummyAudioSilentPerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction getInvalidAudioData(): ArrayBuffer | undefined {\n  return _singleZeroByte['buffer'];\n}\n\nfunction getInvalidVideoIFrame(codec: string): SurrogateFrameType {\n  if ((codec === 'H264') && _useCountingFrameNumber) {\n    _pFrameFrameNumber = _pFrameFrameNumberReset;\n\n    if (_isAndroidChrome) {\n      return SkipFrame;\n    }\n  }\n\n  return _singleZeroByte['buffer'];\n}\n\nfunction getInvalidVideoPFrame(codec: string): SurrogateFrameType {\n  if ((codec === 'H264') && _useCountingFrameNumber) {\n    const surrogate = updatePFrameFrameNumber();\n\n    if (_pFrameFrameNumber > _pFrameFrameNumberReset) {\n      if (_isAndroidChrome) {\n        return SkipFrame;\n      }\n\n      return _singleZeroByte['buffer'];\n    }\n\n    _pFrameFrameNumber++;\n\n    return surrogate;\n  }\n\n  return _singleZeroByte['buffer'];\n}\n\nfunction updatePFrameFrameNumber(): ArrayBuffer {\n  const byte1 = 0x9a | ((_pFrameFrameNumber & 0x0e) >> 1);\n  const byte2 = 0x20 | ((_pFrameFrameNumber & 0x01) << 7);\n  const buffer = _dummy82x82H264['PFrame']['buffer'];\n\n  buffer[_dummy82x82H264PFrameFrameNumberIndex] = byte1;\n  buffer[_dummy82x82H264PFrameFrameNumberIndex + 1] = byte2;\n  _pFrameFrameNumber++;\n\n  return buffer;\n}\n\nexport {\n  getSurrogateVideoIFramePerCodec,\n  getSurrogateVideoPFramePerCodec,\n  getSurrogateAudioSilentPerCodec,\n  getInvalidAudioData,\n  getInvalidVideoIFrame,\n  getInvalidVideoPFrame,\n  SurrogateFrameType,\n  SkipFrame\n};","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {getSurrogateVideoIFramePerCodec, getSurrogateVideoPFramePerCodec, getSurrogateAudioSilentPerCodec, getInvalidAudioData, getInvalidVideoIFrame, getInvalidVideoPFrame, SurrogateFrameType, SkipFrame} from './SurrogateFrameDataPerCodec';\n\ntype TransformStreamPostMessage = {\n  options: {\n    kind: string;\n    codec: string;\n  };\n  readable: ReadableStream;\n  writable: WritableStream;\n};\n\ntype ForceInvalidFramePostMessage = {\n  forceInvalidFrame: boolean;\n};\n\ninterface IResponseWorker {\n  onmessage: (message: MessageEvent<ForceInvalidFramePostMessage>) => void;\n}\n\nconst worker: IResponseWorker = self as IResponseWorker;\n\nworker.onmessage = event => {\n  WorkerTransformStream.forceInvalidFrame = event.data.forceInvalidFrame;\n};\n\nif (self.RTCTransformEvent) {\n  self.onrtctransform = event => {\n    const transformer = event.transformer as TransformStreamPostMessage;\n\n    WorkerTransformStream.codec = transformer.options.codec;\n    WorkerTransformStream.transformFunction = transformer.options.kind === 'video' ? WorkerTransformStream.videoTransformFunction : WorkerTransformStream.audioTransformFunction;\n    WorkerTransformStream.forceInvalidFrame = false;\n\n    const transformStream = new TransformStream({transform: WorkerTransformStream.transformFunction});\n    const source = transformer.readable;\n    const sink = transformer.writable;\n\n    source\n      .pipeThrough(transformStream)\n      .pipeTo(sink);\n  };\n}\n\nclass WorkerTransformStream {\n  static codec: string;\n  static transformFunction: TransformerTransformCallback<AudioData | VideoFrame, TransformStreamDefaultController> | undefined;\n  static forceInvalidFrame: boolean;\n\n  static videoTransformFunction(chunk, controller): void {\n    postMessage({\n      chunk: {\n        type: chunk.type,\n        timestamp: chunk.timestamp,\n        data: chunk.data\n      }\n    });\n\n    if (WorkerTransformStream.forceInvalidFrame) {\n      let surrogate: SurrogateFrameType;\n\n      WorkerTransformStream.forceInvalidFrame = false;\n\n      if (chunk.type === 'key') {\n        surrogate = getInvalidVideoIFrame(WorkerTransformStream.codec) || chunk.data;\n      } else {\n        surrogate = getInvalidVideoPFrame(WorkerTransformStream.codec) || chunk.data;\n      }\n\n      if (surrogate === SkipFrame) {\n        return;\n      }\n\n      chunk.data = surrogate || chunk.data;\n    } else {\n      if (chunk.type === 'key') {\n        chunk.data = getSurrogateVideoIFramePerCodec(WorkerTransformStream.codec) || chunk.data;\n      } else {\n        chunk.data = getSurrogateVideoPFramePerCodec(WorkerTransformStream.codec) || chunk.data;\n      }\n    }\n\n    controller.enqueue(chunk);\n  }\n\n  static audioTransformFunction(chunk, controller): void {\n    postMessage({\n      chunk: {\n        timestamp: chunk.timestamp,\n        data: chunk.data\n      }\n    });\n\n    if (WorkerTransformStream.forceInvalidFrame) {\n      WorkerTransformStream.forceInvalidFrame = false;\n      chunk.data = getInvalidAudioData() || chunk.data;\n    } else {\n      chunk.data = getSurrogateAudioSilentPerCodec(WorkerTransformStream.codec) || chunk.data;\n    }\n\n    controller.enqueue(chunk);\n  }\n\n  private constructor() {\n    throw new Error('WorkerTransformStream is a static class that may not be instantiated');\n  }\n}\n\nexport {};"],"sourceRoot":""}