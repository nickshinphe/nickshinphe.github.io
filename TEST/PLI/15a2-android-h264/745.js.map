{"version":3,"sources":["webpack://phenix/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://phenix/./node_modules/@babel/runtime/helpers/createClass.js","webpack://phenix/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPrimitive.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPropertyKey.js","webpack://phenix/./node_modules/@babel/runtime/helpers/typeof.js","webpack://phenix/./src/dom/BrowserDetector.ts","webpack://phenix/./src/sdk/transformation/SurrogateFrameDataPerCodec.ts","webpack://phenix/./src/sdk/transformation/WorkerTransformStream.ts"],"names":["module","exports","instance","Constructor","TypeError","__esModule","toPropertyKey","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","obj","value","_typeof","t","r","e","Symbol","toPrimitive","call","String","Number","o","iterator","constructor","BrowserDetector","_classCallCheck","_createClass","get","_browserNameAndVersion","this","_browserName","_browserMajorVersion","_isChrome69","_isChrome70","_isChrome71","_isChrome72","_isChrome74","_isChrome75","_isChrome76","_isChrome77","_navigator","test","navigator","userAgent","browserNameAndVersion","match","_browserNameAndVersionRegex","parseBrowserNameAndVersionForIE","browserNameList","split","browserVersionList","fullVersion","msie","indexOf","concat","parseInt","substring","version","_class","_defineProperty","parseBrowserNameAndVersion","parseBrowserName","parseBrowserMajorVersion","includes","_dummy2x2VideoIFramePerCodec","H264","Uint8Array","VP8","VP9","_dummy2x2VideoPFramePerCodec","_dummy2x2H264PFrameFrameNumberIndex","_dummyAudioSilentPerCodec","opus","_singleZeroByte","isAndroidChrome","browserName","_requestForIFrame","_pFrameNumber","invalidFrame","codec","console","log","setDummy82x82H264PFrameFrameNumber","firstTimeHere","byte1","byte2","buffer","self","onmessage","event","WorkerTransformStream","forceInvalidFrame","data","RTCTransformEvent","onrtctransform","transformer","options","transformFunction","kind","videoTransformFunction","audioTransformFunction","transformStream","TransformStream","transform","source","readable","sink","pipeThrough","pipeTo","Error","chunk","controller","postMessage","type","timestamp","surrogateVideoIFramePerCodec","surrogateVideoPFramePerCodec","enqueue","surrogateAudioSilentPerCodec"],"mappings":"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","file":"745.js","sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport default class BrowserDetector {\n  private static readonly _browserNameAndVersionRegex = /(MSIE|(?!Gecko.+)Firefox|(?!AppleWebKit.+Chrome.+)Safari|(?!AppleWebKit.+)Chrome|AppleWebKit(?!.+Chrome|.+Safari)|Gecko(?!.+Firefox))(?: |\\/)([\\d.apre]+)/g;\n  private static readonly _browserNameAndVersion = BrowserDetector.parseBrowserNameAndVersion();\n  private static readonly _browserName = BrowserDetector.parseBrowserName();\n  private static readonly _browserMajorVersion = BrowserDetector.parseBrowserMajorVersion();\n\n  private static readonly _isChrome69 = BrowserDetector._browserNameAndVersion.includes('Chrome/69.');\n  private static readonly _isChrome70 = BrowserDetector._browserNameAndVersion.includes('Chrome/70.');\n  private static readonly _isChrome71 = BrowserDetector._browserNameAndVersion.includes('Chrome/71.');\n  private static readonly _isChrome72 = BrowserDetector._browserNameAndVersion.includes('Chrome/72.');\n  private static readonly _isChrome74 = BrowserDetector._browserNameAndVersion.includes('Chrome/74.');\n  private static readonly _isChrome75 = BrowserDetector._browserNameAndVersion.includes('Chrome/75.');\n  private static readonly _isChrome76 = BrowserDetector._browserNameAndVersion.includes('Chrome/76.');\n  private static readonly _isChrome77 = BrowserDetector._browserNameAndVersion.includes('Chrome/77.');\n\n  static get browserNameAndVersion(): string {\n    return BrowserDetector._browserNameAndVersion;\n  }\n\n  static get browserName(): string {\n    return this._browserName;\n  }\n\n  static get browserMajorVersion(): number {\n    return this._browserMajorVersion;\n  }\n\n  static get isChrome69(): boolean {\n    return BrowserDetector._isChrome69;\n  }\n\n  static get isChrome70(): boolean {\n    return BrowserDetector._isChrome70;\n  }\n\n  static get isChrome71(): boolean {\n    return BrowserDetector._isChrome71;\n  }\n\n  static get isChrome72(): boolean {\n    return BrowserDetector._isChrome72;\n  }\n\n  static get isChrome74(): boolean {\n    return BrowserDetector._isChrome74;\n  }\n\n  static get isChrome75(): boolean {\n    return BrowserDetector._isChrome75;\n  }\n\n  static get isChrome76(): boolean {\n    return BrowserDetector._isChrome76;\n  }\n\n  static get isChrome77(): boolean {\n    return BrowserDetector._isChrome77;\n  }\n\n  static isMobile(): boolean {\n    return (/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini/i).test(navigator?.userAgent);\n  }\n\n  private static parseBrowserNameAndVersion(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const browserNameAndVersion = navigator.userAgent.match(BrowserDetector._browserNameAndVersionRegex);\n\n    if (browserNameAndVersion && browserNameAndVersion[0]) {\n      return browserNameAndVersion[0];\n    }\n\n    return BrowserDetector.parseBrowserNameAndVersionForIE();\n  }\n\n  private static parseBrowserName(): string {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return '';\n    }\n\n    const browserNameList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserNameList || !browserNameList[0]) {\n      return '';\n    }\n\n    return browserNameList[0];\n  }\n\n  private static parseBrowserMajorVersion(): number {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return 0;\n    }\n\n    const browserVersionList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserVersionList || !browserVersionList[1]) {\n      return 0;\n    }\n\n    const fullVersion = browserVersionList[1];\n\n    if (!fullVersion) {\n      return 0;\n    }\n\n    return Number(fullVersion.split('.')[0]) || 0;\n  }\n\n  private static parseBrowserNameAndVersionForIE(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const userAgent = navigator.userAgent;\n    const msie = userAgent.indexOf('MSIE ');\n\n    if (msie > 0) {\n      // IE 10 or older => return version number\n      return `IE/${parseInt(userAgent.substring(msie + 5, userAgent.indexOf('.', msie)), 10)}`;\n    }\n\n    const trident = userAgent.indexOf('Trident/');\n\n    if (trident > 0) {\n      // IE 11 => return version number\n      const version = userAgent.indexOf('rv:');\n\n      return `IE/${parseInt(userAgent.substring(version + 3, userAgent.indexOf('.', version)), 10)}`;\n    }\n\n    return '';\n  }\n}","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport BrowserDetector from '../../dom/BrowserDetector';\n\nconst _dummy2x2VideoIFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x67, 0xf4, 0x00, 0x0a, 0x91, 0x9b, 0x2b, 0xf1, 0xf1, 0xf8, 0x08, 0x80, 0x00, 0x00, 0x03, 0x00, 0x80, 0x00, 0x00, 0x19, 0x07, 0x89, 0x12, 0xcb, // Sequence parameter set\n    0x00, 0x00, 0x00, 0x01, 0x68, 0xeb, 0xe3, 0xc4, 0x48, 0x44, // Picture paramter set\n    /* */ 0x00, 0x00, 0x01, 0x65, 0x88, 0x82, 0x00, 0x3f, 0x70, 0x23, 0x86, 0xe6, 0xd1, 0x80, 0x09, 0xaf, 0x0a, 0x41, 0x66, 0x6b, 0x54, 0x46, 0xfb, 0x71, 0xd9, 0x7f, 0xff, 0xff, 0xf9]), // Slice layer: idr data\n  VP8: new Uint8Array([0xb0, 0x02, 0x00, 0x9d, 0x01, 0x2a, 0x01, 0x00, 0x01, 0x00, 0x39, 0x6b, 0x00, 0x27, 0x1c, 0x24, 0x0c, 0x2c, 0x2c, 0x44, 0xcc, 0x24, 0x41, 0xa8, 0x00, 0x13, 0xa7, 0xa3, 0x7a, 0x50, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x82, 0x49, 0x83, 0x42, 0x00, 0x00, 0x00, 0x00, 0x06, 0x76, 0x38, 0x24, 0x1c, 0x19, 0xa0, 0x00, 0x00, 0x20, 0x40, 0x00, 0x11, 0xbf, 0xdd, 0x77, 0xff, 0x40, 0x7f, 0xb1, 0x00])\n};\nconst _dummy2x2VideoPFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x68, 0x49, 0xa8, 0x41, 0x68, 0x99, 0x4c, 0x0f, 0xff, 0x92, 0x81]), // Slice layer: non idr data\n  // FRAME NUMBER:       last bit ---^    ^-- first 3 bits\n  // X             0100 0001 1001 1010 0110 1000 // 0x41 0x9a 0x68\n  // X             zrru uuuu 1sss sspf fff. ....\n  VP8: new Uint8Array([0x31, 0x03, 0x00, 0xe4, 0xe0, 0xa8, 0x9b, 0x37, 0xaf, 0x10, 0x4f, 0x4f, 0xb1, 0x0a, 0x2f, 0xe4, 0x92, 0xc0, 0x1f, 0xe7, 0x4f, 0x46, 0xff, 0xee, 0x51, 0xc1, 0x5d, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x86, 0x00, 0x40, 0x92, 0x9c, 0x24, 0x48, 0x00, 0x00, 0x03, 0x70, 0x00, 0x00, 0x4b, 0x40])\n};\n// X const _dummy82x82H264 = {\n// X   I: new Uint8Array([\n// X     0x00, 0x00, 0x00, 0x01, 0x67, 0x42, 0xc0, 0x0d, 0xda, 0x18, 0xde, 0x22, 0x22, 0x10, 0x00, 0x00, 0x03, 0x00, 0x10, 0x00, 0x00, 0x03, 0x03, 0xc8, 0xf1, 0x42, 0xaa, // Sequence parameter set\n// X     0x00, 0x00, 0x00, 0x01, 0x68, 0xce, 0x0f, 0xc8, // Picture parameter set\n// X     0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0x5f, ...new Uint8Array(10295).fill(0xff), 0x80, // Supplemental enhancement information (SEI)\n// X     0x00, 0x00, 0x00, 0x01, 0x65, 0x88, 0x84, 0x05, ...new Uint8Array(3).fill(0xff), 0x0f, 0x45, 0x00, 0x01, 0x57, 0x9f, 0x27, 0x27, 0x27, 0x27, 0x27, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x78]), // Slice layer: Idr data\n// X   P: new Uint8Array([\n// X     0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0xa4, ...new Uint8Array(10364).fill(0xff), 0x80, // SEI\n// X     0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x20, 0x15, 0xf0, 0x4b]) // Slice layer: non idr data\n// X   // FRAME NUMBER:       last bit ---^    ^-- first 3 bits\n// X   // X             0100 0001 1001 1010 0010 0000 // 0x41 0x9a 0x20\n// X   // X             zrru uuuu 1sss sspf fff. ....\n// X };\n// X const _dummy82x82H264PFrameFrameNumberIndex = 10418;\nconst _dummy2x2H264PFrameFrameNumberIndex = 12;\nconst _dummyAudioSilentPerCodec = {opus: new Uint8Array([0x68, 0x07, 0xd9, 0xab, 0xbc, 0x79, 0x87, 0xab, 0x8e, 0x4a, 0x14, 0xf3, 0xa7, 0x1c, 0xf2, 0x9a, 0x7a, 0x45, 0xa7, 0x2d, 0x44, 0x25, 0x74, 0x4c, 0xad, 0x16, 0xb3, 0x0e, 0x51, 0x57, 0xea, 0xe7, 0xad, 0x2a, 0x38, 0xce, 0x33])};\nconst _singleZeroByte = new Uint8Array([0x00]);\nconst isAndroidChrome = BrowserDetector.browserName === 'Chrome' && (/Android/i).test(navigator?.userAgent);\nlet _requestForIFrame = false;\nlet _pFrameNumber = 1;\n\nfunction surrogateVideoIFramePerCodec(codec: string) : ArrayBuffer | undefined {\n  switch (codec) {\n    case 'H264': {\n      if (isAndroidChrome) {\n        console.log('NIKNIK: I Frame DROID', _pFrameNumber);\n        _requestForIFrame = false;\n        _pFrameNumber = 1;\n\n        // X return _dummy82x82H264['I']['buffer'];\n        return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n      }\n\n      console.log('NIKNIK: I Frame: ', _pFrameNumber);\n      _pFrameNumber = 1; // XXX\n\n      // MUST for isMacDesktopChrome\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP8': {\n      console.log('NIKNIK: I Frame: ', _pFrameNumber);\n      _pFrameNumber = 1; // XXX\n\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP9': {\n      console.log('NIKNIK: I Frame: ', _pFrameNumber);\n      _pFrameNumber = 1; // XXX\n\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction surrogateVideoPFramePerCodec(codec: string) : ArrayBuffer | undefined | null {\n  switch (codec) {\n    case 'H264': {\n      if (isAndroidChrome) {\n        if (_requestForIFrame) {\n          return invalidFrame(codec);\n        }\n\n        console.log('NIKNIK: P Frame');\n\n        return setDummy82x82H264PFrameFrameNumber();\n      }\n\n      _pFrameNumber++; // XXX\n\n      // MUST for isMacDesktopChrome\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP8': {\n      _pFrameNumber++; // XXX\n\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP9': {\n      _pFrameNumber++; // XXX\n\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction surrogateAudioSilentPerCodec(codec: string) : ArrayBuffer | undefined {\n  switch (codec) {\n    case 'opus': {\n      return _dummyAudioSilentPerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction invalidFrame(codec: string) : ArrayBuffer | null {\n  // X if (codec === 'H264') {\n  if (codec === 'H264' && isAndroidChrome) {\n    if (_pFrameNumber > 1) {\n      console.log('NIKNIK: null Frame', _pFrameNumber);\n      _requestForIFrame = false;\n      _pFrameNumber = 1;\n\n      return null;\n    }\n\n    console.log('NIKNIK: X Frame DROID');\n    _requestForIFrame = true;\n\n    return setDummy82x82H264PFrameFrameNumber();\n  }\n\n  console.log('NIKNIK: X Frame', _pFrameNumber);\n  _pFrameNumber++; // XXX\n\n  return _singleZeroByte['buffer'];\n}\n\nlet firstTimeHere = 0;\n\nfunction setDummy82x82H264PFrameFrameNumber() {\n  const byte1 = 0x9a | ((_pFrameNumber & 0x0e) >> 1);\n  const byte2 = 0x68 | ((_pFrameNumber & 0x01) << 7);\n  // X const byte2 = 0x20 | ((_pFrameNumber & 0x01) << 7);\n  // X const buffer = _dummy82x82H264['P']['buffer'];\n  const buffer = _dummy2x2VideoIFramePerCodec['H264']['buffer'];\n\n  if (!firstTimeHere) { // DEBUGGING: try 2x2 next time -- REMOVE when finalized\n    firstTimeHere = 1;\n    // X console.log('NIKBYTES: b1:', buffer[_dummy82x82H264PFrameFrameNumberIndex], ' b2:', buffer[_dummy82x82H264PFrameFrameNumberIndex + 1]);\n    console.log('NIKBYTES: b1:', buffer[_dummy2x2H264PFrameFrameNumberIndex], ' b2:', buffer[_dummy2x2H264PFrameFrameNumberIndex + 1]);\n  }\n\n  // X buffer[_dummy82x82H264PFrameFrameNumberIndex] = byte1;\n  // X buffer[_dummy82x82H264PFrameFrameNumberIndex + 1] = byte2;\n  buffer[_dummy2x2H264PFrameFrameNumberIndex] = byte1;\n  buffer[_dummy2x2H264PFrameFrameNumberIndex + 1] = byte2;\n  _pFrameNumber++;\n\n  return buffer;\n}\n\nexport {\n  surrogateVideoIFramePerCodec,\n  surrogateVideoPFramePerCodec,\n  surrogateAudioSilentPerCodec,\n  invalidFrame\n};","/**\n * Copyright 2024 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {surrogateVideoIFramePerCodec, surrogateVideoPFramePerCodec, surrogateAudioSilentPerCodec, invalidFrame} from './SurrogateFrameDataPerCodec';\n\ntype TransformStreamPostMessage = {\n  options: {\n    kind: string;\n    codec: string;\n  };\n  readable: ReadableStream;\n  writable: WritableStream;\n};\n\ntype ForceInvalidFramePostMessage = {\n  forceInvalidFrame: boolean;\n};\n\ninterface IResponseWorker {\n  onmessage: (message: MessageEvent<ForceInvalidFramePostMessage>) => void;\n}\n\nconst worker: IResponseWorker = self as IResponseWorker;\n\nworker.onmessage = event => {\n  WorkerTransformStream.forceInvalidFrame = event.data.forceInvalidFrame;\n};\n\nif (self.RTCTransformEvent) {\n  self.onrtctransform = event => {\n    const transformer = event.transformer as TransformStreamPostMessage;\n\n    WorkerTransformStream.codec = transformer.options.codec;\n    WorkerTransformStream.transformFunction = transformer.options.kind === 'video' ? WorkerTransformStream.videoTransformFunction : WorkerTransformStream.audioTransformFunction;\n    WorkerTransformStream.forceInvalidFrame = false;\n\n    const transformStream = new TransformStream({transform: WorkerTransformStream.transformFunction});\n    const source = transformer.readable;\n    const sink = transformer.writable;\n\n    source\n      .pipeThrough(transformStream)\n      .pipeTo(sink);\n  };\n}\n\nclass WorkerTransformStream {\n  static codec: string;\n  static transformFunction: TransformerTransformCallback<AudioData | VideoFrame, TransformStreamDefaultController> | undefined;\n  static forceInvalidFrame: boolean;\n\n  static videoTransformFunction(chunk, controller): void {\n    postMessage({\n      chunk: {\n        type: chunk.type,\n        timestamp: chunk.timestamp,\n        data: chunk.data\n      }\n    });\n\n    if (WorkerTransformStream.forceInvalidFrame) {\n      WorkerTransformStream.forceInvalidFrame = false;\n      chunk.data = invalidFrame(WorkerTransformStream.codec);\n    } else {\n      if (chunk.type === 'key') {\n        chunk.data = surrogateVideoIFramePerCodec(WorkerTransformStream.codec) || chunk.data;\n      } else {\n        chunk.data = surrogateVideoPFramePerCodec(WorkerTransformStream.codec) || chunk.data;\n      }\n    }\n\n    controller.enqueue(chunk);\n  }\n\n  static audioTransformFunction(chunk, controller): void {\n    postMessage({\n      chunk: {\n        timestamp: chunk.timestamp,\n        data: chunk.data\n      }\n    });\n\n    if (WorkerTransformStream.forceInvalidFrame) {\n      WorkerTransformStream.forceInvalidFrame = false;\n      chunk.data = invalidFrame(WorkerTransformStream.codec);\n    } else {\n      chunk.data = surrogateAudioSilentPerCodec(WorkerTransformStream.codec) || chunk.data;\n    }\n\n    controller.enqueue(chunk);\n  }\n\n  private constructor() {\n    throw new Error('WorkerTransformStream is a static class that may not be instantiated');\n  }\n}\n\nexport {};"],"sourceRoot":""}