{"version":3,"sources":["webpack://phenix/webpack/universalModuleDefinition","webpack://phenix/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack://phenix/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://phenix/./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack://phenix/./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack://phenix/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://phenix/./node_modules/@babel/runtime/helpers/createClass.js","webpack://phenix/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://phenix/./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack://phenix/./node_modules/@babel/runtime/helpers/inherits.js","webpack://phenix/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack://phenix/./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack://phenix/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://phenix/./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack://phenix/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://phenix/./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack://phenix/./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPrimitive.js","webpack://phenix/./node_modules/@babel/runtime/helpers/toPropertyKey.js","webpack://phenix/./node_modules/@babel/runtime/helpers/typeof.js","webpack://phenix/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://phenix/./node_modules/@babel/runtime/regenerator/index.js","webpack://phenix/./src/promise/PromiseHandler.ts","webpack://phenix/./src/promise/Promise.ts","webpack://phenix/./src/logger/Logger.ts","webpack://phenix/./src/logger/Appenders.ts","webpack://phenix/./src/environment/BuildFeatures.ts","webpack://phenix/./src/logger/LoggerDefaults.ts","webpack://phenix/./src/logger/LoggingThreshold.ts","webpack://phenix/./src/logger/ConsoleAppender.ts","webpack://phenix/./src/sdk/version/VersionManager.ts","webpack://phenix/./src/telemetry/TelemetryService.ts","webpack://phenix/./src/telemetry/TelemetryApender.ts","webpack://phenix/./src/telemetry/TelemetryConfiguration.ts","webpack://phenix/./src/metrics/MetricsConfiguration.ts","webpack://phenix/./src/metrics/TelemetryDefault.ts","webpack://phenix/./src/lang/assertUnreachable.ts","webpack://phenix/./src/metrics/TelemetricLevelMapping.ts","webpack://phenix/./src/logger/LoggingLevelMapping.ts","webpack://phenix/./src/dom/ConfigurationParameterReader.ts","webpack://phenix/./src/logger/LoggerFactory.ts","webpack://phenix/./src/lang/Strings.ts","webpack://phenix/./src/lang/Disposable.ts","webpack://phenix/./src/rx/Subject.ts","webpack://phenix/./src/rx/ReadOnlySubject.ts","webpack://phenix/./src/edgeAuth/EdgeToken.ts","webpack://phenix/./src/edgeAuth/EdgeAuthParser.ts","webpack://phenix/./src/dom/BrowserDetector.ts","webpack://phenix/./src/lang/DisposableList.ts","webpack://phenix/./src/dom/ApplicationActivityMonitor.ts","webpack://phenix/./src/environment/FeatureEnablement.ts","webpack://phenix/./src/rtc/VanillaPeerConnection.ts","webpack://phenix/./src/rtc/VanillaPeerConnectionFactory.ts","webpack://phenix/./src/rtc/PeerConnectionService.ts","webpack://phenix/./src/sdk/TelemetryUrl.ts","webpack://phenix/./src/sdk/Environment.ts","webpack://phenix/./src/environment/Parameters.ts","webpack://phenix/./src/sdk/discovery/DiscoveryUri.ts","webpack://phenix/./src/sdk/defaults.ts","webpack://phenix/./src/time/ExponentialBackoff.ts","webpack://phenix/./src/metrics/MetricsType.ts","webpack://phenix/./src/metrics/MetricType.ts","webpack://phenix/./src/metrics/MetricsService.ts","webpack://phenix/./src/metrics/MetricsFactory.ts","webpack://phenix/./src/sdk/SDK.ts","webpack://phenix/./src/video/Dimension.ts","webpack://phenix/./src/dom/GarbageCollectorManager.ts","webpack://phenix/./src/sdk/channels/ChannelState.ts","webpack://phenix/./src/time/Duration.ts","webpack://phenix/./src/video/VideoTelemetry.ts","webpack://phenix/./src/dom/StreamSetupListener.ts","webpack://phenix/./src/dom/NetworkMonitor.ts","webpack://phenix/./src/video/SessionTelemetry.ts","webpack://phenix/./src/sdk/api/SetTemporaryMaximalBitrate.ts","webpack://phenix/./src/sdk/context/TokenContext.ts","webpack://phenix/./src/sdk/context/ChannelContext.ts","webpack://phenix/./src/sdk/transformation/EncodedStreamSink.ts","webpack://phenix/./src/sdk/transformation/StreamTrackTransform.ts","webpack://phenix/./src/sdk/context/StreamTransformContext.ts","webpack://phenix/./src/sdk/context/PeerConnectionContext.ts","webpack://phenix/./src/sdk/context/StateContext.ts","webpack://phenix/./src/sdk/discovery/BitrateModeMapping.ts","webpack://phenix/./src/sdk/discovery/BitrateStateMapping.ts","webpack://phenix/./src/sdk/discovery/EndPoint.ts","webpack://phenix/./src/sdk/discovery/DiscoveryService.ts","webpack://phenix/./src/sdk/discovery/Discovery.ts","webpack://phenix/./src/sdk/streaming/NetworkStates.ts","webpack://phenix/./src/sdk/streaming/WebPlayer.ts","webpack://phenix/./src/sdk/streaming/ShakaPlayer.ts","webpack://phenix/./src/sdk/streaming/HlsPlayer.ts","webpack://phenix/./src/sdk/streaming/ChunkedStreaming.ts","webpack://phenix/./src/sdk/streaming/ChunkedStream.ts","webpack://phenix/./src/rtc/SdpParser.ts","webpack://phenix/./src/rtc/RtcConnectionMonitor.ts","webpack://phenix/./src/rtc/RtcConfigurationManager.ts","webpack://phenix/./src/sdk/transformation/SurrogateFrameDataPerCodec.ts","webpack://phenix/./src/sdk/transformation/InsertableStreams.ts","webpack://phenix/./src/sdk/streaming/RealTimeStream.ts","webpack://phenix/./src/sdk/streaming/StreamFactory.ts","webpack://phenix/./src/sdk/channels/Channel.ts","webpack://phenix/./src/sdk/channels/Channels.ts","webpack://phenix/./src/sdk/channels/index.ts","webpack://phenix/webpack/bootstrap","webpack://phenix/webpack/startup","webpack://phenix/webpack/runtime/compat get default export","webpack://phenix/webpack/runtime/define property getters","webpack://phenix/webpack/runtime/get javascript chunk filename","webpack://phenix/webpack/runtime/global","webpack://phenix/webpack/runtime/hasOwnProperty shorthand","webpack://phenix/webpack/runtime/make namespace object","webpack://phenix/webpack/runtime/publicPath","webpack://phenix/webpack/runtime/jsonp chunk loading"],"names":["root","factory","exports","module","define","amd","self","arr","len","length","i","arr2","Array","__esModule","isArray","arrayLikeToArray","ReferenceError","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","fn","this","args","arguments","apply","err","undefined","instance","Constructor","TypeError","toPropertyKey","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","protoProps","staticProps","prototype","obj","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","bind","__proto__","subClass","superClass","create","constructor","iter","Symbol","iterator","from","r","l","t","e","n","u","a","f","call","next","push","_typeof","assertThisInitialized","_regeneratorRuntime","hasOwnProperty","c","asyncIterator","toStringTag","wrap","Generator","Context","makeInvokeMethod","tryCatch","type","h","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","__await","callInvokeWithMethodAndArg","Error","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","name","mark","awrap","async","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","_setPrototypeOf","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arrayWithoutHoles","iterableToArray","nonIterableSpread","toPrimitive","String","Number","minLen","toString","test","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","PromiseHandler","_createClass","onFulfilled","onRejected","promise","_classCallCheck","_defineProperty","callback","_state","_handled","_value","_deferreds","doResolve","_this","promiseResolve","reason","promiseReject","newValue","finale","_this2","_immediate","_unhandledRejection","deferred","result","remaining","manageResponse","_","setTimeout","console","warn","LoggingLevel","Logger","category","appenders","threshold","_category","_appenders","_threshold","get","Trace","_len","_key","log","Debug","_len2","_key2","Info","_len3","_key3","Warn","_len4","_key4","_len5","_key5","Fatal","_len6","_key6","level","date","Date","message","replacePlaceholders","appender","replacePlaceholdersString","index","indexOf","substring","replaceArgument","splice","stringify","reduce","accumulator","currentValue","array","stack","concat","cache","JSON","includes","argument","data","toStringStr","Appenders","items","item","BuildFeatures","_sendLocalCandidates","_sendLogs","_sendMetrics","_logToConsole","features","__FEATURES__","sendLocalCandidates","sendLogs","sendMetrics","logToConsole","applyFeatures","LoggerDefaults","LoggingThreshold","defaultLoggingLevel","ConsoleAppender","logLevel","fullMessage","toISOString","VersionManager","__BUILD_VERSION__","_defaultVersion","TelemetryService","telemetryConfiguration","location","hostname","_telemetryConfiguration","_sendLogsIfAble","timestamp","logRecord","tenancy","sessionId","version","sdkVersion","environment","fullQualifiedName","_domain","_logs","unshift","sendLogsIfAble","_asyncToGenerator","_callee","logMessages","formData","_context","FormData","append","records","fetch","url","body","_x","_callee2","numberOfLogsToSend","sizeOfLogsToSend","getLogSize","_context2","_isSending","sum","response","catch","TelemetryAppender","_tenancy","_sessionId","_telemetryService","TelemetryConfiguration","defaultTelemetryLoggingLevel","_url","set","telemetryUrl","URL","pathname","_environment","TelemetryLevel","MetricsConfiguration","TelemetryDefault","defaultTelemetryLevel","metricsUrl","x","TelemetryLevelMapping","telemetryLevel","Off","Essential","All","assertUnreachable","telemetryLevelType","LoggingLevelMapping","loggingLevel","loggingLevelType","ConfigurationParameterReader","readConfigurationParameterValue","readConfigurationParameterURIValue","defaultStringValue","valueFromUri","defaultBooleanValue","convertTelemetryLevelToTelemetryLevelType","convertLoggingLevelToLoggingLevelType","defaultConsoleLoggingLevel","metaValue","document","querySelector","getAttribute","valueURIParameterName","URLSearchParams","search","LoggerFactory","_loggers","applyLoggingLevel","applyAppenderLoggingLevel","applyConsoleLogger","applyTelemetryLogger","parameterValue","_configurationParameterReader","getStringValue","setThreshold","applyAppender","add","applyLoggerConfigFromParameterConfiguration","Strings","loops","Math","ceil","fill","random","string","func","Disposable","disposable","_disposed","_disposable","DisposableListener","_Disposable","_inherits","_super","listeners","listener","idx","Subject","_listeners","changed","comparable","equals","ReadOnlySubject","subject","_subject","subscribe","EdgeToken","edgeToken","_edgeToken$token","_edgeToken$token2","_applicationId","applicationId","_token","uri","token","capabilities","EdgeAuthParser","isEncodedEdgeTokenValid","_logger","decodedToken","atob","substr","edgeAuthTokenPrefix","parse","startsWith","getLogger","BrowserDetector","_browserNameAndVersion","_browserName","_browserMajorVersion","_isChrome69","_isChrome70","_isChrome71","_isChrome72","_isChrome74","_isChrome75","_isChrome76","_isChrome77","_navigator","navigator","userAgent","browserNameAndVersion","match","_browserNameAndVersionRegex","parseBrowserNameAndVersionForIE","browserNameList","split","browserVersionList","fullVersion","msie","parseInt","_class","parseBrowserNameAndVersion","parseBrowserName","parseBrowserMajorVersion","DisposableList","_list","dispose","ApplicationActivityMonitor","now","_isForeground","_readOnlyIsForeground","detectTabFocusChange","_timeOfLastTabFocusChange","_disposables","hidden","visibilityChange","msHidden","webkitHidden","handleVisibilityChange","isForeground","setFocusState","addEventListener","removeEventListener","listenForDocumentFocus","_documentFocusInterval","window","setInterval","hasFocus","clearInterval","FeatureEnablement","isChrome74","isChrome75","isChrome76","isChrome77","isChrome69","isChrome70","isChrome71","isChrome72","browserName","browserMajorVersion","_document","createElement","isMobile","MediaStreamTrackProcessor","MediaStreamTrackGenerator","RTCRtpReceiver","createEncodedStreams","RTCRtpScriptTransform","VanillaPeerConnection","configuration","webkitRTCPeerConnectionEnabled","_peerConnection","webkitRTCPeerConnection","RTCPeerConnection","_setRemoteDescription","_setLocalDescription","_createAnswer","_createOffer","currentLocalDescription","currentRemoteDescription","connectionState","iceConnectionState","getConfiguration","setConfiguration","addTranceiverDisabled","addTransceiver","options","promiseBasedPCMethodsDisabled","createOffer","createAnswer","_x2","_callee3","description","_context3","setLocalDescription","RTCSessionDescription","_x3","_callee4","_description$sdp","_context4","sdp","setRemoteDescription","_x4","getSenders","getReceivers","selector","getStats","_this3","mediaStream","_this4","getTracks","track","addTrack","ontrack","handler","onicecandidate","onconnectionstatechange","oniceconnectionstatechange","close","VanillaPeerConnectionFactory","_createPeerConnection","PeerConnectionService","_createPeerConnectionOffer","_precacheCreatePeerConnectionOffer","_peerConnectionFactory","isPrecachingEnabled","precacheCreatePeerConnectionOffer","_cached","direction","peerConnection","createPeerConnectionOffer","encodedInsertableStreams","_args3","isEncodedInsertableStreamsSupported","createPeerConnection","_ref","videoTransceiver","audioTransceiver","supportsAddTransceiver","t0","t1","t2","t3","localOffer","offerToReceiveAudio","offerToReceiveVideo","t4","t5","initiateInitialPrecaching","TelemetryUrl","baseURL","segments","protocol","endsWith","join","origin","Environment","Parameters","_discoveryParameters","parameters","__PARAMETERS__","discovery","intentions","applyParameters","DiscoveryUri","_discoveryUri","discoveryParameters","ExponentialBackoff","backoffIntervalInMillisecond","minBackoffIntervalInMillisecond","maxBackoffIntervalInMillisecond","_backoffIntervalInMillisecond","_minBackoffIntervalInMillisecond","_maxBackoffIntervalInMillisecond","failureCount","backoffIntervalInSeconds","randomization","exponentialBackoff","pow","exponentialBackoffWithRandomization","floor","exponentialBackoffWithRandomizationInMillisecond","max","min","MetricsType","MetricType","metrics","_metrics","MetricsService","metricsConfiguration","_metricsConfiguration","_exponentialBackoff","_sendMetricsIfAble","metric","streamId","previousValue","resource","kind","metricType","getTelemetryLevel","metricRecord","getName","sendMetricsIfAble","metricsMessages","isResponseStatusCodeRetryable","_failureCount","_toConsumableArray","getExponentialBackoffIntervalByFailureCount","status","MetricsFactory","metricsServices","_metricsServices","SDK","clientSessionId","getTelemetryUrl","getEnvironmentFromUrl","convertTelemetryLevelTypeToTelemetryLevel","metricsService","pageLoadTime","_clientSessionId","_loadedTimestamp","_readOnlyInitialized","_readOnlyDiscoveryUri","_readOnlyPeerConnectionFactory","_automaticallyRetryOnFailure","_automaticallyReconnectPeerConnection","_automaticallyPlayMediaStream","_automaticallyMuteVideoOnPlayFailure","_forceGarbageCollectionOnRestart","_skipGarbageCollectionOnMobileDevices","_webPlayerLoader","_shakaPlayerLoader","_hlsJsLoader","_metricsService","_applicationActivityMonitor","_telemetryUrl","_maximalNumberOfPeerConnectionReconnectAttempts","retriesAmount","_telemetryLevel","telemetryAppender","find","remove","getMetricsService","setTelemetryLevel","getBooleanValue","discoveryUri","channelToken","parseToken","uriValue","baseURIValue","_initialized","peerConnectionFactory","convertLoggingLevelTypeToLoggingLevel","consoleLoggingLevel","consoleAppender","automaticallyPlayMediaStream","automaticallyMuteVideoOnPlayFailure","webPlayerLoader","shakaPlayerLoader","hlsJsLoader","applyDiscoveryUriDefaultFromParameterConfiguration","applyMetricsConfiguration","applyTelemetryConfiguration","applyAutomaticallyRetryOnFailureFromParameterConfiguration","applyAutomaticallyReconnectPeerConnectionFromParameterConfiguration","applyForceGarbageCollectionOnRestartFromParameterConfiguration","applySkipGarbageCollectionOnMobileDevicesFromParameterConfiguration","init","Dimension","width","height","other","GarbageCollectorManager","isForceChromeGarbageCollectionSupported","forceChromeGarbageCollection","isQueueMicrotaskSupported","queueMicrotask","overloadMemoryToInvokeGarbageCollection","img","src","createObjectURL","Blob","ArrayBuffer","onerror","revokeObjectURL","ChannelState","Durations","duration","_duration","isNegative","abs","offset","milliseconds","seconds","minutes","hours","parts","padStart","targetLength","padString","repeat","VideoTelemetry","channelStartTime","_streamId","_pageLoadTime","_channelStartTime","video","_startRecordingFirstFrame","_listenToFirstTime","callTimeToFirstFrame","_clearTimeToFirstFrameListener","_listenForStall","onStall","_listenForContinuation","event","onContinuation","_clearRebufferingListener","toIsoString","pushTimeToFirstFrame","pushChannelCreationTimeToFirstFrame","_timeToFirstFrame","uint64","durationSincePageLoad","_channelCreationTimeToFirstFrame","_videoStalled","buffered","bufferLength","hasNotProgressedSinceLastProgressEvent","end","_lastProgress","timeSinceStop","newResolution","_videoResolution","StreamSetupListener","_startTime","recordStreamMetric","_metricSubmitted","setupTime","metricName","NetworkMonitor","isSupported","setupNetworkChangeListeners","updateStatistics","_isSupported","_rtt","_effectiveType","_downlinkThroughputCapacity","downlink","downlinkMax","effectiveType","rtt","getRoundTripTime","getEffectiveType","getDownlinkThroughputCapacity","SessionTelemetry","applicationActivityMonitor","_networkMonitor","recordForegroundChange","recordNetworkRTTUpdate","recordNetworkTypeChangeUpdate","downlinkThroughputCapacity","recordNetworkDownlinkThroughputCapacityUpdate","timeSinceLastChange","getTimeSinceLastChange","newRTT","oldRtt","_lastNetworkStatistics","newNetworkType","oldNetworkType","newCapacity","oldCapacity","float","BitrateState","BitrateMode","TokenContext","tokenExpiring","ChannelContext","_options$targetLag","disposables","channelDisposables","rendererDisposables","channelInitialization","videoElement","state","autoMuted","autoPaused","authorized","online","loading","playing","standby","stopped","targetLag","lag","bitrateLimit","resolution","empty","endPoint","stream","rtcStatistics","dataset","EncodedStreamSink","mode","valid","validationResult","StreamTrackTransform","StreamTransformContext","hasInsertableStreams","hasEncodedInsertableStreams","videoStreamTransformCallback","audioStreamTransformCallback","encodedVideoStreamSink","encodedAudioStreamSink","PeerConnectionContext","peerConnectionReconnectAttempts","StateContext","isStarting","isDisposed","BitrateModeMapping","bitrateMode","Normal","Force","Reset","BitrateStateMapping","bitrateState","Keep","EndPoint","timeout","_uri","_timeout","_convertHttpResponseToDestroyStreamResponse","_convertHttpResponseToAddIceCandidatesResponse","_convertHttpResponseToSetRemoteDescriptionResponse","_convertHttpResponseToPublishResponse","_convertHttpResponseToSubscribeResponse","_destroyStreamOnUnmount","_destroyStream","_addIceCandidates","_limitBitrate","_publish","_subscribe","_ping","_roundTripTime","start","finished","buildPingUrl","race","ok","localSessionDescription","clientVersion","bodyWithOffer","bodyWithoutOffer","httpResponse","subscribeResponse","buildUrl","apiVersion","bearerToken","httpRoundTripTime","sessionDescription","createAnswerDescription","createOfferDescription","finally","clearTimeout","mapHttpStatusToSubscribeStatus","convertHttpResponseToSubscribeResponse","debug","mapHttpStatusToPublishStatus","convertHttpResponseToPublishResponse","_x5","_x6","_x7","setRemoteDescriptionResponse","sharedSecret","mapHttpStatusToSetRemoteDescriptionStatus","convertHttpResponseToSetRemoteDescriptionResponse","_x8","_x9","_callee5","elapsedInMilliseconds","bitrateInBitsPerSecond","_this5","_context5","convertBitrateStateToBitrateStateType","convertBitrateModeToBitrateModeType","mapHttpStatusToSetTemporaryMaximalBitrateStatus","_x10","_x11","_x12","_x13","_x14","_callee6","candidates","discoveryCompleted","addIceCandidatesResponse","_this6","_args6","_context6","mapHttpStatusToAddIceCandidatesStatus","convertHttpResponseToAddIceCandidatesResponse","_x15","_x16","_x17","_callee7","destroyStreamResponse","_this7","_context7","mapHttpStatusToSetDestroyStreamStatus","convertHttpResponseToDestroyStreamResponse","_x18","_x19","_callee8","_context8","sendBeacon","destroyStream","_x20","_x21","path","pathAsArray","_callee9","_context9","json","rtcConfiguration","convertIRtcConfigurationToRTCConfiguration","createAnswerDescriptionResponse","createOfferDescriptionResponse","_x22","_x23","_callee10","publishResponse","_context10","_x24","_x25","iceServers","bundlePolicy","iceCandidatePoolSize","urls","username","credential","iceTransportPolicy","rtcpMuxPolicy","_callee11","_context11","_x26","_callee12","_context12","_x27","_callee13","_context13","_x28","DiscoveryService","_discoverClosestEndPoint","_discoverNearbyEndPoints","asString","endPoints","text","map","failedRequests","propagateFailureIfAllRequestsFailed","_args2","buildDiscoveryUrl","discoverNearbyEndPoints","ping","time","Discovery","_discoverClosestEndPointWithCaching","_precacheClosestEndPointDiscovery","discoverClosestEndPointWithCaching","discoveryService","cachedValue","_cache","discoverClosestEndPoint","precacheClosestEndPointDiscovery","NetworkStates","WebPlayer","manifestURI","_videoElement","_kind","_manifestURI","encodeURI","replace","_options","ChunkedStreaming","phenixWebPlayer","playerOptions","_objectSpread","bandwidthToStartAt","_player","errorObject","canReload","code","severity","errors","RECOVERABLE","reloadIfAble","currentTime","networkState","NetworkNoSource","dataBuffered","statistics","trueCurrentTime","originStartTime","isNative","deliveryType","estimatedBandwidth","NetworkLoading","playTime","NetworkIdle","NetworkEmpty","hasElapsedMinTimeSinceLastReload","_lastReloadTime","minTimeBeforeNextReload","reload","ShakaPlayer","shaka","Player","loadPlayer","abr","defaultBandwidthEstimate","manifest","retryParameters","streaming","rebufferingGoal","bufferingGoal","bufferBehind","maxAttempts","backoffFactor","unload","destroy","playerConfig","configure","load","play","HlsPlayer","hlsPlayer","enableWorker","maxBufferLength","liveBackBufferLength","liveSyncDuration","liveDurationInfinity","liveMaxLatencyDuration","Infinity","highBufferWatchdogPeriod","loadSource","attachMedia","canPlayType","media","offsetWidth","offsetHeight","streamController","_start","_hlsPlayer","_phenixWebPlayer","_shaka","offerSdp","loaded","_pending","player","dashManifestUrlMatch","hlsManifestUrlMatch","manifestUrl","playlistUrl","shouldUseNativeHls","preferNative","ChunkedStream","channelContext","handleStreamFailure","_channelContext","_handleStreamFailure","applySessionAndStreamPropertiesToVideoElement","mapSubscribeStatusToChannelStatus","applyStatus","roundTripTime","monitor","_monitorDisposables","newStreamStatistics","_streamStatistics","_monitorFailureCount","paused","SdpParser","_sdp","sdpSplitByLines","sdpSplitByTracks","_audioCodec","applyCodec","_videoCodec","_isAudioTrackEnabled","isTrackByTypeEnabled","_isVideoTrackEnabled","sdpSectionForType","sdpTrack","sdpLine","RtcConnectionMonitor","estimatedRoundTripTime","_estimatedRoundTripTime","_tracksToMonitor","getCurrentOfferDisabled","parsedSDP","_estimatedAudioCodec","audioCodec","_estimatedVideoCodec","videoCodec","updateStatistic","_updateStatisticLegacy","_updateStatistic","_rtcStatistic","_isMonitorRunning","_updateTimeout","getKindForSafari11","getStatsPromiseBasedDisabled","updateStatisticLegacy","id","stats","lastPacketReceivedTimestamp","report","currentRoundTripTime","mediaType","codec","codecId","mimeType","_this$_rtcStatistic$v","_this$_rtcStatistic$v2","_this$_rtcStatistic$v3","_this$_rtcStatistic$v4","_this$_rtcStatistic$v5","bytesDelta","bytesReceived","timeDelta","bitrate","ssrc","packetsLost","packetsReceived","getCodecByType","framesDecoded","fps","round","getStatsLegacy","names","stat","RtcConfigurationManager","_dummy2x2VideoIFramePerCodec","H264","Uint8Array","VP8","VP9","_dummy2x2VideoPFramePerCodec","_dummy82x82H264","I","P","_dummy82x82H264PFrameFrameNumberIndex","_dummyAudioSilentPerCodec","opus","_singleZeroByte","isMacDesktopChrome","isAndroidChrome","_navigator2","_pFrameNumber","invalidFrame","buffer","setDummy82x82H264PFrameFrameNumber","firstTimeHere","frameNumber","byte1","byte2","InsertableStreams","receivers","receiver","filter","receive","isRTCRtpScriptTransformSupported","worker","Worker","onmessage","chunk","postMessage","forceInvalidFrame","transform","terminate","transformer","TransformStream","controller","surrogateVideoIFramePerCodec","surrogateVideoPFramePerCodec","enqueue","receiverStreams","source","readable","sink","pipeThrough","pipeTo","MediaStream","audioPumper","Audio","srcObject","appendChild","removeChild","surrogateAudioSilentPerCodec","transformedStream","videoTrack","processor","generator","removeTrack","audioTrack","RealTimeStream","peerConnectionContext","streamTransformContext","_peerConnectionContext","_streamTransformContext","_applyRtcConfiguration","listenOnStreamSetup","playMediaStreamInVideoElement","all","_ref2","_ref3","_slicedToArray","_ref3$","clientOfferDisabled","supportsSetConfiguration","supportsGetConfiguration","forceGarbageCollectionOnRestart","skipGarbageCollectionOnMobileDevices","forceGarbageCollection","_ref4","applyRtcConfiguration","submitCandidatesTimeout","cancelDiscovery","candidate","addIceCandidates","_ref5","retryCallback","pause","onLine","reconnectPeerConnection","mediaStreamPromise","onTrackDisabled","trackListener","timeoutId","streams","answer","_ref6","mapSetRemoteDescriptionStatusToChannelStatus","success","parsedRemoteDescription","applyEncodedStreamTransformation","_InsertableStreams$ap2","applyInsertableStreamTransformation","rtcConnectionMonitor","rtcStatistic","rtcVideoStatistic","rtcAudioStatistic","audio","audioTrackFailed","videoTrackFailed","optionalPeerConnection","newRtcConfiguration","truncateIceServers","maximalNumberOfPeerConnectionReconnectAttempts","automaticallyReconnectPeerConnection","_peerConnection$curre","isClientOfferFlow","iceRestart","offer","StreamFactory","tokenCapabilities","Channel","channelContextOptions","streamTransformContextOptions","_tokenContext","_stateContext","_readOnlyVideoElement","_readOnlyToken","_readOnlyPeerConnection","_readOnlyState","_readOnlyAutoMuted","_readOnlyAutoPaused","_readOnlyTokenExpiring","_readOnlyAuthorized","_readOnlyOnline","_readOnlyLoading","_readOnlyPlaying","_readOnlyStandby","_readOnlyStopped","_readOnlyTargetLag","_readOnlyLag","_readOnlyBitrateLimit","_readOnlyResolution","_readOnlyFailureCount","_readOnlyEndPoint","_readOnlyStream","_readOnlyRtcStatistics","_readOnlyMediaStream","_sessionTelemetry","_videoMetaDataChangedHandler","handleVideoMetaDataChanged","videoTelemetry","setupListenerForTimeToFirstTime","setupListenerForRebuffering","restartAfterStop","clearFailureCountTimeout","onVideoResolutionChanges","getTime","limitBitrate","destroyStreamOnUnmount","_playMediaStreamInVideoElement","_play","_restartAfterStop","_processStart","_dispose","_resume","_stop","videoWidth","videoHeight","processStop","cleanUpResources","muted","processStart","_StreamTrackTransform","_StreamTrackTransform2","_valid","_validationResult","_EncodedStreamSink$va","_valid2","_validationResult2","_EncodedStreamSink$va2","_valid3","_validationResult3","hasTransformStreamCallback","hasEncodedStreamSink","handleStreamFailureCallback","streamPlayer","validateMediaStreamTrackTransform","validateEncodedStreamSink","isInsertableStreamsSupported","getUri","clearCachedClosestEndpoint","fail","automaticRetryOnFailure","getRetryInterval","playPromise","hasAudioTrack","automaticallyMuteVideoOnPlayFailureOff","Channels","initialized","channelOptions","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","m","getter","definition","chunkId","prop","scriptUrl","importScripts","currentScript","scripts","getElementsByTagName","b","baseURI","href"],"mappings":"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","file":"channels.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"phenix\"] = factory();\n\telse\n\t\troot[\"phenix\"] = factory();\n})(self, function() {\nreturn ","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}\nmodule.exports = _asyncToGenerator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  return _getPrototypeOf(o);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return assertThisInitialized(self);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return e;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var t,\n    e = {},\n    r = Object.prototype,\n    n = r.hasOwnProperty,\n    o = Object.defineProperty || function (t, e, r) {\n      t[e] = r.value;\n    },\n    i = \"function\" == typeof Symbol ? Symbol : {},\n    a = i.iterator || \"@@iterator\",\n    c = i.asyncIterator || \"@@asyncIterator\",\n    u = i.toStringTag || \"@@toStringTag\";\n  function define(t, e, r) {\n    return Object.defineProperty(t, e, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), t[e];\n  }\n  try {\n    define({}, \"\");\n  } catch (t) {\n    define = function define(t, e, r) {\n      return t[e] = r;\n    };\n  }\n  function wrap(t, e, r, n) {\n    var i = e && e.prototype instanceof Generator ? e : Generator,\n      a = Object.create(i.prototype),\n      c = new Context(n || []);\n    return o(a, \"_invoke\", {\n      value: makeInvokeMethod(t, r, c)\n    }), a;\n  }\n  function tryCatch(t, e, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: t.call(e, r)\n      };\n    } catch (t) {\n      return {\n        type: \"throw\",\n        arg: t\n      };\n    }\n  }\n  e.wrap = wrap;\n  var h = \"suspendedStart\",\n    l = \"suspendedYield\",\n    f = \"executing\",\n    s = \"completed\",\n    y = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var p = {};\n  define(p, a, function () {\n    return this;\n  });\n  var d = Object.getPrototypeOf,\n    v = d && d(d(values([])));\n  v && v !== r && n.call(v, a) && (p = v);\n  var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);\n  function defineIteratorMethods(t) {\n    [\"next\", \"throw\", \"return\"].forEach(function (e) {\n      define(t, e, function (t) {\n        return this._invoke(e, t);\n      });\n    });\n  }\n  function AsyncIterator(t, e) {\n    function invoke(r, o, i, a) {\n      var c = tryCatch(t[r], t, o);\n      if (\"throw\" !== c.type) {\n        var u = c.arg,\n          h = u.value;\n        return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) {\n          invoke(\"next\", t, i, a);\n        }, function (t) {\n          invoke(\"throw\", t, i, a);\n        }) : e.resolve(h).then(function (t) {\n          u.value = t, i(u);\n        }, function (t) {\n          return invoke(\"throw\", t, i, a);\n        });\n      }\n      a(c.arg);\n    }\n    var r;\n    o(this, \"_invoke\", {\n      value: function value(t, n) {\n        function callInvokeWithMethodAndArg() {\n          return new e(function (e, r) {\n            invoke(t, n, e, r);\n          });\n        }\n        return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(e, r, n) {\n    var o = h;\n    return function (i, a) {\n      if (o === f) throw new Error(\"Generator is already running\");\n      if (o === s) {\n        if (\"throw\" === i) throw a;\n        return {\n          value: t,\n          done: !0\n        };\n      }\n      for (n.method = i, n.arg = a;;) {\n        var c = n.delegate;\n        if (c) {\n          var u = maybeInvokeDelegate(c, n);\n          if (u) {\n            if (u === y) continue;\n            return u;\n          }\n        }\n        if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n          if (o === h) throw o = s, n.arg;\n          n.dispatchException(n.arg);\n        } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n        o = f;\n        var p = tryCatch(e, r, n);\n        if (\"normal\" === p.type) {\n          if (o = n.done ? s : l, p.arg === y) continue;\n          return {\n            value: p.arg,\n            done: n.done\n          };\n        }\n        \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(e, r) {\n    var n = r.method,\n      o = e.iterator[n];\n    if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y;\n    var i = tryCatch(o, e.iterator, r.arg);\n    if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y;\n    var a = i.arg;\n    return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y);\n  }\n  function pushTryEntry(t) {\n    var e = {\n      tryLoc: t[0]\n    };\n    1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);\n  }\n  function resetTryEntry(t) {\n    var e = t.completion || {};\n    e.type = \"normal\", delete e.arg, t.completion = e;\n  }\n  function Context(t) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], t.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(e) {\n    if (e || \"\" === e) {\n      var r = e[a];\n      if (r) return r.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var o = -1,\n          i = function next() {\n            for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;\n            return next.value = t, next.done = !0, next;\n          };\n        return i.next = i;\n      }\n    }\n    throw new TypeError(_typeof(e) + \" is not iterable\");\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), o(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) {\n    var e = \"function\" == typeof t && t.constructor;\n    return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name));\n  }, e.mark = function (t) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t;\n  }, e.awrap = function (t) {\n    return {\n      __await: t\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {\n    return this;\n  }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new AsyncIterator(wrap(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {\n      return t.done ? t.value : a.next();\n    });\n  }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () {\n    return this;\n  }), define(g, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (t) {\n    var e = Object(t),\n      r = [];\n    for (var n in e) r.push(n);\n    return r.reverse(), function next() {\n      for (; r.length;) {\n        var t = r.pop();\n        if (t in e) return next.value = t, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, e.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var t = this.tryEntries[0].completion;\n      if (\"throw\" === t.type) throw t.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var r = this;\n      function handle(n, o) {\n        return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return handle(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = n.call(i, \"catchLoc\"),\n            u = n.call(i, \"finallyLoc\");\n          if (c && u) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n          } else {\n            if (!u) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(t, e) {\n      for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n        var o = this.tryEntries[r];\n        if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a);\n    },\n    complete: function complete(t, e) {\n      if (\"throw\" === t.type) throw t.arg;\n      return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y;\n    },\n    finish: function finish(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;\n      }\n    },\n    \"catch\": function _catch(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.tryLoc === t) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            resetTryEntry(r);\n          }\n          return o;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, r, n) {\n      return this.delegate = {\n        iterator: values(e),\n        resultName: r,\n        nextLoc: n\n      }, \"next\" === this.method && (this.arg = t), y;\n    }\n  }, e;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  return _setPrototypeOf(o, p);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableRest = require(\"./nonIterableRest.js\");\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Promise from './Promise';\n\nexport default class PromiseHandler {\n  onFulfilled: Function;\n  onRejected: Function;\n  promise: Promise;\n\n  constructor(onFulfilled, onRejected, promise) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.promise = promise;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport PromiseHandler from './PromiseHandler';\n\nclass Promise {\n  _state: number;\n  _handled: boolean;\n  _value: Promise;\n  _deferreds: Array<PromiseHandler>;\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  then(onFulfilled: Function, onRejected: Function): Promise | void;\n\n  constructor(callback) {\n    if (!(this instanceof Promise)) {\n      throw new TypeError('Promises must be constructed via new');\n    }\n\n    if (typeof callback !== 'function') {\n      throw new TypeError('not a function');\n    }\n\n    this._state = 0;\n    this._handled = false;\n    this._value = undefined;\n    this._deferreds = [];\n\n    this.doResolve(callback);\n  }\n\n  doResolve(callback: Function): void {\n    let done = false;\n\n    try {\n      callback(\n        value => {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          this.promiseResolve(value);\n        },\n        reason => {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          this.promiseReject(reason);\n        }\n      );\n    } catch (error) {\n      if (done) {\n        return;\n      }\n\n      done = true;\n      this.promiseReject(error);\n    }\n  }\n\n  promiseResolve(newValue: Promise | undefined): void {\n    const promise = this as Promise;\n\n    try {\n      // Promise Resolution Procedure: https://github.com/Promises-aplus/Promises-spec#the-Promise-resolution-procedure\n      if (newValue === promise) {\n        throw new TypeError('A Promise cannot be resolved with it self.');\n      }\n\n      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n        const then = newValue.then;\n\n        if (newValue instanceof Promise) {\n          promise._state = 3;\n          promise._value = newValue;\n          promise.finale();\n\n          return;\n        } else if (typeof then === 'function') {\n          promise.doResolve(function(): void {\n            // eslint-disable-next-line prefer-rest-params\n            then.apply(newValue, arguments);\n          });\n\n          return;\n        }\n      }\n\n      promise._state = 1;\n      promise._value = newValue;\n      promise.finale();\n    } catch (e) {\n      promise.promiseReject(e);\n    }\n  }\n\n  promiseReject(newValue: Promise | undefined): void {\n    this._state = 2;\n    this._value = newValue;\n    this.finale();\n  }\n\n  finale(): void {\n    if (this._state === 2 && this._deferreds.length === 0) {\n      Promise._immediate(() => {\n        if (!this._handled) {\n          Promise._unhandledRejection(this._value);\n        }\n      });\n    }\n\n    for (let i = 0, len = this._deferreds.length; i < len; i++) {\n      this.handle(this._deferreds[i]);\n    }\n\n    this._deferreds = null;\n  }\n\n  handle(deferred: PromiseHandler): void {\n    let promise = this as Promise;\n\n    while (promise._state === 3) {\n      promise = promise._value;\n    }\n\n    if (promise._state === 0) {\n      promise._deferreds.push(deferred);\n\n      return;\n    }\n\n    promise._handled = true;\n    Promise._immediate(() => {\n      const callback = promise._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n      if (callback === null) {\n        if (promise._state === 1) {\n          deferred.promise.promiseResolve(promise._value);\n        } else {\n          deferred.promise.promiseReject(promise._value);\n        }\n\n        return;\n      }\n\n      let result;\n\n      try {\n        result = callback(promise._value);\n      } catch (e) {\n        deferred.promise.promiseReject(e);\n\n        return;\n      }\n\n      deferred.promise.promiseResolve(result);\n    });\n  }\n\n  static all(arr: Array<Promise>): Promise {\n    return new Promise((resolve, reject) => {\n      if (!Array.isArray(arr)) {\n        return reject(new TypeError('Promise.all accepts an array'));\n      }\n\n      const args = Array.prototype.slice.call(arr);\n\n      if (args.length === 0) {\n        return resolve([]);\n      }\n\n      let remaining = args.length;\n      const manageResponse = (i, value): void => {\n        try {\n          if (value && (typeof value === 'object' || typeof value === 'function')) {\n            const then = value.then;\n\n            if (typeof then === 'function') {\n              then.call(\n                value,\n                value => manageResponse(i, value),\n                reject\n              );\n\n              return;\n            }\n          }\n\n          args[i] = value;\n\n          if (--remaining === 0) {\n            resolve(args);\n          }\n        } catch (error) {\n          reject(error);\n        }\n      };\n\n      for (let i = 0; i < args.length; i++) {\n        manageResponse(i, args[i]);\n      }\n    });\n  }\n\n  static resolve(value): Promise {\n    if (value && typeof value === 'object' && value.constructor === Promise) {\n      return value;\n    }\n\n    return new Promise(resolve => resolve(value));\n  }\n\n  static reject(value): Promise {\n    return new Promise((_, reject) => reject(value));\n  }\n\n  static race(arr: Array<Promise>): Promise {\n    return new Promise((resolve, reject) => {\n      if (!Array.isArray(arr)) {\n        return reject(new TypeError('Promise.race accepts an array'));\n      }\n\n      for (let i = 0, len = arr.length; i < len; i++) {\n        Promise.resolve(arr[i]).then(resolve, reject);\n      }\n    });\n  }\n\n  static _immediate(callback: Function): void {\n    const ignored = setTimeout(callback, 0);\n  }\n\n  static _unhandledRejection(error): void {\n    if (typeof console !== 'undefined' && console) {\n      console.warn('Possible Unhandled Promise Rejection:', error); // eslint-disable-line no-console\n    }\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected: Function): Promise | void {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype['then'] = function(onFulfilled: Function, onRejected: Function): Promise | void {\n  const promise = new this.constructor(() => null);\n\n  this.handle(new PromiseHandler(onFulfilled, onRejected, promise));\n\n  return promise;\n};\n\nPromise.prototype['finally'] = function(callback: Function): Promise | void {\n  const constructor = this.constructor;\n\n  return this.then(\n    value => constructor.resolve(callback()).then(() => value),\n    reason => constructor.resolve(callback()).then(() => constructor.reject(reason))\n  );\n};\n\nexport default Promise;","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport {IAppender} from './IAppender';\nimport Appenders from './Appenders';\nimport LoggingThreshold from './LoggingThreshold';\n\nexport enum LoggingLevel {\n  All = -1,\n  Trace = 10,\n  Debug = 20,\n  Info = 30,\n  Warn = 40,\n  Error = 50,\n  Fatal = 60,\n  Off = 100,\n}\n\nexport type LoggingLevelType = 'Off' | 'Trace' | 'Debug' | 'Info' | 'Warn' | 'Error' | 'Fatal' | 'All';\n\nexport default class Logger {\n  private readonly _category: string;\n  private readonly _appenders: Appenders;\n  private readonly _threshold: LoggingThreshold;\n\n  get category(): string {\n    return this._category;\n  }\n\n  get appenders(): Appenders {\n    return this._appenders;\n  }\n\n  get threshold(): LoggingThreshold {\n    return this._threshold;\n  }\n\n  trace(...args: any): void {\n    if (!this._threshold.value || this._threshold.value > LoggingLevel.Trace) {\n      return;\n    }\n\n    this.log(LoggingLevel.Trace, args);\n  }\n\n  debug(...args: any): void {\n    if (!this._threshold.value || this._threshold.value > LoggingLevel.Debug) {\n      return;\n    }\n\n    this.log(LoggingLevel.Debug, args);\n  }\n\n  info(...args: any): void {\n    if (!this._threshold.value || this._threshold.value > LoggingLevel.Info) {\n      return;\n    }\n\n    this.log(LoggingLevel.Info, args);\n  }\n\n  warn(...args: any): void {\n    if (!this._threshold.value || this._threshold.value > LoggingLevel.Warn) {\n      return;\n    }\n\n    this.log(LoggingLevel.Warn, args);\n  }\n\n  error(...args: any): void {\n    if (!this._threshold.value || this._threshold.value > LoggingLevel.Error) {\n      return;\n    }\n\n    this.log(LoggingLevel.Error, args);\n  }\n\n  fatal(...args: any): void {\n    if (!this._threshold.value || this._threshold.value > LoggingLevel.Fatal) {\n      return;\n    }\n\n    this.log(LoggingLevel.Fatal, args);\n  }\n\n  private log(level: number, args: any): void {\n    const date = new Date();\n    const message = this.replacePlaceholders(args);\n\n    this._appenders.value.forEach((appender: IAppender) => {\n      appender.log(level, message, this.category, date);\n    });\n  }\n\n  private replacePlaceholders(args: any): string {\n    let replacePlaceholdersString = args[0];\n    let index = 0;\n\n    while (replacePlaceholdersString.indexOf && args.length > 1 && index >= 0) {\n      index = replacePlaceholdersString.indexOf('%', index);\n\n      if (index > 0) {\n        const type = replacePlaceholdersString.substring(index + 1, index + 2);\n\n        switch (type) {\n          case '%':\n            // Escaped '%%' turns into '%'\n            replacePlaceholdersString = replacePlaceholdersString.substring(0, index) + replacePlaceholdersString.substring(index + 1);\n            index++;\n\n            break;\n          case 's':\n          case 'd':\n            // Replace '%d' or '%s' with the argument\n            args[0] = replacePlaceholdersString = this.replaceArgument(\n              this.toString(args[1]),\n              replacePlaceholdersString,\n              index\n            );\n            args.splice(1, 1);\n\n            break;\n          case 'j':\n            // Replace %j' with the argument\n            args[0] = replacePlaceholdersString = this.replaceArgument(\n              this.stringify(args[1]),\n              replacePlaceholdersString,\n              index\n            );\n\n            args.splice(1, 1);\n\n            break;\n          default:\n            return args.toString();\n        }\n      }\n    }\n\n    if (args.length > 1) {\n      args = args.reduce((accumulator, currentValue, index, array) => {\n        if (index + 1 === array.length && currentValue instanceof Error) {\n          return accumulator + '\\n' + this.toString(currentValue.stack);\n        }\n\n        return accumulator + `[${this.toString(currentValue)}]`;\n      });\n    }\n\n    return args.toString();\n  }\n\n  private stringify(arg: any): string {\n    const cache = [];\n\n    try {\n      return JSON.stringify(\n        arg instanceof Error ? this.toString(arg) : arg,\n        (key, value) => {\n          if (!!value && value instanceof Object) {\n            if (cache.includes(value)) {\n              return '<recursive>';\n            }\n\n            cache.push(value);\n          }\n\n          return value;\n        },\n        2\n      );\n    } catch (e) {\n      return '[object invalid JSON.stringify]';\n    }\n  }\n\n  private replaceArgument(argument: any, replacePlaceholdersString: string, index: number): string {\n    return replacePlaceholdersString.substring(0, index) + this.toString(argument) + replacePlaceholdersString.substring(index + 2);\n  }\n\n  private toString(data: any): string {\n    if (typeof data === 'string') {\n      return data;\n    }\n\n    if (typeof data === 'boolean') {\n      return data ? 'true' : 'false';\n    }\n\n    if (typeof data === 'number') {\n      return data.toString();\n    }\n\n    let toStringStr = '';\n\n    if (data) {\n      if (typeof data === 'function') {\n        toStringStr = data.toString();\n      } else if (data instanceof Object) {\n        try {\n          toStringStr = data.toString();\n        } catch (e) {\n          toStringStr = '[object invalid toString()]';\n        }\n      }\n    }\n\n    return toStringStr;\n  }\n\n  constructor(category: string, appenders: Appenders, threshold: LoggingThreshold) {\n    this._category = category;\n    this._appenders = appenders;\n    this._threshold = threshold;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {IAppender} from './IAppender';\n\nexport default class Appenders {\n  private _appenders: Array<IAppender> = [];\n\n  get value(): Array<IAppender> {\n    return this._appenders;\n  }\n\n  add(appender: IAppender): void {\n    this._appenders.push(appender);\n  }\n\n  remove(appender): void {\n    this._appenders = this._appenders.reduce((items, item) => {\n      if (!(item === appender)) {\n        items.push(item);\n      }\n\n      return items;\n    }, [] as Array<IAppender>);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {LoggingLevelType} from '../logger/Logger';\nimport {TelemetryLevelType} from '../metrics/MetricsConfiguration';\n\ndeclare const __FEATURES__: {\n  sendLocalCandidates: boolean;\n  sendLogs: LoggingLevelType;\n  sendMetrics: TelemetryLevelType;\n  logToConsole: LoggingLevelType;\n};\n\nexport default class BuildFeatures {\n  private static _sendLocalCandidates: boolean;\n  private static _sendLogs: LoggingLevelType;\n  private static _sendMetrics: TelemetryLevelType;\n  private static _logToConsole: LoggingLevelType;\n\n  static get sendLocalCandidates(): boolean {\n    return this._sendLocalCandidates;\n  }\n\n  static get sendLogs(): LoggingLevelType {\n    return this._sendLogs;\n  }\n\n  static get sendMetrics(): TelemetryLevelType {\n    return this._sendMetrics;\n  }\n\n  static get logToConsole(): LoggingLevelType {\n    return this._logToConsole;\n  }\n\n  static applyFeatures(): void {\n    try {\n      const features = __FEATURES__;\n\n      this._sendLocalCandidates = 'sendLocalCandidates' in features ? features.sendLocalCandidates : true;\n      this._sendLogs = 'sendLogs' in features ? features.sendLogs : 'All';\n      this._sendMetrics = 'sendMetrics' in features ? features.sendMetrics : 'All';\n      this._logToConsole = 'logToConsole' in features ? features.logToConsole : 'All';\n    } catch (e) {\n      this._sendLocalCandidates = true;\n      this._sendLogs = 'All';\n      this._sendMetrics = 'All';\n      this._logToConsole = 'All';\n    }\n  }\n}\n\nBuildFeatures.applyFeatures();","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport BuildFeatures from '../environment/BuildFeatures';\nimport {LoggingLevel} from '../logger/Logger';\n\nexport default class LoggerDefaults {\n  static get defaultLoggingLevel(): LoggingLevel {\n    return LoggingLevel[BuildFeatures.sendLogs];\n  }\n\n  static get defaultConsoleLoggingLevel(): LoggingLevel {\n    return LoggingLevel[BuildFeatures.logToConsole];\n  }\n\n  static get defaultTelemetryLoggingLevel(): LoggingLevel {\n    return LoggingLevel.Info;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerDefaults from './LoggerDefaults';\nimport {LoggingLevel} from './Logger';\n\nexport default class LoggingThreshold {\n  private _threshold: LoggingLevel = LoggerDefaults.defaultLoggingLevel;\n\n  get value(): LoggingLevel {\n    return this._threshold;\n  }\n\n  setThreshold(threshold: LoggingLevel): void {\n    this._threshold = threshold;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {IAppender} from './IAppender';\nimport {LoggingLevel} from './Logger';\n\nexport default class ConsoleAppender implements IAppender {\n  private readonly _threshold: LoggingLevel;\n\n  log(logLevel: LoggingLevel, message: string, category: string, date: Date): void {\n    if (logLevel < this._threshold) {\n      return;\n    }\n\n    const fullMessage = `${date.toISOString()} [${category}] [${LoggingLevel[logLevel]}] ${message}`;\n\n    if (logLevel < LoggingLevel.Warn) {\n      console.log(fullMessage);\n\n      return;\n    }\n\n    console.error(fullMessage);\n  }\n\n  constructor(threshold: LoggingLevel) {\n    this._threshold = threshold;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\ndeclare const __BUILD_VERSION__: string;\n\nexport default class VersionManager {\n  private static _defaultVersion = new Date().toISOString();\n\n  static get sdkVersion(): string {\n    try {\n      return __BUILD_VERSION__;\n    } catch (e) {\n      return this._defaultVersion;\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {LoggingLevel} from '../logger/Logger';\nimport VersionManager from '../sdk/version/VersionManager';\nimport TelemetryConfiguration from './TelemetryConfiguration';\n\nconst requestSizeLimit = 8192;\n\ninterface ILogItem {\n  timestamp: string;\n  tenancy: string;\n  level: string;\n  category: string;\n  message: string;\n  sessionId: string;\n  version: string;\n  environment: string;\n  fullQualifiedName: string;\n}\n\nexport default class TelemetryService {\n  private readonly _telemetryConfiguration: TelemetryConfiguration;\n\n  private _logs: Array<ILogItem> = [];\n  private _isSending: boolean;\n  private _domain = location.hostname;\n\n  constructor(telemetryConfiguration: TelemetryConfiguration) {\n    this._telemetryConfiguration = telemetryConfiguration;\n  }\n\n  push(logLevel: LoggingLevel, message: string, category: string, timestamp: Date): void {\n    const logRecord = {\n      timestamp: timestamp.toISOString(),\n      tenancy: this._telemetryConfiguration.tenancy,\n      level: LoggingLevel[logLevel],\n      category,\n      message,\n      sessionId: this._telemetryConfiguration.sessionId,\n      version: VersionManager.sdkVersion,\n      environment: this._telemetryConfiguration.environment,\n      fullQualifiedName: this._domain\n    };\n\n    if (logLevel < LoggingLevel.Error) {\n      this._logs.push(logRecord);\n    } else {\n      this._logs.unshift(logRecord);\n    }\n\n    const ignored = this.sendLogsIfAble();\n  }\n\n  private async sendLogs(logMessages: Array<ILogItem>): Promise<Response | void> {\n    const formData = new FormData();\n\n    formData.append('jsonBody', JSON.stringify({records: logMessages}));\n\n    return await fetch(this._telemetryConfiguration.url, {\n      method: 'POST',\n      body: formData\n    });\n  }\n\n  private async sendLogsIfAble(): Promise<Response | void> {\n    if (this._logs.length <= 0 || this._isSending) {\n      return;\n    }\n\n    let numberOfLogsToSend = 0;\n    let sizeOfLogsToSend = 0;\n\n    this._isSending = true;\n\n    const getLogSize = (log: ILogItem): number => Object.values(log)\n      .reduce((sum, item) => sum + (item ? item.length : 0), 0);\n\n    while (this._logs.length > numberOfLogsToSend && getLogSize(this._logs[numberOfLogsToSend]) + sizeOfLogsToSend < requestSizeLimit) {\n      sizeOfLogsToSend += getLogSize(this._logs[numberOfLogsToSend]);\n      numberOfLogsToSend++;\n    }\n\n    if (!numberOfLogsToSend) {\n      this._logs[numberOfLogsToSend].message = this._logs[numberOfLogsToSend].message.substring(0,\n        getLogSize(this._logs[numberOfLogsToSend]) + (requestSizeLimit - getLogSize(this._logs[numberOfLogsToSend])));\n      numberOfLogsToSend = 1;\n    }\n\n    const logMessages = this._logs.slice(0, numberOfLogsToSend);\n\n    this._logs = this._logs.slice(numberOfLogsToSend);\n\n    return this.sendLogs(logMessages).then(response => {\n      this._isSending = false;\n\n      const ignored = this.sendLogsIfAble();\n\n      return response;\n    }).catch(() => {\n      this._isSending = false;\n\n      const ignored = this.sendLogsIfAble();\n    });\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport TelemetryService from './TelemetryService';\nimport TelemetryConfiguration from './TelemetryConfiguration';\nimport {IAppender} from '../logger/IAppender';\nimport {LoggingLevel} from '../logger/Logger';\n\nexport default class TelemetryAppender implements IAppender {\n  private readonly _telemetryService: TelemetryService;\n  private readonly _tenancy: string;\n  private readonly _sessionId: string;\n  private readonly _threshold: LoggingLevel;\n\n  constructor(telemetryConfiguration: TelemetryConfiguration) {\n    this._tenancy = telemetryConfiguration.tenancy;\n    this._sessionId = telemetryConfiguration.sessionId;\n    this._threshold = telemetryConfiguration.threshold;\n    this._telemetryService = new TelemetryService(telemetryConfiguration);\n  }\n\n  log(logLevel: LoggingLevel, message: string, category: string, date: Date): void {\n    if (logLevel < this._threshold) {\n      return;\n    }\n\n    this._telemetryService.push(logLevel, message, category, date);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {LoggingLevel} from '../logger/Logger';\nimport LoggerDefaults from '../logger/LoggerDefaults';\n\nexport default class TelemetryConfiguration {\n  private _url = 'https://telemetry.phenixrts.com/telemetry/logs';\n  private _tenancy: string;\n  private _sessionId: string;\n  private _environment: string;\n  private _threshold = LoggerDefaults.defaultTelemetryLoggingLevel;\n\n  get url(): string {\n    return this._url;\n  }\n\n  set url(url: string) {\n    const telemetryUrl = new URL(url);\n\n    telemetryUrl.pathname = telemetryUrl.pathname + '/logs';\n\n    this._url = telemetryUrl.toString();\n  }\n\n  get environment(): string {\n    return this._environment;\n  }\n\n  set environment(environment: string) {\n    this._environment = environment;\n  }\n\n  get tenancy(): string {\n    return this._tenancy;\n  }\n\n  set tenancy(tenancy: string) {\n    this._tenancy = tenancy;\n  }\n\n  get sessionId(): string {\n    return this._sessionId;\n  }\n\n  set sessionId(sessionId: string) {\n    this._sessionId = sessionId;\n  }\n\n  get threshold(): LoggingLevel {\n    return this._threshold;\n  }\n\n  set threshold(threshold: LoggingLevel) {\n    this._threshold = threshold;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport TelemetryDefault from './TelemetryDefault';\n\nexport enum TelemetryLevel {\n  Off = 100,\n  Essential = 10,\n  All = -1\n}\n\nexport type TelemetryLevelType = 'Off' | 'Essential' | 'All';\n\nexport default class MetricsConfiguration {\n  private _url = 'https://telemetry.phenixrts.com/telemetry/metrics';\n  private _tenancy: string;\n  private _sessionId: string;\n  private _environment: string;\n  private _threshold: TelemetryLevel = TelemetryDefault.defaultTelemetryLevel;\n\n  get url(): string {\n    return this._url;\n  }\n\n  set url(url: string) {\n    const metricsUrl = new URL(url);\n\n    metricsUrl.pathname = metricsUrl.pathname + '/metrics';\n\n    this._url = metricsUrl.toString();\n  }\n\n  get environment(): string {\n    return this._environment;\n  }\n\n  set environment(environment: string) {\n    this._environment = environment;\n  }\n\n  get tenancy(): string {\n    return this._tenancy;\n  }\n\n  set tenancy(tenancy: string) {\n    this._tenancy = tenancy;\n  }\n\n  get sessionId(): string {\n    return this._sessionId;\n  }\n\n  set sessionId(sessionId: string) {\n    this._sessionId = sessionId;\n  }\n\n  get threshold(): TelemetryLevel {\n    return this._threshold;\n  }\n\n  set threshold(threshold: TelemetryLevel) {\n    this._threshold = threshold;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport BuildFeatures from '../environment/BuildFeatures';\nimport {TelemetryLevel} from '../metrics/MetricsConfiguration';\n\nexport default class TelemetryDefault {\n  static get defaultTelemetryLevel(): TelemetryLevel {\n    return TelemetryLevel[BuildFeatures.sendMetrics];\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport function assertUnreachable(x: never): never {\n  throw new Error(`Unexpected value [${x}]. This should never be reached`);\n}\n\nexport default assertUnreachable;","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {TelemetryLevel, TelemetryLevelType} from './MetricsConfiguration';\nimport assertUnreachable from '../lang/assertUnreachable';\n\nexport default class TelemetryLevelMapping {\n  static convertTelemetryLevelToTelemetryLevelType(telemetryLevel: TelemetryLevel): TelemetryLevelType {\n    switch (telemetryLevel) {\n      case TelemetryLevel.Off:\n        return 'Off';\n      case TelemetryLevel.Essential:\n        return 'Essential';\n      case TelemetryLevel.All:\n        return 'All';\n      default:\n        assertUnreachable(telemetryLevel);\n    }\n  }\n\n  static convertTelemetryLevelTypeToTelemetryLevel(telemetryLevelType: TelemetryLevelType): TelemetryLevel {\n    switch (telemetryLevelType) {\n      case 'Off':\n        return TelemetryLevel.Off;\n      case 'Essential':\n        return TelemetryLevel.Essential;\n      case 'All':\n        return TelemetryLevel.All;\n      default:\n        assertUnreachable(telemetryLevelType);\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport assertUnreachable from '../lang/assertUnreachable';\nimport {LoggingLevel, LoggingLevelType} from './Logger';\n\nexport default class LoggingLevelMapping {\n  static convertLoggingLevelToLoggingLevelType(loggingLevel: LoggingLevel): LoggingLevelType {\n    switch (loggingLevel) {\n      case LoggingLevel.Off:\n        return 'Off';\n      case LoggingLevel.Trace:\n        return 'Trace';\n      case LoggingLevel.Debug:\n        return 'Debug';\n      case LoggingLevel.Info:\n        return 'Trace';\n      case LoggingLevel.Warn:\n        return 'Warn';\n      case LoggingLevel.Error:\n        return 'Error';\n      case LoggingLevel.Fatal:\n        return 'Fatal';\n      case LoggingLevel.All:\n        return 'All';\n      default:\n        assertUnreachable(loggingLevel);\n    }\n  }\n\n  static convertLoggingLevelTypeToLoggingLevel(loggingLevelType: LoggingLevelType): LoggingLevel {\n    switch (loggingLevelType) {\n      case 'Off':\n        return LoggingLevel.Off;\n      case 'Trace':\n        return LoggingLevel.Trace;\n      case 'Debug':\n        return LoggingLevel.Debug;\n      case 'Info':\n        return LoggingLevel.Info;\n      case 'Warn':\n        return LoggingLevel.Warn;\n      case 'Error':\n        return LoggingLevel.Error;\n      case 'Fatal':\n        return LoggingLevel.Fatal;\n      case 'All':\n        return LoggingLevel.All;\n      default:\n        assertUnreachable(loggingLevelType);\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport TelemetryDefault from '../metrics/TelemetryDefault';\nimport TelemetryLevelMapping from '../metrics/TelemetricLevelMapping';\nimport LoggingLevelMapping from '../logger/LoggingLevelMapping';\nimport LoggerDefaults from '../logger/LoggerDefaults';\n\nexport default class ConfigurationParameterReader {\n  getStringValue(name: string): string {\n    return this.readConfigurationParameterValue(name) ||\n      this.readConfigurationParameterURIValue(`${name}-uri-parameter-name`) ||\n      this.defaultStringValue[name];\n  }\n\n  getBooleanValue(name: string): boolean {\n    const value = this.readConfigurationParameterValue(name);\n\n    if (value) {\n      return value === 'true' || value === '1' || value === 'On';\n    }\n\n    const valueFromUri = this.readConfigurationParameterURIValue(`${name}-uri-parameter-name`);\n\n    if (valueFromUri) {\n      return valueFromUri === 'true' || valueFromUri === '1' || valueFromUri === 'On';\n    }\n\n    return this.defaultBooleanValue[name] === true;\n  }\n\n  private get defaultStringValue(): { [name: string]: string} {\n    return {\n      'phenix-metrics-level': TelemetryLevelMapping.convertTelemetryLevelToTelemetryLevelType(TelemetryDefault.defaultTelemetryLevel),\n      'phenix-logging-level': LoggingLevelMapping.convertLoggingLevelToLoggingLevelType(LoggerDefaults.defaultLoggingLevel),\n      'phenix-console-logging-level': LoggingLevelMapping.convertLoggingLevelToLoggingLevelType(LoggerDefaults.defaultConsoleLoggingLevel),\n      'phenix-telemetry-logging-level': LoggingLevelMapping.convertLoggingLevelToLoggingLevelType(LoggerDefaults.defaultTelemetryLoggingLevel),\n      'phenix-channel-token': '',\n      'phenix-uri': '',\n      'phenix-base-uri': ''\n    };\n  }\n\n  private get defaultBooleanValue(): { [name: string]: boolean } {\n    return {\n      'phenix-automatically-retry-on-failure': true,\n      'phenix-automatically-reconnect-peer-connection': true,\n      'phenix-force-garbage-collection-on-restart': true,\n      'phenix-skip-garbage-collection-on-mobile-devices': true\n    };\n  }\n\n  private readConfigurationParameterValue(name: string): string {\n    const metaValue = document.querySelector(`meta[name='${name}']`);\n\n    if (!metaValue) {\n      return;\n    }\n\n    const value = metaValue.getAttribute('value');\n\n    if (!value) {\n      return;\n    }\n\n    return value;\n  }\n\n  private readConfigurationParameterURIValue(name: string): string {\n    const valueURIParameterName = this.readConfigurationParameterValue(name);\n\n    if (!valueURIParameterName) {\n      return;\n    }\n\n    const value = new URLSearchParams(location.search).get(valueURIParameterName) || undefined;\n\n    if (!value) {\n      return;\n    }\n\n    return value;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {ILogger} from './LoggerInterface';\nimport Logger, {LoggingLevel} from './Logger';\nimport Appenders from './Appenders';\nimport LoggingThreshold from './LoggingThreshold';\nimport ConsoleAppender from './ConsoleAppender';\nimport TelemetryAppender from '../telemetry/TelemetryApender';\nimport TelemetryConfiguration from '../telemetry/TelemetryConfiguration';\nimport ConfigurationParameterReader from '../dom/ConfigurationParameterReader';\nimport {IConfigurationParameterReader} from '../dom/IConfigurationParamaterReader';\nimport LoggerDefaults from './LoggerDefaults';\n\nexport default class LoggerFactory {\n  private static _configurationParameterReader: IConfigurationParameterReader = new ConfigurationParameterReader();\n  private static _loggers: {[category: string]: ILogger} = {};\n  private static _appenders: Appenders = new Appenders();\n  private static _threshold: LoggingThreshold = new LoggingThreshold();\n  private static _telemetryConfiguration: TelemetryConfiguration = new TelemetryConfiguration();\n\n  static get telemetryConfiguration(): TelemetryConfiguration {\n    return LoggerFactory._telemetryConfiguration;\n  }\n\n  static getLogger(category: string): ILogger {\n    if (typeof category !== 'string') {\n      category = 'SDK';\n    }\n\n    const logger = LoggerFactory._loggers[category];\n\n    if (logger) {\n      return logger;\n    }\n\n    return LoggerFactory._loggers[category] = new Logger(category, this._appenders, this._threshold);\n  }\n\n  static applyLoggerConfigFromParameterConfiguration(): void {\n    LoggerFactory.applyLoggingLevel();\n    LoggerFactory.applyAppenderLoggingLevel('console', LoggerFactory.applyConsoleLogger.bind(this));\n    LoggerFactory.applyAppenderLoggingLevel('telemetry', LoggerFactory.applyTelemetryLogger.bind(this));\n  }\n\n  private static applyLoggingLevel(): void {\n    const parameterValue = this._configurationParameterReader.getStringValue('phenix-logging-level');\n\n    if (LoggingLevel[parameterValue]) {\n      this._threshold.setThreshold(LoggingLevel[parameterValue]);\n    }\n\n    return;\n  }\n\n  private static applyAppenderLoggingLevel(name: string, applyAppender: (level: LoggingLevel) => void): void {\n    const parameterValue = this._configurationParameterReader.getStringValue(`phenix-${name}-logging-level`);\n\n    if (parameterValue === 'Off') {\n      return;\n    }\n\n    applyAppender(LoggingLevel[parameterValue]);\n  }\n\n  private static applyConsoleLogger(level: LoggingLevel): void {\n    this._appenders.add(new ConsoleAppender(level || LoggerDefaults.defaultConsoleLoggingLevel));\n  }\n\n  private static applyTelemetryLogger(level: LoggingLevel): void {\n    this._telemetryConfiguration.threshold = level || LoggerDefaults.defaultTelemetryLoggingLevel;\n\n    this._appenders.add(new TelemetryAppender(this._telemetryConfiguration));\n  }\n\n  private constructor() {\n    throw new Error('LoggerFactory is a static class that may not be instantiated');\n  }\n}\n\nLoggerFactory.applyLoggerConfigFromParameterConfiguration();","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport default class Strings {\n  static random(length: number): string {\n    const random13Characters = (): string => {\n      return Math.random().toString(16).substring(2, 15);\n    };\n\n    const loops: number = Math.ceil(length / 13);\n\n    return new Array(loops).fill(random13Characters).reduce((string, func) => {\n      return string + func();\n    }, '').substring(0, length);\n  }\n\n  private constructor() {\n    throw new Error('Strings is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport IDisposable from './IDisposable';\n\nexport default class Disposable implements IDisposable {\n  private _disposed: boolean;\n  private _disposable: () => void;\n\n  constructor(disposable: () => void) {\n    this._disposed = false;\n    this._disposable = disposable;\n  }\n\n  dispose(): void {\n    if (this._disposed) {\n      return;\n    }\n\n    this._disposed = true;\n\n    return this._disposable.call(this);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport IDisposable from '../lang/IDisposable';\nimport Disposable from '../lang/Disposable';\nimport IComparable from '../lang/IComparable';\n\nclass DisposableListener<T> extends Disposable {\n  constructor(listeners: Array<T>, listener: T) {\n    super(() => {\n      const idx = listeners.indexOf(listener);\n\n      if (idx >= 0) {\n        listeners.splice(idx, 1);\n      }\n    });\n  }\n}\n\nexport default class Subject<T> {\n  private readonly _listeners: Array<(T) => void>;\n  private _value: T;\n\n  constructor(value: T) {\n    this._listeners = [];\n    this._value = value;\n  }\n\n  set value(value: T) {\n    let changed = this._value !== value;\n\n    if (changed && value) {\n      const comparable = value as unknown as IComparable<T>;\n\n      if (typeof comparable.equals === 'function') {\n        changed = !comparable.equals(this._value);\n      }\n    }\n\n    if (!changed) {\n      return;\n    }\n\n    this._value = value;\n\n    this._listeners.forEach(listener => {\n      listener(value);\n    });\n  }\n\n  get value(): T {\n    return this._value;\n  }\n\n  subscribe(listener: (T) => void): IDisposable {\n    this._listeners.push(listener);\n\n    listener(this._value);\n\n    return new DisposableListener<(T) => void>(this._listeners, listener);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport Subject from './Subject';\nimport IDisposable from '../lang/IDisposable';\n\nexport default class ReadOnlySubject<T> {\n  private readonly _subject: Subject<T>;\n\n  constructor(subject: Subject<T>) {\n    this._subject = subject;\n  }\n\n  get value(): T {\n    return this._subject.value;\n  }\n\n  subscribe(listener: (T) => void): IDisposable {\n    return this._subject.subscribe(listener);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\ninterface IToken {\n  uri: URL | null;\n  capabilities: string[];\n}\n\ninterface IEdgeToken {\n  applicationId: string;\n  token: IToken;\n}\n\nexport default class EdgeToken {\n  private readonly _applicationId: string;\n  private readonly _token: IToken;\n\n  constructor(edgeToken: IEdgeToken) {\n    this._applicationId = edgeToken?.applicationId || '';\n    this._token = {\n      uri: edgeToken?.token?.uri ? new URL(edgeToken.token.uri) : null,\n      capabilities: edgeToken?.token?.capabilities || []\n    };\n  }\n\n  get uri(): URL | null {\n    return this._token.uri;\n  }\n\n  get capabilities(): string[] {\n    return this._token.capabilities;\n  }\n\n  get tenancy(): string {\n    return this._applicationId;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../logger/LoggerFactory';\nimport {ILogger} from '../logger/LoggerInterface';\nimport EdgeToken from './EdgeToken';\nimport {EncodedEdgeToken} from './EncodedEdgeToken';\n\nconst edgeAuthTokenPrefix = 'DIGEST:';\n\nexport default class EdgeAuthParser {\n  private static _logger: ILogger = LoggerFactory.getLogger('EdgeAuthParser');\n\n  static parseToken(token: EncodedEdgeToken): EdgeToken {\n    if (!this.isEncodedEdgeTokenValid(token)) {\n      EdgeAuthParser._logger.error('Token is not valid [%s]', token);\n\n      return new EdgeToken(null);\n    }\n\n    try {\n      const decodedToken = atob(token.substr(edgeAuthTokenPrefix.length));\n      const edgeToken = JSON.parse(decodedToken);\n\n      edgeToken.token = JSON.parse(edgeToken.token);\n\n      return new EdgeToken(edgeToken);\n    } catch (e) {\n      EdgeAuthParser._logger.error('Cannot parse token value', e);\n\n      return new EdgeToken(null);\n    }\n  }\n\n  static isEncodedEdgeTokenValid(token: EncodedEdgeToken): boolean {\n    return !!token && token.startsWith(edgeAuthTokenPrefix);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport default class BrowserDetector {\n  private static readonly _browserNameAndVersionRegex = /(MSIE|(?!Gecko.+)Firefox|(?!AppleWebKit.+Chrome.+)Safari|(?!AppleWebKit.+)Chrome|AppleWebKit(?!.+Chrome|.+Safari)|Gecko(?!.+Firefox))(?: |\\/)([\\d.apre]+)/g;\n  private static readonly _browserNameAndVersion = BrowserDetector.parseBrowserNameAndVersion();\n  private static readonly _browserName = BrowserDetector.parseBrowserName();\n  private static readonly _browserMajorVersion = BrowserDetector.parseBrowserMajorVersion();\n\n  private static readonly _isChrome69 = BrowserDetector._browserNameAndVersion.includes('Chrome/69.');\n  private static readonly _isChrome70 = BrowserDetector._browserNameAndVersion.includes('Chrome/70.');\n  private static readonly _isChrome71 = BrowserDetector._browserNameAndVersion.includes('Chrome/71.');\n  private static readonly _isChrome72 = BrowserDetector._browserNameAndVersion.includes('Chrome/72.');\n  private static readonly _isChrome74 = BrowserDetector._browserNameAndVersion.includes('Chrome/74.');\n  private static readonly _isChrome75 = BrowserDetector._browserNameAndVersion.includes('Chrome/75.');\n  private static readonly _isChrome76 = BrowserDetector._browserNameAndVersion.includes('Chrome/76.');\n  private static readonly _isChrome77 = BrowserDetector._browserNameAndVersion.includes('Chrome/77.');\n\n  static get browserNameAndVersion(): string {\n    return BrowserDetector._browserNameAndVersion;\n  }\n\n  static get browserName(): string {\n    return this._browserName;\n  }\n\n  static get browserMajorVersion(): number {\n    return this._browserMajorVersion;\n  }\n\n  static get isChrome69(): boolean {\n    return BrowserDetector._isChrome69;\n  }\n\n  static get isChrome70(): boolean {\n    return BrowserDetector._isChrome70;\n  }\n\n  static get isChrome71(): boolean {\n    return BrowserDetector._isChrome71;\n  }\n\n  static get isChrome72(): boolean {\n    return BrowserDetector._isChrome72;\n  }\n\n  static get isChrome74(): boolean {\n    return BrowserDetector._isChrome74;\n  }\n\n  static get isChrome75(): boolean {\n    return BrowserDetector._isChrome75;\n  }\n\n  static get isChrome76(): boolean {\n    return BrowserDetector._isChrome76;\n  }\n\n  static get isChrome77(): boolean {\n    return BrowserDetector._isChrome77;\n  }\n\n  static isMobile(): boolean {\n    return (/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini/i).test(navigator?.userAgent);\n  }\n\n  private static parseBrowserNameAndVersion(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const browserNameAndVersion = navigator.userAgent.match(BrowserDetector._browserNameAndVersionRegex);\n\n    if (browserNameAndVersion && browserNameAndVersion[0]) {\n      return browserNameAndVersion[0];\n    }\n\n    return BrowserDetector.parseBrowserNameAndVersionForIE();\n  }\n\n  private static parseBrowserName(): string {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return '';\n    }\n\n    const browserNameList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserNameList || !browserNameList[0]) {\n      return '';\n    }\n\n    return browserNameList[0];\n  }\n\n  private static parseBrowserMajorVersion(): number {\n    if (!BrowserDetector._browserNameAndVersion) {\n      return 0;\n    }\n\n    const browserVersionList = BrowserDetector._browserNameAndVersion.split('/');\n\n    if (!browserVersionList || !browserVersionList[1]) {\n      return 0;\n    }\n\n    const fullVersion = browserVersionList[1];\n\n    if (!fullVersion) {\n      return 0;\n    }\n\n    return Number(fullVersion.split('.')[0]) || 0;\n  }\n\n  private static parseBrowserNameAndVersionForIE(): string {\n    if (!navigator || !navigator.userAgent) {\n      return '';\n    }\n\n    const userAgent = navigator.userAgent;\n    const msie = userAgent.indexOf('MSIE ');\n\n    if (msie > 0) {\n      // IE 10 or older => return version number\n      return `IE/${parseInt(userAgent.substring(msie + 5, userAgent.indexOf('.', msie)), 10)}`;\n    }\n\n    const trident = userAgent.indexOf('Trident/');\n\n    if (trident > 0) {\n      // IE 11 => return version number\n      const version = userAgent.indexOf('rv:');\n\n      return `IE/${parseInt(userAgent.substring(version + 3, userAgent.indexOf('.', version)), 10)}`;\n    }\n\n    return '';\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport IDisposable from './IDisposable';\n\nexport default class DisposableList {\n  private readonly _list: IDisposable[] = [];\n\n  add(disposable: IDisposable): void {\n    this._list.push(disposable);\n  }\n\n  dispose(): void {\n    this._list.forEach(disposable => disposable.dispose());\n    this._list.length = 0;\n  }\n\n  toString(): string {\n    return `DisposableList[disposables=${this._list.length}]`;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Disposable from '../lang/Disposable';\nimport Subject from '../rx/Subject';\nimport ReadOnlySubject from '../rx/ReadOnlySubject';\nimport DisposableList from '../lang/DisposableList';\n\nconst defaultDocumentFocusIntervalTimeout = 3000;\n\nexport default class ApplicationActivityMonitor {\n  private readonly _disposables: DisposableList = new DisposableList();\n  private readonly _readOnlyIsForeground: ReadOnlySubject<boolean>;\n  private readonly _isForeground: Subject<boolean>;\n  private _timeOfLastTabFocusChange: number = Date.now();\n  private _documentFocusInterval: number;\n\n  constructor() {\n    this._isForeground = new Subject<boolean>(true);\n    this._readOnlyIsForeground = new ReadOnlySubject(this._isForeground);\n    this.detectTabFocusChange();\n  }\n\n  get isForeground(): ReadOnlySubject<boolean> {\n    return this._readOnlyIsForeground;\n  }\n\n  getTimeSinceLastChange(): number {\n    return Date.now() - this._timeOfLastTabFocusChange;\n  }\n\n  dispose(): void {\n    this._disposables.dispose();\n  }\n\n  private detectTabFocusChange(): void {\n    let hidden;\n    let visibilityChange;\n\n    if (typeof document !== 'object') {\n      return;\n    }\n\n    // Due to typescript not having a definition for 'msHidden' or 'webkitHidden' types\n    // Required to @ts-ignore to prevent typescript errors\n    /* eslint-disable @typescript-eslint/ban-ts-comment */\n    // @ts-ignore\n    if (typeof document.msHidden !== 'undefined') {\n      hidden = 'msHidden';\n      visibilityChange = 'msvisibilitychange';\n      // @ts-ignore\n    } else if (typeof document.webkitHidden !== 'undefined') {\n      hidden = 'webkitHidden';\n      visibilityChange = 'webkitvisibilitychange';\n    } else if (typeof document.hidden !== 'undefined') { // Opera 12.10 and Firefox 18 and later support\n      hidden = 'hidden';\n      visibilityChange = 'visibilitychange';\n    }\n    /* eslint-enable @typescript-eslint/ban-ts-comment */\n\n    const handleVisibilityChange = (): void => {\n      const isForeground = !document[hidden];\n\n      this.setFocusState(isForeground);\n    };\n\n    if (typeof document.addEventListener !== 'undefined' && typeof document[hidden] !== 'undefined') {\n      document.addEventListener(visibilityChange, handleVisibilityChange, false);\n\n      this._disposables.add(new Disposable(() => {\n        document.removeEventListener(visibilityChange, handleVisibilityChange, false);\n      }));\n    } else {\n      this.listenForDocumentFocus.call(this);\n    }\n  }\n\n  private listenForDocumentFocus(): void {\n    this._documentFocusInterval = window.setInterval(() => {\n      const isForeground = document.hasFocus();\n\n      this.setFocusState(isForeground);\n    }, defaultDocumentFocusIntervalTimeout);\n\n    this._disposables.add(new Disposable(() => {\n      if (this._documentFocusInterval) {\n        clearInterval(this._documentFocusInterval);\n      }\n\n      this._documentFocusInterval = null;\n    }));\n  }\n\n  private setFocusState(isForeground): void {\n    if (this._isForeground === isForeground) {\n      return;\n    }\n\n    this._isForeground.value = isForeground;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport BrowserDetector from '../dom/BrowserDetector';\n\nexport default class FeatureEnablement {\n  static get clientOfferDisabled(): boolean {\n    // Client offer workflow does not work correctly in the following browsers\n    return BrowserDetector.isChrome74 ||\n      BrowserDetector.isChrome75 ||\n      BrowserDetector.isChrome76 ||\n      BrowserDetector.isChrome77;\n  }\n\n  static get addTranceiverDisabled(): boolean {\n    // Chrome 69, 70, 71, 72 exposes `addTranceiver` but it does not work correctly\n    return BrowserDetector.isChrome69 ||\n      BrowserDetector.isChrome70 ||\n      BrowserDetector.isChrome71 ||\n      BrowserDetector.isChrome72;\n  }\n\n  static get getStatsPromiseBasedDisabled(): boolean {\n    return BrowserDetector.browserName === 'Chrome' && BrowserDetector.browserMajorVersion <= 66;\n  }\n\n  static get getCurrentOfferDisabled(): boolean {\n    return BrowserDetector.browserName === 'Chrome' && BrowserDetector.browserMajorVersion <= 69 ||\n      BrowserDetector.browserName === 'Firefox' && BrowserDetector.browserMajorVersion <= 56;\n  }\n\n  static get onTrackDisabled(): boolean {\n    return BrowserDetector.browserName === 'Chrome' && BrowserDetector.browserMajorVersion <= 63 ||\n      BrowserDetector.browserName === 'Firefox' && BrowserDetector.browserMajorVersion <= 52;\n  }\n\n  static get webkitRTCPeerConnectionEnabled(): boolean {\n    return BrowserDetector.browserName === 'Chrome' && BrowserDetector.browserMajorVersion <= 55;\n  }\n\n  static get promiseBasedPCMethodsDisabled(): boolean {\n    return BrowserDetector.browserName === 'Firefox' && BrowserDetector.browserMajorVersion <= 52;\n  }\n\n  static get shouldUseNativeHls(): boolean {\n    return BrowserDetector.browserName === 'Safari' ||\n      BrowserDetector.browserName === 'SamsungBrowser';\n  }\n\n  static get isPrecachingEnabled(): boolean {\n    return BrowserDetector.browserName !== 'IE';\n  }\n\n  static get isForceChromeGarbageCollectionSupported(): boolean {\n    return BrowserDetector.browserName === 'Chrome' && typeof document?.createElement === 'function';\n  }\n\n  static get isQueueMicrotaskSupported(): boolean {\n    return BrowserDetector.browserName === 'Chrome' && BrowserDetector.browserMajorVersion >= 71 ||\n      BrowserDetector.browserName === 'Firefox' && BrowserDetector.browserMajorVersion >= 69 ||\n      BrowserDetector.browserName === 'Safari';\n  }\n\n  static get isMobile(): boolean {\n    return BrowserDetector.isMobile();\n  }\n\n  static get isInsertableStreamsSupported(): boolean {\n    return !(typeof MediaStreamTrackProcessor === 'undefined' ||\n      typeof MediaStreamTrackGenerator === 'undefined');\n  }\n\n  static get isEncodedInsertableStreamsSupported(): boolean {\n    return typeof RTCRtpReceiver !== 'undefined' && typeof RTCRtpReceiver.prototype.createEncodedStreams !== 'undefined';\n  }\n\n  static get isRTCRtpScriptTransformSupported(): boolean {\n    return typeof RTCRtpScriptTransform !== 'undefined';\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../logger/LoggerFactory';\nimport IPeerConnection, {PeerConnectionEvents} from './IPeerConnection';\nimport {ILogger} from '../logger/LoggerInterface';\nimport FeatureEnablement from '../environment/FeatureEnablement';\nimport {ILegacyRTCStatsReport} from './RtcConnectionMonitor';\n\nclass VanillaPeerConnection implements IPeerConnection {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('VanillaPeerConnection');\n  private _peerConnection: RTCPeerConnection;\n\n  constructor(configuration?: RTCConfiguration) {\n    if (FeatureEnablement.webkitRTCPeerConnectionEnabled) {\n      // Ignored as legacy webkitRTCPeerConnection class is deprecated\n      // This was a Chrome specific implementation\n      // Requires a ts-ignore directive to prevent typescript errors\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      this._peerConnection = new webkitRTCPeerConnection(configuration);\n\n      return;\n    }\n\n    this._peerConnection = new RTCPeerConnection(configuration);\n  }\n\n  get native(): RTCPeerConnection | null {\n    return this._peerConnection;\n  }\n\n  get currentLocalDescription(): RTCSessionDescription | null {\n    return this._peerConnection.currentLocalDescription;\n  }\n\n  get currentRemoteDescription(): RTCSessionDescription | null {\n    return this._peerConnection.currentRemoteDescription;\n  }\n\n  get connectionState(): RTCPeerConnectionState {\n    return this._peerConnection.connectionState;\n  }\n\n  get iceConnectionState(): RTCIceConnectionState {\n    return this._peerConnection.iceConnectionState;\n  }\n\n  get supportsGetConfiguration(): boolean {\n    return typeof this._peerConnection.getConfiguration === 'function';\n  }\n\n  get supportsSetConfiguration(): boolean {\n    return typeof this._peerConnection.setConfiguration === 'function';\n  }\n\n  get supportsAddTransceiver(): boolean {\n    return !FeatureEnablement.addTranceiverDisabled && typeof this._peerConnection.addTransceiver === 'function';\n  }\n\n  async createOffer(options?: RTCOfferOptions): Promise<RTCSessionDescriptionInit> {\n    if (FeatureEnablement.promiseBasedPCMethodsDisabled) {\n      // Ignored as legacy createOffer method with callbacks is deprecated\n      // Requires a ts-ignore directive to prevent typescript errors\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return new Promise((resolve, reject) => this._peerConnection.createOffer(resolve, reject, options));\n    }\n\n    return this._peerConnection.createOffer(options);\n  }\n\n  async createAnswer(options?: RTCAnswerOptions): Promise<RTCSessionDescriptionInit> {\n    if (FeatureEnablement.promiseBasedPCMethodsDisabled) {\n      // Ignored as legacy createAnswer method with callbacks is deprecated\n      // Requires a ts-ignore directive to prevent typescript errors\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return new Promise((resolve, reject) => this._peerConnection.createAnswer(resolve, reject, options));\n    }\n\n    return this._peerConnection.createAnswer(options);\n  }\n\n  async setLocalDescription(description: RTCSessionDescriptionInit): Promise<void> {\n    return this._peerConnection.setLocalDescription(FeatureEnablement.promiseBasedPCMethodsDisabled ?\n      new RTCSessionDescription(description) : description);\n  }\n\n  async setRemoteDescription(description: RTCSessionDescriptionInit): Promise<void> {\n    const hasCrypto = description.sdp?.match(/a=crypto:/i);\n\n    if (hasCrypto) {\n      this._logger.warn('SDP a=crypto is not supported');\n    }\n\n    return this._peerConnection.setRemoteDescription(FeatureEnablement.promiseBasedPCMethodsDisabled ?\n      new RTCSessionDescription(description) : description);\n  }\n\n  getSenders(): RTCRtpSender[] {\n    return this._peerConnection.getSenders();\n  }\n\n  getReceivers(): RTCRtpReceiver[] {\n    return this._peerConnection.getReceivers();\n  }\n\n  getStats(selector?: MediaStreamTrack | null): Promise<RTCStatsReport> {\n    return this._peerConnection.getStats(selector);\n  }\n\n  getStatsLegacy(): Promise<ILegacyRTCStatsReport> {\n    return new Promise(resolve => {\n      // Ignored due to typescript not having legacy 'getStats' method type definition\n      // This was a Chrome specific implementation of the 'getStats' method for\n      // Chrome@<= 66 detailed here: https://bugs.chromium.org/p/chromium/issues/detail?id=627816\n      // Requires a ts-ignore directive to prevent typescript errors\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      const ignored = this._peerConnection.getStats(resolve);\n    });\n  }\n\n  addEventListener(type: PeerConnectionEvents, listener: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions): void {\n    this._peerConnection.addEventListener(type, listener, options);\n  }\n\n  removeEventListener(type: PeerConnectionEvents, listener: EventListenerOrEventListenerObject, options?: boolean | EventListenerOptions): void {\n    this._peerConnection.removeEventListener(type, listener, options);\n  }\n\n  addTransceiver(name: string, options: RTCRtpTransceiverInit): RTCRtpTransceiver {\n    return this._peerConnection.addTransceiver(name, options);\n  }\n\n  addStream(mediaStream: MediaStream): void {\n    mediaStream.getTracks().forEach(track => {\n      this._peerConnection.addTrack(track);\n    });\n  }\n\n  getConfiguration(): RTCConfiguration {\n    return this._peerConnection.getConfiguration();\n  }\n\n  setConfiguration(configuration: RTCConfiguration): void {\n    this._peerConnection.setConfiguration(configuration);\n  }\n\n  set ontrack(handler: ((this: RTCPeerConnection, ev: RTCTrackEvent) => unknown) | null) {\n    this._peerConnection.ontrack = handler;\n  }\n\n  get ontrack(): ((this: RTCPeerConnection, ev: RTCTrackEvent) => unknown) | null {\n    return this._peerConnection.ontrack;\n  }\n\n  set onicecandidate(handler: ((this: RTCPeerConnection, ev: RTCPeerConnectionIceEvent) => unknown) | null) {\n    this._peerConnection.onicecandidate = handler;\n  }\n\n  get onicecandidate(): ((this: RTCPeerConnection, ev: RTCPeerConnectionIceEvent) => unknown) | null {\n    return this._peerConnection.onicecandidate;\n  }\n\n  set onconnectionstatechange(handler: ((this: RTCPeerConnection, ev: RTCPeerConnectionIceEvent) => unknown) | null) {\n    this._peerConnection.onconnectionstatechange = handler;\n  }\n\n  get onconnectionstatechange(): ((this: RTCPeerConnection, ev: RTCPeerConnectionIceEvent) => unknown) | null {\n    return this._peerConnection.onconnectionstatechange;\n  }\n\n  set oniceconnectionstatechange(handler: ((this: RTCPeerConnection, ev: Event) => unknown) | null) {\n    this._peerConnection.oniceconnectionstatechange = handler;\n  }\n\n  get oniceconnectionstatechange(): ((this: RTCPeerConnection, ev: Event) => unknown) | null {\n    return this._peerConnection.oniceconnectionstatechange;\n  }\n\n  close(): void {\n    this._peerConnection.close();\n  }\n\n  dispose(): void {\n    this._peerConnection = null;\n  }\n}\n\nexport default VanillaPeerConnection;","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport IPeerConnectionFactory from './IPeerConnectionFactory';\nimport IPeerConnection from './IPeerConnection';\nimport VanillaPeerConnection from './VanillaPeerConnection';\n\nclass VanillaPeerConnectionFactory implements IPeerConnectionFactory {\n  async createPeerConnection(configuration?: RTCConfiguration): Promise<IPeerConnection> {\n    return new VanillaPeerConnection(configuration);\n  }\n}\n\nexport default VanillaPeerConnectionFactory;","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../logger/LoggerFactory';\nimport {ILogger} from '../logger/LoggerInterface';\nimport Subject from '../rx/Subject';\nimport FeatureEnablement from '../environment/FeatureEnablement';\nimport IPeerConnection from './IPeerConnection';\nimport IPeerConnectionFactory from './IPeerConnectionFactory';\nimport VanillaPeerConnectionFactory from './VanillaPeerConnectionFactory';\n\nexport interface IPeerConnectionOfferInit {\n  audioTransceiver?: RTCRtpTransceiver;\n  videoTransceiver?: RTCRtpTransceiver;\n  peerConnection: IPeerConnection;\n  localOffer: RTCSessionDescriptionInit;\n}\n\nexport default class PeerConnectionService {\n  private static _logger: ILogger = LoggerFactory.getLogger('PeerConnectionService');\n  private static readonly _peerConnectionFactory: Subject<IPeerConnectionFactory> = new Subject<IPeerConnectionFactory>(new VanillaPeerConnectionFactory());\n  private static _cached: {\n    direction?: RTCRtpTransceiverDirection;\n    peerConnection: Promise<IPeerConnectionOfferInit>;\n  };\n\n  static get peerConnectionFactory(): Subject<IPeerConnectionFactory> {\n    return PeerConnectionService._peerConnectionFactory;\n  }\n\n  static initiateInitialPrecaching(): void {\n    if (FeatureEnablement.isPrecachingEnabled) {\n      const ignored = PeerConnectionService.precacheCreatePeerConnectionOffer()\n        .catch(e => PeerConnectionService._logger.error('Failed to pre-cache peer connection offer', e));\n    }\n  }\n\n  static async precacheCreatePeerConnectionOffer(): Promise<{ peerConnection: Promise<IPeerConnectionOfferInit | void>; direction: RTCRtpTransceiverDirection }> {\n    return PeerConnectionService._cached = {\n      direction: 'recvonly',\n      peerConnection: PeerConnectionService.createPeerConnectionOffer()\n        .catch(e => {\n          PeerConnectionService._cached = null;\n\n          throw e;\n        })\n    };\n  }\n\n  static async createPeerConnectionOffer(direction: RTCRtpTransceiverDirection = 'recvonly', encodedInsertableStreams = false): Promise<IPeerConnectionOfferInit> {\n    if (PeerConnectionService._cached && PeerConnectionService._cached.direction === direction && !encodedInsertableStreams) {\n      const value = PeerConnectionService._cached.peerConnection;\n\n      PeerConnectionService._cached = null;\n\n      return value;\n    }\n\n    const configuration: RTCConfiguration = FeatureEnablement.isEncodedInsertableStreamsSupported ? {encodedInsertableStreams} : undefined;\n\n    return PeerConnectionService._peerConnectionFactory.value.createPeerConnection(configuration)\n      .then(async peerConnection => {\n        const supportsAddTransceiver = peerConnection.supportsAddTransceiver;\n        let videoTransceiver, audioTransceiver;\n\n        if (supportsAddTransceiver) {\n          audioTransceiver = peerConnection.addTransceiver('audio', {direction});\n          videoTransceiver = peerConnection.addTransceiver('video', {direction});\n\n          return {\n            audioTransceiver,\n            videoTransceiver,\n            peerConnection: peerConnection,\n            localOffer: await peerConnection.createOffer(undefined)\n          };\n        }\n\n        const options = direction === 'recvonly' ? {\n          offerToReceiveAudio: true,\n          offerToReceiveVideo: true\n        } : {};\n\n        return {\n          peerConnection: peerConnection,\n          localOffer: await peerConnection.createOffer(options)\n        };\n      });\n  }\n\n  private constructor() {\n    throw new Error('PeerConnectionService is a static class that may not be instantiated');\n  }\n}\n\nPeerConnectionService.initiateInitialPrecaching();","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nexport default class TelemetryUrl {\n  static getTelemetryUrl(url: string): string {\n    try {\n      const baseURL = new URL(url);\n      const segments = baseURL.hostname.split('.');\n\n      switch (baseURL.protocol) {\n        case 'ws:':\n          baseURL.protocol = 'http:';\n\n          break;\n        case 'wss:':\n          baseURL.protocol = 'https:';\n\n          break;\n\n        default:\n          break;\n      }\n\n      if (segments.length === 2 ||\n          (segments.length === 3 && segments[segments.length - 2].length <= 2 && segments[segments.length - 1].length <= 3)\n      ) {\n        segments.unshift('telemetry');\n      } else if (segments[0].startsWith('stg-') || segments[0].endsWith('-stg') || segments[0].includes('-stg-') || segments[0] === 'stg') {\n        segments[0] = 'telemetry-stg';\n      } else if (segments[0].startsWith('local') || segments[0].endsWith('-local')) {\n        // Leave URL unchanged\n      } else {\n        segments[0] = 'telemetry';\n      }\n\n      baseURL.hostname = segments.join('.');\n\n      return `${baseURL.origin}/telemetry`;\n    } catch (e) {\n      return url;\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nexport default class Environment {\n  static getEnvironmentFromUrl(url: string): string {\n    try {\n      const baseURL = new URL(url);\n\n      return baseURL.origin;\n    } catch (e) {\n      return '';\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\ndeclare const __PARAMETERS__: {\n  discovery: IDiscoveryParameter;\n};\n\ninterface IDiscoveryParameter{\n  intentions: string;\n}\n\nexport default class Parameters {\n  private static _discoveryParameters: IDiscoveryParameter ;\n\n  static get discoveryParameters(): IDiscoveryParameter {\n    return this._discoveryParameters;\n  }\n\n  static applyParameters(): void {\n    try {\n      const parameters = __PARAMETERS__;\n\n      this._discoveryParameters = 'discovery' in parameters ? parameters.discovery : {intentions: ''};\n    } catch (e) {\n      this._discoveryParameters = {intentions: ''};\n    }\n  }\n}\n\nParameters.applyParameters();","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport {defaultDiscoveryUri} from '../defaults';\nimport Subject from '../../rx/Subject';\nimport VersionManager from '../version/VersionManager';\nimport Parameters from '../../environment/Parameters';\n\nexport default class DiscoveryUri {\n  private static readonly _discoveryUri: Subject<string> = new Subject<string>(defaultDiscoveryUri);\n\n  static get uri(): Subject<string> {\n    return DiscoveryUri._discoveryUri;\n  }\n\n  static buildDiscoveryUrl(uri: URL): string {\n    const url = new URL(uri.toString());\n    const sdkVersion = VersionManager.sdkVersion;\n    const intentions = Parameters.discoveryParameters.intentions;\n\n    url.search = `?${new URLSearchParams([['version', sdkVersion], ['intentions', intentions], ['_', `${Date.now()}`]]).toString()}`;\n\n    if (url.pathname === '/') {\n      url.pathname = '/pcast/endPoints';\n    }\n\n    return url.toString();\n  }\n\n  private constructor() {\n    throw new Error('DiscoveryUri is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nconst defaultDiscoveryUri = 'https://pcast.phenixrts.com/pcast/endPoints';\n\nexport {defaultDiscoveryUri};","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nconst defaultBackoffIntervalInMillisecond = 2000;\nconst defaultMinBackoffIntervalInMillisecond = 1;\nconst defaultMaxBackoffIntervalInMillisecond = 300000;\n\nexport default class ExponentialBackoff {\n  private readonly _backoffIntervalInMillisecond: number;\n  private readonly _minBackoffIntervalInMillisecond: number;\n  private readonly _maxBackoffIntervalInMillisecond: number;\n\n  constructor(\n    backoffIntervalInMillisecond: number = defaultBackoffIntervalInMillisecond,\n    minBackoffIntervalInMillisecond: number = defaultMinBackoffIntervalInMillisecond,\n    maxBackoffIntervalInMillisecond: number = defaultMaxBackoffIntervalInMillisecond\n  ) {\n    this._backoffIntervalInMillisecond = backoffIntervalInMillisecond;\n    this._minBackoffIntervalInMillisecond = minBackoffIntervalInMillisecond;\n    this._maxBackoffIntervalInMillisecond = maxBackoffIntervalInMillisecond;\n  }\n\n  getExponentialBackoffIntervalByFailureCount(failureCount: number): number {\n    const backoffIntervalInSeconds = this._backoffIntervalInMillisecond / 1000;\n    const randomization = 0.5 + (0.5 * Math.random()); // [0.5, 1)\n    const exponentialBackoff = Math.pow(backoffIntervalInSeconds, failureCount - 2); //  [1/4 1/2 1 2 4 8 ....]\n    const exponentialBackoffWithRandomization = Math.floor(exponentialBackoff) * randomization;\n    const exponentialBackoffWithRandomizationInMillisecond = Math.ceil(Math.max(exponentialBackoffWithRandomization * 1000, this._minBackoffIntervalInMillisecond));\n\n    return Math.min(exponentialBackoffWithRandomizationInMillisecond, this._maxBackoffIntervalInMillisecond);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nenum MetricsType {\n  TimeToFirstFrame,\n  ChannelCreationTimeToFirstFrame,\n  Stalled,\n  Buffering,\n  SetupCompleted,\n  SetupFailed,\n  RoundTripTime,\n  DownlinkThroughputCapacity,\n  NetworkType,\n  ResolutionChanged,\n  ApplicationForeground,\n  ApplicationBackground\n}\n\nexport default MetricsType;","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {TelemetryLevel} from './MetricsConfiguration';\nimport assertUnreachable from '../lang/assertUnreachable';\nimport MetricsType from './MetricsType';\n\nexport default class MetricType {\n  private readonly _metrics: MetricsType;\n\n  constructor(metrics: MetricsType) {\n    this._metrics = metrics;\n  }\n\n  getName(): string {\n    return MetricsType[this._metrics];\n  }\n\n  getTelemetryLevel(): TelemetryLevel {\n    switch (this._metrics) {\n      case MetricsType.TimeToFirstFrame:\n        return TelemetryLevel.Essential;\n      case MetricsType.ChannelCreationTimeToFirstFrame:\n        return TelemetryLevel.Essential;\n      case MetricsType.Stalled:\n        return TelemetryLevel.All;\n      case MetricsType.Buffering:\n        return TelemetryLevel.All;\n      case MetricsType.SetupCompleted:\n        return TelemetryLevel.All;\n      case MetricsType.SetupFailed:\n        return TelemetryLevel.All;\n      case MetricsType.RoundTripTime:\n        return TelemetryLevel.All;\n      case MetricsType.DownlinkThroughputCapacity:\n        return TelemetryLevel.All;\n      case MetricsType.NetworkType:\n        return TelemetryLevel.All;\n      case MetricsType.ResolutionChanged:\n        return TelemetryLevel.All;\n      case MetricsType.ApplicationForeground:\n        return TelemetryLevel.All;\n      case MetricsType.ApplicationBackground:\n        return TelemetryLevel.All;\n      default:\n        assertUnreachable(this._metrics);\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {ILogger} from '../logger/LoggerInterface';\nimport LoggerFactory from '../logger/LoggerFactory';\nimport ExponentialBackoff from '../time/ExponentialBackoff';\nimport VersionManager from '../sdk/version/VersionManager';\nimport MetricsConfiguration from './MetricsConfiguration';\nimport MetricType from './MetricType';\nimport MetricsType from './MetricsType';\n\nconst requestSizeLimit = 1024;\nconst maxBufferedRecords = 2048;\n\ninterface IValue {\n  string?: string;\n  uint64?: number;\n  float?: number;\n}\n\ninterface IMetricRecord {\n  timestamp: string;\n  tenancy: string;\n  sessionId: string;\n  streamId: string;\n  metric: string;\n  value: IValue;\n  previousValue: IValue;\n  fullQualifiedName: string;\n  environment: string;\n  version: string;\n  runtime: number;\n  resource?: string;\n  kind?: string;\n}\n\ninterface IMetric {\n  streamId?: string;\n  metricType: MetricsType;\n  value?: IValue;\n  previousValue?: IValue;\n  runtime: number;\n  resource?: string;\n  kind?: string;\n}\n\nexport default class MetricsService {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('MetricsService');\n  private readonly _metricsConfiguration: MetricsConfiguration;\n  private readonly _exponentialBackoff: ExponentialBackoff;\n  private _metrics: Array<IMetricRecord> = [];\n  private _isSending: boolean;\n  private _failureCount = 0;\n  private _domain = location.hostname;\n\n  constructor(metricsConfiguration: MetricsConfiguration) {\n    this._metricsConfiguration = metricsConfiguration;\n    this._exponentialBackoff = new ExponentialBackoff();\n  }\n\n  get metricsConfiguration(): MetricsConfiguration {\n    return this._metricsConfiguration;\n  }\n\n  push(metric: IMetric): void {\n    const {streamId, value, previousValue, runtime, resource, kind} = metric;\n    const metricType = new MetricType(metric.metricType);\n\n    if (this._metricsConfiguration.threshold > metricType.getTelemetryLevel()) {\n      return;\n    }\n\n    const metricRecord = {\n      timestamp: new Date().toISOString(),\n      tenancy: this._metricsConfiguration.tenancy,\n      sessionId: this._metricsConfiguration.sessionId,\n      streamId,\n      metric: metricType.getName(),\n      value,\n      previousValue,\n      fullQualifiedName: this._domain,\n      environment: this._metricsConfiguration.environment,\n      version: VersionManager.sdkVersion,\n      runtime,\n      resource,\n      kind\n    };\n\n    this._metrics.push(metricRecord);\n\n    const ignored = this.sendMetricsIfAble();\n  }\n\n  private async sendMetrics(metricsMessages: Array<IMetricRecord>): Promise<Response> {\n    const formData = new FormData();\n\n    formData.append('jsonBody', JSON.stringify({records: metricsMessages}));\n\n    return await fetch(this._metricsConfiguration.url, {\n      method: 'POST',\n      body: formData\n    });\n  }\n\n  private async sendMetricsIfAble(): Promise<Response | void> {\n    if (this._metrics.length <= 0 || this._isSending) {\n      return;\n    }\n\n    this._isSending = true;\n\n    const metricsMessages = this._metrics.slice(0, requestSizeLimit);\n\n    this._metrics = this._metrics.slice(requestSizeLimit);\n\n    return this.sendMetrics(metricsMessages).then(response => {\n      if (this.isResponseStatusCodeRetryable(response)) {\n        if (this._metrics.length <= maxBufferedRecords) {\n          this._failureCount++;\n\n          setTimeout(() => {\n            this._metrics = [...metricsMessages, ...this._metrics];\n\n            this._isSending = false;\n\n            const ignored = this.sendMetricsIfAble();\n          }, this._exponentialBackoff.getExponentialBackoffIntervalByFailureCount(this._failureCount));\n\n          return;\n        }\n\n        this._logger.error('Too many cached metric records [%s], dropping [%s] records', this._metrics.length, metricsMessages.length);\n      }\n\n      this._isSending = false;\n      this._failureCount = 0;\n\n      const ignored = this.sendMetricsIfAble();\n\n      return response;\n    }).catch(() => {\n      this._isSending = false;\n\n      const ignored = this.sendMetricsIfAble();\n    });\n  }\n\n  private isResponseStatusCodeRetryable({status}: Response): boolean {\n    return /^5\\d{2}$/.test(status.toString());\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport MetricsService from './MetricsService';\nimport MetricsConfiguration, {TelemetryLevel} from './MetricsConfiguration';\nimport SDK from '../sdk/SDK';\nimport TelemetryUrl from '../sdk/TelemetryUrl';\nimport Environment from '../sdk/Environment';\nimport TelemetryLevelMapping from './TelemetricLevelMapping';\n\nexport default class MetricsFactory {\n  private static _metricsServices: {[category: string]: MetricsService} = {};\n\n  static getMetricsService(url: string): MetricsService {\n    if (typeof url !== 'string') {\n      throw new Error('ur');\n    }\n\n    const metricsServices = MetricsFactory._metricsServices[url];\n\n    if (metricsServices) {\n      return metricsServices;\n    }\n\n    const metricsConfiguration = new MetricsConfiguration();\n\n    metricsConfiguration.sessionId = SDK.clientSessionId;\n    metricsConfiguration.tenancy = SDK.tenancy.value;\n    metricsConfiguration.url = TelemetryUrl.getTelemetryUrl(url);\n    metricsConfiguration.environment = Environment.getEnvironmentFromUrl(url);\n\n    metricsConfiguration.threshold = TelemetryLevelMapping.convertTelemetryLevelTypeToTelemetryLevel(SDK.telemetryLevel);\n\n    return MetricsFactory._metricsServices[url] = new MetricsService(metricsConfiguration);\n  }\n\n  static setTelemetryLevel(telemetryLevel: TelemetryLevel): void {\n    const metricsServices = Object.values(MetricsFactory._metricsServices);\n\n    if (metricsServices && metricsServices.length) {\n      metricsServices.forEach(metricsService => {\n        const metricsConfiguration = metricsService.metricsConfiguration;\n\n        metricsConfiguration.threshold = telemetryLevel;\n      });\n    }\n  }\n\n  private constructor() {\n    throw new Error('LoggerFactory is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../logger/LoggerFactory';\nimport Strings from '../lang/Strings';\nimport Subject from '../rx/Subject';\nimport ReadOnlySubject from '../rx/ReadOnlySubject';\nimport EdgeAuthParser from '../edgeAuth/EdgeAuthParser';\nimport {ILogger} from '../logger/LoggerInterface';\nimport {LoggingLevel, LoggingLevelType} from '../logger/Logger';\nimport ConsoleAppender from '../logger/ConsoleAppender';\nimport TelemetryAppender from '../telemetry/TelemetryApender';\nimport ConfigurationParameterReader from '../dom/ConfigurationParameterReader';\nimport MetricsConfiguration, {TelemetryLevel, TelemetryLevelType} from '../metrics/MetricsConfiguration';\nimport MetricsService from '../metrics/MetricsService';\nimport TelemetryLevelMapping from '../metrics/TelemetricLevelMapping';\nimport LoggingLevelMapping from '../logger/LoggingLevelMapping';\nimport BuildFeatures from '../environment/BuildFeatures';\nimport BrowserDetector from '../dom/BrowserDetector';\nimport {IConfigurationParameterReader} from '../dom/IConfigurationParamaterReader';\nimport ApplicationActivityMonitor from '../dom/ApplicationActivityMonitor';\nimport IPeerConnectionFactory from '../rtc/IPeerConnectionFactory';\nimport PeerConnectionService from '../rtc/PeerConnectionService';\nimport TelemetryUrl from './TelemetryUrl';\nimport Environment from './Environment';\nimport {HlsPlayerType, ShakaType, WebPlayerType} from './streaming/StreamTypes';\nimport DiscoveryUri from './discovery/DiscoveryUri';\nimport MetricsFactory from '../metrics/MetricsFactory';\nimport TelemetryDefault from '../metrics/TelemetryDefault';\n\nconst pageLoadTime = window['__phenixPageLoadTime'] || window['__pageLoadTime'] || Date.now();\n\ninterface IInitOptions {\n  discoveryUri?: string;\n  peerConnectionFactory?: IPeerConnectionFactory;\n  telemetryLevel?: TelemetryLevelType;\n  loggingLevel?: LoggingLevelType;\n  consoleLoggingLevel?: LoggingLevelType;\n  automaticallyPlayMediaStream?: boolean;\n  automaticallyMuteVideoOnPlayFailure?: boolean;\n  webPlayerLoader?: (player: WebPlayerType) => void;\n  shakaPlayerLoader?: (player: ShakaType) => void;\n  hlsJsLoader?: (player: HlsPlayerType) => void;\n}\n\nexport default class SDK {\n  private static _automaticallyRetryOnFailure = true;\n  private static _automaticallyReconnectPeerConnection = true;\n  private static _automaticallyPlayMediaStream = true;\n  private static _automaticallyMuteVideoOnPlayFailure = true;\n  private static _forceGarbageCollectionOnRestart = true;\n  private static _skipGarbageCollectionOnMobileDevices = true;\n  private static _webPlayerLoader = null;\n  private static _shakaPlayerLoader = null;\n  private static _hlsJsLoader = null;\n  private static _configurationParameterReader: IConfigurationParameterReader = new ConfigurationParameterReader();\n  private static _applicationActivityMonitor: ApplicationActivityMonitor;\n  private static _environment: Subject<string> = new Subject<string>('');\n  private static _telemetryUrl: Subject<string> = new Subject<string>('https://telemetry.phenixrts.com/telemetry');\n  private static _maximalNumberOfPeerConnectionReconnectAttempts = 8;\n  private static _telemetryLevel: Subject<TelemetryLevel> = new Subject<TelemetryLevel>(TelemetryDefault.defaultTelemetryLevel);\n  private static _metricsService: MetricsService;\n  private static _metricsConfiguration: MetricsConfiguration;\n  private static readonly _sendLocalCandidates: Subject<boolean> = new Subject(BuildFeatures.sendLocalCandidates);\n  private static readonly _tenancy: Subject<string> = new Subject<string>('');\n  private static readonly _clientSessionId: string = Strings.random(32);\n  private static readonly _loadedTimestamp: Date = new Date();\n  private static readonly _logger: ILogger = LoggerFactory.getLogger('SDK');\n  private static readonly _initialized: Subject<boolean> = new Subject<boolean>(false);\n  private static readonly _readOnlyInitialized: ReadOnlySubject<boolean> = new ReadOnlySubject<boolean>(SDK._initialized);\n  private static readonly _readOnlyDiscoveryUri: ReadOnlySubject<string> = new ReadOnlySubject<string>(DiscoveryUri.uri);\n  private static readonly _readOnlyPeerConnectionFactory: ReadOnlySubject<IPeerConnectionFactory> = new ReadOnlySubject<IPeerConnectionFactory>(PeerConnectionService.peerConnectionFactory);\n\n  static get pageLoadTime(): number {\n    return pageLoadTime;\n  }\n\n  static get sendLocalCandidates(): Subject<boolean> {\n    return this._sendLocalCandidates;\n  }\n\n  static get tenancy(): Subject<string> {\n    return this._tenancy;\n  }\n\n  static get clientSessionId(): string {\n    return SDK._clientSessionId;\n  }\n\n  static get loadedTimestamp(): Date {\n    return SDK._loadedTimestamp;\n  }\n\n  static get initialized(): ReadOnlySubject<boolean> {\n    return SDK._readOnlyInitialized;\n  }\n\n  static get discoveryUri(): ReadOnlySubject<string> {\n    return SDK._readOnlyDiscoveryUri;\n  }\n\n  static get peerConnectionFactory(): ReadOnlySubject<IPeerConnectionFactory> {\n    return SDK._readOnlyPeerConnectionFactory;\n  }\n\n  static get automaticRetryOnFailure(): boolean {\n    return SDK._automaticallyRetryOnFailure;\n  }\n\n  static get automaticallyReconnectPeerConnection(): boolean {\n    return SDK._automaticallyReconnectPeerConnection;\n  }\n\n  static get automaticallyPlayMediaStream(): boolean {\n    return SDK._automaticallyPlayMediaStream;\n  }\n\n  static get automaticallyMuteVideoOnPlayFailure(): boolean {\n    return SDK._automaticallyMuteVideoOnPlayFailure;\n  }\n\n  static get forceGarbageCollectionOnRestart(): boolean {\n    return this._forceGarbageCollectionOnRestart;\n  }\n\n  static get skipGarbageCollectionOnMobileDevices(): boolean {\n    return this._skipGarbageCollectionOnMobileDevices;\n  }\n\n  static get webPlayerLoader(): (WebPlayerType) => void {\n    return this._webPlayerLoader;\n  }\n\n  static get shakaPlayerLoader(): (ShakaType) => void {\n    return this._shakaPlayerLoader;\n  }\n\n  static get hlsJsLoader(): (HlsPlayerType) => void {\n    return this._hlsJsLoader;\n  }\n\n  static get metricsService(): MetricsService {\n    return SDK._metricsService;\n  }\n\n  static get applicationActivityMonitor(): ApplicationActivityMonitor {\n    return this._applicationActivityMonitor;\n  }\n\n  static get telemetryUrl(): Subject<string> {\n    return this._telemetryUrl;\n  }\n\n  static get maximalNumberOfPeerConnectionReconnectAttempts(): number {\n    return this._maximalNumberOfPeerConnectionReconnectAttempts;\n  }\n\n  static set maximalNumberOfPeerConnectionReconnectAttempts(retriesAmount: number) {\n    this._maximalNumberOfPeerConnectionReconnectAttempts = retriesAmount;\n  }\n\n  static get loggingLevel(): LoggingLevelType {\n    return LoggingLevelMapping.convertLoggingLevelToLoggingLevelType(this._logger.threshold.value);\n  }\n\n  static get telemetryLevel(): TelemetryLevelType {\n    return TelemetryLevelMapping.convertTelemetryLevelToTelemetryLevelType(SDK._telemetryLevel.value);\n  }\n\n  static get browserDetector(): BrowserDetector {\n    return BrowserDetector;\n  }\n\n  static applyTelemetryConfiguration(): void {\n    const telemetryConfiguration = LoggerFactory.telemetryConfiguration;\n\n    telemetryConfiguration.sessionId = SDK.clientSessionId;\n\n    const ignoredEnvironment = SDK._environment.subscribe(environment => {\n      telemetryConfiguration.environment = environment;\n    });\n    const ignoredDiscoveryUri = SDK.telemetryUrl.subscribe(value => {\n      const telemetryAppender = this._logger.appenders.value.find(appender => appender instanceof TelemetryAppender);\n\n      if (telemetryAppender) {\n        telemetryConfiguration.url = value;\n\n        this._logger.appenders.remove(telemetryAppender);\n        this._logger.appenders.add(new TelemetryAppender(telemetryConfiguration));\n        this._logger.info('Telemetry URL was set to [%s]', telemetryConfiguration.url);\n      }\n    });\n    const ignoredTenancy = SDK._tenancy.subscribe(tenancy => {\n      const telemetryAppender = this._logger.appenders.value.find(appender => appender instanceof TelemetryAppender);\n\n      if (telemetryAppender && tenancy) {\n        telemetryConfiguration.tenancy = tenancy;\n\n        this._logger.appenders.remove(telemetryAppender);\n        this._logger.appenders.add(new TelemetryAppender(telemetryConfiguration));\n        this._logger.info('Telemetry tenancy was set to [%s]', telemetryConfiguration.tenancy);\n      }\n    });\n  }\n\n  static applyMetricsConfiguration(): void {\n    SDK._metricsService = MetricsFactory.getMetricsService(DiscoveryUri.uri.value);\n    SDK._metricsConfiguration = SDK._metricsService.metricsConfiguration;\n\n    SDK._metricsConfiguration.sessionId = SDK.clientSessionId;\n\n    const ignoredEnvironment = SDK._environment.subscribe(environment => {\n      SDK._metricsConfiguration.environment = environment;\n    });\n    const ignoredDiscoveryUri = SDK.telemetryUrl.subscribe(value => {\n      SDK._metricsConfiguration.url = value;\n    });\n    const ignoredTenancy = SDK._tenancy.subscribe(tenancy => {\n      SDK._metricsConfiguration.tenancy = tenancy;\n    });\n    const value = this._configurationParameterReader.getStringValue('phenix-metrics-level');\n\n    if (value) {\n      MetricsFactory.setTelemetryLevel(TelemetryLevel[value]);\n    }\n\n    const ignoredTelemetryLevel = SDK._telemetryLevel.subscribe(telemetryLevel => {\n      MetricsFactory.setTelemetryLevel(telemetryLevel);\n    });\n  }\n\n  static applyAutomaticallyRetryOnFailureFromParameterConfiguration(): void {\n    this._automaticallyRetryOnFailure = this._configurationParameterReader.getBooleanValue('phenix-automatically-retry-on-failure');\n    this._logger.info('Automatically retry on failure is set to: [%s]', this._automaticallyRetryOnFailure);\n\n    return;\n  }\n\n  static applyAutomaticallyReconnectPeerConnectionFromParameterConfiguration(): void {\n    this._automaticallyReconnectPeerConnection = this._configurationParameterReader.getBooleanValue('phenix-automatically-reconnect-peer-connection');\n    this._logger.info('Automatically reconnect peer connection is set to: [%s]', this._automaticallyReconnectPeerConnection);\n\n    return;\n  }\n\n  static applyForceGarbageCollectionOnRestartFromParameterConfiguration(): void {\n    this._forceGarbageCollectionOnRestart = this._configurationParameterReader.getBooleanValue('phenix-force-garbage-collection-on-restart');\n    this._logger.info('Force garbage collection on restart is set to: [%s]', this._forceGarbageCollectionOnRestart);\n\n    return;\n  }\n\n  static applySkipGarbageCollectionOnMobileDevicesFromParameterConfiguration(): void {\n    this._skipGarbageCollectionOnMobileDevices = this._configurationParameterReader.getBooleanValue('phenix-skip-garbage-collection-on-mobile-devices');\n    this._logger.info('Skip garbage collection on mobile devices on restart is set to: [%s]', this._skipGarbageCollectionOnMobileDevices);\n\n    return;\n  }\n\n  static applyDiscoveryUriDefaultFromParameterConfiguration(): void {\n    SDK.discoveryUri.subscribe(value => {\n      SDK.telemetryUrl.value = SDK.getTelemetryUrl(value);\n      SDK._environment.value = Environment.getEnvironmentFromUrl(value);\n    });\n\n    const channelToken = this._configurationParameterReader.getStringValue('phenix-channel-token');\n\n    if (channelToken) {\n      const edgeToken = EdgeAuthParser.parseToken(channelToken);\n\n      SDK._tenancy.value = edgeToken.tenancy;\n      DiscoveryUri.uri.value = (edgeToken.uri || SDK.discoveryUri.value).toString();\n\n      this._logger.info('Discovery URI set from configuration parameter to [%s]', SDK.discoveryUri.value);\n\n      return;\n    }\n\n    const uriValue = this._configurationParameterReader.getStringValue('phenix-uri');\n\n    if (uriValue) {\n      DiscoveryUri.uri.value = uriValue;\n      this._logger.info('Discovery URI set from \"phenix-uri\" configuration parameter tag to [%s]', SDK.discoveryUri.value);\n\n      return;\n    }\n\n    const baseURIValue = this._configurationParameterReader.getStringValue('phenix-base-uri');\n\n    if (baseURIValue) {\n      DiscoveryUri.uri.value = `${baseURIValue}/pcast/endPoints`;\n      this._logger.info('Discovery URI set from \"phenix-base-uri\" configuration parameter tag to [%s]', SDK.discoveryUri.value);\n\n      return;\n    }\n  }\n\n  static init(options?: IInitOptions): void {\n    if (!this._initialized.value) {\n      this._applicationActivityMonitor = new ApplicationActivityMonitor();\n    }\n\n    if (options) {\n      if (options.discoveryUri) {\n        DiscoveryUri.uri.value = options.discoveryUri;\n      }\n\n      if (options.peerConnectionFactory) {\n        PeerConnectionService.peerConnectionFactory.value = options.peerConnectionFactory;\n      }\n\n      if (options.telemetryLevel && TelemetryLevel[options.telemetryLevel]) {\n        SDK._telemetryLevel.value = TelemetryLevelMapping.convertTelemetryLevelTypeToTelemetryLevel(options.telemetryLevel);\n      }\n\n      if (options.loggingLevel && LoggingLevel[options.loggingLevel]) {\n        this._logger.threshold.setThreshold(LoggingLevelMapping.convertLoggingLevelTypeToLoggingLevel(options.loggingLevel));\n      }\n\n      if (options.consoleLoggingLevel &&\n        LoggingLevel[options.consoleLoggingLevel]) {\n        const consoleAppender = this._logger.appenders.value.find(appender => appender instanceof ConsoleAppender);\n\n        if (consoleAppender) {\n          this._logger.appenders.remove(consoleAppender);\n        }\n\n        if (options.consoleLoggingLevel !== 'Off') {\n          this._logger.appenders.add(new ConsoleAppender(LoggingLevelMapping.convertLoggingLevelTypeToLoggingLevel(options.consoleLoggingLevel)));\n        }\n      }\n\n      if (typeof options.automaticallyPlayMediaStream === 'boolean') {\n        this._automaticallyPlayMediaStream = options.automaticallyPlayMediaStream;\n      }\n\n      if (typeof options.automaticallyMuteVideoOnPlayFailure === 'boolean') {\n        this._automaticallyMuteVideoOnPlayFailure = options.automaticallyMuteVideoOnPlayFailure;\n      }\n\n      if (options.webPlayerLoader) {\n        this._webPlayerLoader = options.webPlayerLoader;\n      }\n\n      if (options.shakaPlayerLoader) {\n        this._shakaPlayerLoader = options.shakaPlayerLoader;\n      }\n\n      if (options.hlsJsLoader) {\n        this._hlsJsLoader = options.hlsJsLoader;\n      }\n    }\n\n    SDK._initialized.value = true;\n  }\n\n  static dispose(): void {\n    SDK._initialized.value = false;\n    this._applicationActivityMonitor.dispose();\n    this._applicationActivityMonitor = null;\n  }\n\n  static getTelemetryUrl(url: string): string {\n    return TelemetryUrl.getTelemetryUrl(url);\n  }\n\n  private constructor() {\n    throw new Error('SDK is a static class that may not be instantiated');\n  }\n}\n\nwindow.addEventListener('unload', () => {\n  SDK.dispose();\n});\n\nSDK.applyDiscoveryUriDefaultFromParameterConfiguration();\nSDK.applyMetricsConfiguration();\nSDK.applyTelemetryConfiguration();\nSDK.applyAutomaticallyRetryOnFailureFromParameterConfiguration();\nSDK.applyAutomaticallyReconnectPeerConnectionFromParameterConfiguration();\nSDK.applyForceGarbageCollectionOnRestartFromParameterConfiguration();\nSDK.applySkipGarbageCollectionOnMobileDevicesFromParameterConfiguration();\nSDK.init();","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport IComparable from '../lang/IComparable';\n\nexport default class Dimension implements IComparable<Dimension> {\n  readonly width: number;\n  readonly height: number;\n\n  static get empty(): Dimension {\n    return new Dimension(0, 0);\n  }\n\n  constructor(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n  }\n\n  equals(other: Dimension): boolean {\n    return other && this.width === other.width && this.height === other.height;\n  }\n\n  toString(): string {\n    return `${this.width}x${this.height}`;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport FeatureEnablement from '../environment/FeatureEnablement';\n\nexport default class GarbageCollectorManager {\n  static forceGarbageCollection(): void {\n    if (FeatureEnablement.isForceChromeGarbageCollectionSupported) {\n      this.forceChromeGarbageCollection();\n    }\n  }\n\n  private static forceChromeGarbageCollection(): void {\n    if (FeatureEnablement.isQueueMicrotaskSupported) {\n      queueMicrotask(() => {\n        this.overloadMemoryToInvokeGarbageCollection();\n      });\n    } else {\n      setTimeout(() => {\n        this.overloadMemoryToInvokeGarbageCollection();\n      });\n    }\n  }\n\n  private static overloadMemoryToInvokeGarbageCollection(): void {\n    let img = document.createElement('img');\n\n    img.src = window.URL.createObjectURL(new Blob([new ArrayBuffer(10e+7)])); // 100Mb or less or more depending on as you wish to force/invoke GC cycle run\n    img.onerror = function() {\n      window.URL.revokeObjectURL(this.src);\n\n      img = null;\n    };\n  }\n\n  private constructor() {\n    throw new Error('GarbageCollectorManager is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nenum ChannelState {\n  Offline = 1,\n  Starting,\n  Paused,\n  Playing,\n  Recovering,\n  Reconnecting,\n  StandBy,\n  Stopped,\n  Unauthorized,\n  GeoRestricted,\n  GeoBlocked,\n  UnsupportedFeature,\n  ConfigurationError,\n  TransientConfigurationError,\n  ConnectionError,\n  ClientStartError,\n  Error\n}\n\nexport default ChannelState;","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nexport default class Durations {\n  private readonly _duration: number;\n\n  constructor(duration = 0) {\n    this._duration = duration;\n  }\n\n  toIsoString(): string {\n    if (this._duration === 0) {\n      return 'P0S';\n    }\n\n    const isNegative = this._duration < 0;\n    const duration = isNegative ? Math.abs(this._duration) : this._duration;\n    let offset = Math.floor(duration);\n    const milliseconds = offset % 1000;\n\n    offset = Math.floor(offset / 1000);\n\n    const seconds = offset % 60;\n\n    offset = Math.floor(offset / 60);\n\n    const minutes = offset % 60;\n\n    offset = Math.floor(offset / 60);\n\n    const hours = offset % 24;\n    const parts = ['PT'];\n\n    if (isNegative) {\n      parts.unshift('-');\n    }\n\n    if (hours) {\n      parts.push(hours + 'H');\n    }\n\n    if (minutes) {\n      parts.push(minutes + 'M');\n    }\n\n    if (seconds || milliseconds) {\n      parts.push(String(seconds));\n\n      if (milliseconds) {\n        parts.push('.' + this.padStart(milliseconds.toString(), 3, '0'));\n      }\n\n      parts.push('S');\n    }\n\n    return parts.join('');\n  }\n\n  padStart(item: string, targetLength: number, padString: string): string {\n    targetLength = targetLength >> 0;\n    padString = String((typeof padString !== 'undefined' ? padString : ' '));\n\n    if (item.length > targetLength) {\n      return item;\n    }\n\n    targetLength = targetLength - item.length;\n\n    if (targetLength > padString.length) {\n      padString += padString.repeat(targetLength / padString.length);\n    }\n\n    return padString.slice(0, targetLength) + item;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../logger/LoggerFactory';\nimport {ILogger} from '../logger/LoggerInterface';\nimport Durations from '../time/Duration';\nimport Disposable from '../lang/Disposable';\nimport IDisposable from '../lang/IDisposable';\nimport MetricsType from '../metrics/MetricsType';\nimport DisposableList from '../lang/DisposableList';\nimport MetricsService from '../metrics/MetricsService';\n\nexport default class VideoTelemetry implements IDisposable {\n  private readonly _pageLoadTime: number;\n  private readonly _channelStartTime: number;\n  private readonly _logger: ILogger = LoggerFactory.getLogger('StreamTelemetry');\n  private readonly _disposables: DisposableList = new DisposableList();\n  private readonly _streamId: string;\n  private readonly _metricsService: MetricsService;\n  private _listenToFirstTime: () => void;\n  private _listenForStall: () => void;\n  private _listenForContinuation: (event) => void;\n  private _timeToFirstFrame: number;\n  private _channelCreationTimeToFirstFrame: number;\n  private _startRecordingFirstFrame: number;\n  private _videoStalled: number;\n  private _lastProgress: number;\n  private _videoResolution: string;\n  private _clearTimeToFirstFrameListener: Disposable;\n  private _clearRebufferingListener: Disposable;\n\n  constructor(streamId: string, pageLoadTime: number, channelStartTime: number, metricsService: MetricsService) {\n    this._streamId = streamId;\n    this._pageLoadTime = pageLoadTime;\n    this._channelStartTime = channelStartTime;\n\n    this._metricsService = metricsService;\n  }\n\n  setupListenerForTimeToFirstTime(video: HTMLVideoElement): void {\n    this._startRecordingFirstFrame = Date.now();\n\n    this._listenToFirstTime = (): void => this.callTimeToFirstFrame();\n\n    video.addEventListener('loadeddata', this._listenToFirstTime);\n    video.addEventListener('loadedmetadata', this._listenToFirstTime);\n\n    this._clearTimeToFirstFrameListener = new Disposable(() => {\n      video.removeEventListener('loadeddata', this._listenToFirstTime);\n      video.removeEventListener('loadedmetadata', this._listenToFirstTime);\n    });\n    this._disposables.add(this._clearTimeToFirstFrameListener);\n  }\n\n  setupListenerForRebuffering(video: HTMLVideoElement): void {\n    this._listenForStall = (): void => this.onStall();\n\n    this._listenForContinuation = (event): void => this.onContinuation(event, video);\n\n    video.addEventListener('stalled', this._listenForStall);\n    video.addEventListener('pause', this._listenForStall);\n    video.addEventListener('suspend', this._listenForStall);\n    video.addEventListener('play', this._listenForContinuation);\n    video.addEventListener('playing', this._listenForContinuation);\n    video.addEventListener('progress', this._listenForContinuation);\n    video.addEventListener('timeupdate', this._listenForContinuation);\n\n    this._clearRebufferingListener = new Disposable(() => {\n      video.removeEventListener('stalled', this._listenForStall);\n      video.removeEventListener('pause', this._listenForStall);\n      video.removeEventListener('suspend', this._listenForStall);\n      video.removeEventListener('play', this._listenForContinuation);\n      video.removeEventListener('playing', this._listenForContinuation);\n      video.removeEventListener('progress', this._listenForContinuation);\n      video.removeEventListener('timeupdate', this._listenForContinuation);\n    });\n\n    this._disposables.add(this._clearRebufferingListener);\n  }\n\n  dispose(): void {\n    this._disposables.dispose();\n  }\n\n  private get durationSincePageLoad(): string {\n    const now = Date.now();\n\n    return new Durations(now - this._pageLoadTime).toIsoString();\n  }\n\n  private callTimeToFirstFrame(): void {\n    const now = Date.now();\n\n    this.pushTimeToFirstFrame(now);\n    this.pushChannelCreationTimeToFirstFrame(now);\n\n    this._clearTimeToFirstFrameListener.dispose();\n  }\n\n  private pushTimeToFirstFrame(now): void {\n    this._timeToFirstFrame = now - this._startRecordingFirstFrame;\n\n    this._metricsService.push({\n      metricType: MetricsType.TimeToFirstFrame,\n      runtime: (now - this._pageLoadTime) / 1000,\n      value: {uint64: this._timeToFirstFrame},\n      streamId: this._streamId\n    });\n\n    this._logger.info(\n      '[%s] [%s] First frame [%s]',\n      this.durationSincePageLoad,\n      this._streamId,\n      new Durations(this._timeToFirstFrame).toIsoString()\n    );\n  }\n\n  private pushChannelCreationTimeToFirstFrame(now): void {\n    this._channelCreationTimeToFirstFrame = now - this._channelStartTime;\n\n    this._metricsService.push({\n      metricType: MetricsType.ChannelCreationTimeToFirstFrame,\n      runtime: (now - this._pageLoadTime) / 1000,\n      value: {uint64: this._channelCreationTimeToFirstFrame},\n      streamId: this._streamId\n    });\n\n    this._logger.info(\n      '[%s] [%s] Channel creation to first frame [%s]',\n      this.durationSincePageLoad,\n      this._streamId,\n      new Durations(this._channelCreationTimeToFirstFrame).toIsoString()\n    );\n  }\n\n  private onStall(): void {\n    if (this._videoStalled) {\n      return;\n    }\n\n    this._metricsService.push({\n      metricType: MetricsType.Stalled,\n      runtime: (Date.now() - this._pageLoadTime) / 1000,\n      streamId: this._streamId\n    });\n\n    this._videoStalled = Date.now();\n\n    this._logger.info(\n      '[%s] [%s] [buffering] Stream has stalled',\n      this.durationSincePageLoad,\n      this._streamId\n    );\n  }\n\n  private onContinuation(event, video): void {\n    if (!video.buffered) {\n      return;\n    }\n\n    const bufferLength = video.buffered.length;\n    const hasNotProgressedSinceLastProgressEvent = event.type === 'playing'\n    || bufferLength > 0 ? (event.type === 'progress'\n      || event.type === 'timeupdate')\n      && video.buffered.end(bufferLength - 1) === this._lastProgress : true;\n\n    if (!this._videoStalled || hasNotProgressedSinceLastProgressEvent) {\n      return;\n    }\n\n    if (event.type === 'progress') {\n      this._lastProgress = video.buffered.end(bufferLength - 1);\n    }\n\n    const timeSinceStop = Date.now() - this._videoStalled;\n\n    this._metricsService.push({\n      metricType: MetricsType.Buffering,\n      runtime: (Date.now() - this._pageLoadTime) / 1000,\n      value: {uint64: timeSinceStop},\n      streamId: this._streamId\n    });\n\n    this._logger.info(\n      '[%s] [%s] [buffering] Stream has recovered from stall after [%s]',\n      this.durationSincePageLoad,\n      this._streamId,\n      new Durations(timeSinceStop).toIsoString()\n    );\n    this._videoStalled = null;\n  }\n\n  onVideoResolutionChanges(newResolution: string): void {\n    this._metricsService.push({\n      metricType: MetricsType.ResolutionChanged,\n      runtime: (Date.now() - this._pageLoadTime) / 1000,\n      value: {string: newResolution},\n      previousValue: this._videoResolution ? {string: this._videoResolution} : undefined,\n      streamId: this._streamId\n    });\n\n    this._videoResolution = newResolution;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport MetricsType from '../metrics/MetricsType';\nimport MetricType from '../metrics/MetricType';\nimport Durations from '../time/Duration';\nimport {ILogger} from '../logger/LoggerInterface';\nimport SDK from '../sdk/SDK';\nimport LoggerFactory from '../logger/LoggerFactory';\n\nexport class StreamSetupListener {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('StreamSetupListener');\n  private readonly metricsService = SDK.metricsService;\n  private readonly _pageLoadTime: number;\n  private readonly _startTime: number;\n  private _metricSubmitted = false;\n\n  constructor(pageLoadTime: number) {\n    this._startTime = Date.now();\n    this._pageLoadTime = pageLoadTime;\n  }\n\n  success(streamId): void {\n    this.recordStreamMetric(MetricsType.SetupCompleted, streamId);\n  }\n\n  fail(): void {\n    this.recordStreamMetric(MetricsType.SetupFailed);\n  }\n\n  private recordStreamMetric(metricType: MetricsType, streamId?: string): void {\n    if (this._metricSubmitted) {\n      return ;\n    }\n\n    this._metricSubmitted = true;\n\n    const now = Date.now();\n    const setupTime = now - this._startTime;\n    const metricName = new MetricType(metricType).getName();\n\n    this.metricsService.push({\n      metricType,\n      runtime: (now - this._pageLoadTime) / 1000,\n      value: {uint64: setupTime},\n      streamId\n    });\n\n    this._logger.info(\n      '[%s] [%s] Stream metric [%s] in [%s]',\n      new Durations(now - this._pageLoadTime).toIsoString(),\n      streamId,\n      metricName,\n      new Durations(setupTime).toIsoString()\n    );\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport IDisposable from '../lang/IDisposable';\nimport Disposable from '../lang/Disposable';\nimport Subject from '../rx/Subject';\nimport DisposableList from '../lang/DisposableList';\n\nexport default class NetworkMonitor implements IDisposable {\n  private readonly _disposables: DisposableList = new DisposableList();\n  private readonly _isSupported = navigator && navigator['connection'];\n  private readonly _rtt: Subject<number> = new Subject(undefined);\n  private readonly _effectiveType: Subject<string> = new Subject(undefined);\n  private readonly _downlinkThroughputCapacity: Subject<number> = new Subject(undefined);\n\n  constructor() {\n    if (!this.isSupported) {\n      return;\n    }\n\n    this.setupNetworkChangeListeners();\n    this.updateStatistics();\n  }\n\n  get isSupported(): boolean {\n    return this._isSupported;\n  }\n\n  get rtt(): Subject<number> {\n    return this._rtt;\n  }\n\n  get effectiveType(): Subject<string> {\n    return this._effectiveType;\n  }\n\n  get downlinkThroughputCapacity(): Subject<number> {\n    return this._downlinkThroughputCapacity;\n  }\n\n  dispose(): void {\n    this._disposables.dispose();\n  }\n\n  private getDownlinkThroughputCapacity(): number {\n    if (!this.isSupported) {\n      return -1;\n    }\n\n    return navigator['connection'].downlink || navigator['connection'].downlinkMax;\n  }\n\n  private getEffectiveType(): string {\n    if (!this.isSupported) {\n      return 'Unknown';\n    }\n\n    return navigator['connection'].effectiveType || navigator['connection'].type;\n  }\n\n  private getRoundTripTime(): number {\n    return navigator['connection'].rtt;\n  }\n\n  private setupNetworkChangeListeners(): void {\n    const listener = (): void => {\n      this.updateStatistics();\n    };\n\n    navigator['connection'].addEventListener('change', listener);\n\n    this._disposables.add(new Disposable(() => {\n      navigator['connection'].removeEventListener('change', listener);\n    }));\n  }\n\n  private updateStatistics(): void {\n    this._rtt.value = this.getRoundTripTime();\n    this._effectiveType.value = this.getEffectiveType();\n    this._downlinkThroughputCapacity.value = this.getDownlinkThroughputCapacity();\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {StreamSetupListener} from '../dom/StreamSetupListener';\nimport {ILogger} from '../logger/LoggerInterface';\nimport LoggerFactory from '../logger/LoggerFactory';\nimport NetworkMonitor from '../dom/NetworkMonitor';\nimport SDK from '../sdk/SDK';\nimport MetricsType from '../metrics/MetricsType';\nimport Durations from '../time/Duration';\nimport IDisposable from '../lang/IDisposable';\nimport DisposableList from '../lang/DisposableList';\nimport MetricsService from '../metrics/MetricsService';\n\ninterface INetworkStatistics {\n  rtt?: number;\n  effectiveType?: string;\n  downlinkThroughputCapacity?: number;\n}\n\nexport default class SessionTelemetry implements IDisposable {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('SessionTelemetry');\n  private readonly _metricsService: MetricsService;\n  private readonly _applicationActivityMonitor = SDK.applicationActivityMonitor;\n  private readonly _networkMonitor: NetworkMonitor = new NetworkMonitor();\n  private readonly _pageLoadTime: number;\n  private readonly _disposables: DisposableList = new DisposableList();\n  private _lastNetworkStatistics: INetworkStatistics = {};\n\n  constructor(pageLoadTime: number, metricsService: MetricsService) {\n    this._pageLoadTime = pageLoadTime;\n    this._disposables.add(this._networkMonitor);\n    this._metricsService = metricsService;\n\n    if (!this._networkMonitor.isSupported) {\n      return;\n    }\n\n    this._disposables.add(this._applicationActivityMonitor.isForeground.subscribe(isForeground => {\n      this.recordForegroundChange(isForeground);\n    }));\n    this._disposables.add(this._networkMonitor.rtt.subscribe(value => {\n      this.recordNetworkRTTUpdate(value);\n    }));\n    this._disposables.add(this._networkMonitor.effectiveType.subscribe(value => {\n      this.recordNetworkTypeChangeUpdate(value);\n    }));\n    this._disposables.add(this._networkMonitor.downlinkThroughputCapacity.subscribe(value => {\n      this.recordNetworkDownlinkThroughputCapacityUpdate(value);\n    }));\n  }\n\n  listenOnStreamSetup(): StreamSetupListener {\n    return new StreamSetupListener(this._pageLoadTime);\n  }\n\n  dispose(): void {\n    this._disposables.dispose();\n  }\n\n  private recordForegroundChange(isForeground: boolean): void {\n    const now = Date.now();\n    const timeSinceLastChange = this._applicationActivityMonitor.getTimeSinceLastChange();\n\n    this._metricsService.push({\n      metricType: isForeground ? MetricsType.ApplicationForeground : MetricsType.ApplicationBackground,\n      runtime: (now - this._pageLoadTime) / 1000,\n      value: {uint64: timeSinceLastChange}\n    });\n\n    this._logger.info(\n      'Application has gone into the [%s] after [%s] ms',\n      isForeground ? 'foreground' : 'background',\n      new Durations(timeSinceLastChange).toIsoString(),\n    );\n  }\n\n  private recordNetworkRTTUpdate(newRTT: number): void {\n    const now = Date.now();\n    const oldRtt = this._lastNetworkStatistics.rtt;\n\n    this._lastNetworkStatistics.rtt = newRTT;\n\n    this._metricsService.push({\n      metricType: MetricsType.RoundTripTime,\n      runtime: (now - this._pageLoadTime) / 1000,\n      value: {uint64: newRTT},\n      previousValue: oldRtt ? {uint64: oldRtt} : undefined,\n      resource: 'navigator'\n    });\n\n    this._logger.info(\n      '[%s] Network RTT changed to [%s] from [%s]',\n      new Durations(now - this._pageLoadTime).toIsoString(),\n      newRTT,\n      oldRtt\n    );\n  }\n\n  private recordNetworkTypeChangeUpdate(newNetworkType: string): void {\n    const now = Date.now();\n    const oldNetworkType = this._lastNetworkStatistics.effectiveType;\n\n    this._lastNetworkStatistics.effectiveType = newNetworkType;\n\n    this._metricsService.push({\n      metricType: MetricsType.NetworkType,\n      runtime: (now - this._pageLoadTime) / 1000,\n      value: {string: newNetworkType},\n      previousValue: oldNetworkType ? {string: oldNetworkType} : undefined\n    });\n\n    this._logger.info(\n      '[%s] Network effective type has changed to [%s] from [%s]',\n      new Durations(now - this._pageLoadTime).toIsoString(),\n      newNetworkType,\n      oldNetworkType\n    );\n  }\n\n  private recordNetworkDownlinkThroughputCapacityUpdate(newCapacity: number): void {\n    const now = Date.now();\n    const oldCapacity = this._lastNetworkStatistics.downlinkThroughputCapacity;\n\n    this._lastNetworkStatistics.downlinkThroughputCapacity = newCapacity;\n\n    this._metricsService.push({\n      metricType: MetricsType.DownlinkThroughputCapacity,\n      runtime: (now - this._pageLoadTime) / 1000,\n      value: {float: newCapacity},\n      previousValue: oldCapacity ? {float: oldCapacity} : undefined\n    });\n\n    this._logger.info(\n      '[%s] Network downlink throughput capacity changed to [%s] from [%s]',\n      new Durations(now - this._pageLoadTime).toIsoString(),\n      newCapacity,\n      oldCapacity\n    );\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nexport type BitrateStateType = 'Keep' | 'Reset';\nexport type BitrateModeType = 'Normal' | 'Force' | 'Reset';\n\nexport enum BitrateState {\n  Keep,\n  Reset\n}\n\nexport enum BitrateMode {\n  Normal,\n  Force,\n  Reset\n}\n\nexport interface ISetTemporaryMaximalBitrate {\n  apiVersion: number;\n  sharedSecret: string;\n  elapsedInMilliseconds: number;\n  bitrateInBitsPerSecond: number;\n  bitrateState: BitrateStateType;\n  bitrateMode: BitrateModeType;\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Subject from '../../rx/Subject';\nimport {EncodedEdgeToken} from '../../edgeAuth/EncodedEdgeToken';\n\nexport default class TokenContext {\n  token: Subject<EncodedEdgeToken>;\n  tokenExpiring: Subject<boolean>;\n\n  constructor(token: EncodedEdgeToken) {\n    this.token = new Subject<EncodedEdgeToken>(token);\n    this.tokenExpiring = new Subject<boolean>(false);\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Subject from '../../rx/Subject';\nimport ChannelState from '../channels/ChannelState';\nimport Dimension from '../../video/Dimension';\nimport EndPoint, {IStream, SubscribeStatus} from '../discovery/EndPoint';\nimport VideoTelemetry from '../../video/VideoTelemetry';\nimport {IRtcMonitorStatistic, IRtcStatistic} from '../../rtc/RtcConnectionMonitor';\nimport SDK from '../SDK';\nimport assertUnreachable from '../../lang/assertUnreachable';\nimport DisposableList from '../../lang/DisposableList';\nimport {BitsPerSecond, Millisecond} from '../../units/Units';\n\nconst defaultTargetLag = 0;\n\nexport type ChannelContextOptions = {\n  targetLag?: number;\n};\n\nexport default class ChannelContext {\n  channelInitialization: Date;\n  disposables: DisposableList;\n  channelDisposables: DisposableList;\n  rendererDisposables: DisposableList;\n  videoElement: Subject<HTMLVideoElement>;\n  state: Subject<ChannelState>;\n  autoMuted: Subject<boolean>;\n  autoPaused: Subject<boolean>;\n  authorized: Subject<boolean>;\n  online: Subject<boolean>;\n  loading: Subject<boolean>;\n  playing: Subject<boolean>;\n  standby: Subject<boolean>;\n  stopped: Subject<boolean>;\n  targetLag: Subject<Millisecond>;\n  lag: Subject<Millisecond>;\n  bitrateLimit: Subject<BitsPerSecond>;\n  resolution: Subject<Dimension>;\n  failureCount: Subject<number>;\n  endPoint: Subject<EndPoint>;\n  stream: Subject<IStream>;\n  rtcStatistics: Subject<IRtcMonitorStatistic>;\n  videoTelemetry: VideoTelemetry;\n  rtcAudioStatistic: IRtcStatistic;\n  rtcVideoStatistic: IRtcStatistic;\n  clearFailureCountTimeout: number;\n\n  constructor(options?: ChannelContextOptions) {\n    this.disposables = new DisposableList();\n    this.channelDisposables = new DisposableList();\n    this.rendererDisposables = new DisposableList();\n    this.channelInitialization = new Date();\n    this.videoElement = new Subject<HTMLVideoElement>(null);\n    this.state = new Subject<ChannelState>(ChannelState.Starting);\n    this.autoMuted = new Subject<boolean>(false);\n    this.autoPaused = new Subject<boolean>(false);\n    this.authorized = new Subject<boolean>(true);\n    this.online = new Subject<boolean>(true);\n    this.loading = new Subject<boolean>(false);\n    this.playing = new Subject<boolean>(false);\n    this.standby = new Subject<boolean>(false);\n    this.stopped = new Subject<boolean>(false);\n    this.targetLag = new Subject<Millisecond>(options?.targetLag ?? defaultTargetLag);\n    this.lag = new Subject<Millisecond>(0);\n    this.bitrateLimit = new Subject<BitsPerSecond>(0);\n    this.resolution = new Subject<Dimension>(Dimension.empty);\n    this.failureCount = new Subject<number>(0);\n    this.endPoint = new Subject<EndPoint>(null);\n    this.stream = new Subject<IStream>(null);\n    this.rtcStatistics = new Subject<IRtcMonitorStatistic>(null);\n  }\n\n  get streamId(): string {\n    const stream = this.stream.value;\n\n    if (!stream) {\n      return '-';\n    }\n\n    return stream.streamId;\n  }\n\n  applyStatus(status: SubscribeStatus): void {\n    switch (status) {\n      case 'ok':\n        break;\n      case 'unauthorized':\n      case 'geo-restricted':\n      case 'geo-blocked':\n        this.authorized.value = false;\n\n      // eslint-disable-next-line no-fallthrough\n      case 'no-stream':\n      case 'not-found':\n        this.failureCount.value = 0;\n        this.playing.value = false;\n        this.standby.value = true;\n        this.stopped.value = false;\n        this.stream.value = null;\n\n        return;\n      default:\n        this.failureCount.value++;\n        this.playing.value = false;\n        this.standby.value = true;\n        this.stopped.value = false;\n        this.stream.value = null;\n\n        return;\n    }\n  }\n\n  applySessionAndStreamPropertiesToVideoElement(): void {\n    if (this.videoElement.value && this.videoElement.value.dataset) {\n      this.videoElement.value.dataset.sessionId = SDK.clientSessionId;\n      this.videoElement.value.dataset.streamId = this.streamId;\n    }\n  }\n\n  mapSubscribeStatusToChannelStatus(status: SubscribeStatus): ChannelState {\n    switch (status) {\n      case 'ok':\n        return ChannelState.Starting;\n      case 'no-stream':\n      case 'not-found':\n        return ChannelState.StandBy;\n      case 'geo-restricted':\n        return ChannelState.GeoRestricted;\n      case 'geo-blocked':\n        return ChannelState.GeoBlocked;\n      case 'unauthorized':\n        return ChannelState.Unauthorized;\n      case 'capacity':\n      case 'rate-limited':\n      case 'timeout':\n        return ChannelState.Recovering;\n      case 'forbidden-tag':\n        return ChannelState.ConfigurationError;\n      case 'port-in-range-not-found':\n        return ChannelState.TransientConfigurationError;\n      case 'failed':\n        return ChannelState.Error;\n      default:\n        assertUnreachable(status);\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport interface IEncodedStreamSink<T = RTCEncodedAudioFrame | RTCEncodedVideoFrame> {\n    (track: MediaStreamTrack, chunk: T): boolean | PromiseLike<boolean>;\n}\n\nexport default class EncodedStreamSink {\n  static validateEncodedStreamSink(mode: 'audio' | 'video', item: IEncodedStreamSink) {\n    if (typeof item !== 'function') {\n      return {\n        valid: false,\n        validationResult: `Unexpected ${mode} Encoded Stream Sink function type. Found [${typeof item}]`\n      };\n    }\n\n    if (item.length !== 2) {\n      return {\n        valid: false,\n        validationResult: `Unexpected ${mode} Encoded Stream Sink function parameter length. Expected 2. Found [${item.length}]`\n      };\n    }\n\n    return {\n      valid: true,\n      validationResult: 'ok'\n    };\n  }\n\n  constructor() {\n    throw new Error('EncodedStreamSink is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport interface IStreamTrackTransform<T = AudioData | VideoFrame> {\n    (track: MediaStreamTrack, chunk: T, controller: TransformStreamDefaultController<T>): void | PromiseLike<void>;\n}\n\nexport default class StreamTrackTransform {\n  static validateMediaStreamTrackTransform(mode: 'audio' | 'video', item: IStreamTrackTransform) {\n    if (typeof item !== 'function') {\n      return {\n        valid: false,\n        validationResult: `Unexpected ${mode} Media Stream Track transform function type. Found [${typeof item}]`\n      };\n    }\n\n    if (item.length !== 3) {\n      return {\n        valid: false,\n        validationResult: `Unexpected ${mode} Media Stream Track transform function parameter length. Expected 3. Found [${item.length}]`\n      };\n    }\n\n    return {\n      valid: true,\n      validationResult: 'ok'\n    };\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Subject from '../../rx/Subject';\nimport {IStreamTrackTransform} from '../transformation/StreamTrackTransform';\nimport {IEncodedStreamSink} from '../transformation/EncodedStreamSink';\n\nexport type StreamTransformContextOptions = {\n  hasInsertableStreams: boolean;\n  hasEncodedInsertableStreams: boolean;\n  videoStreamTransformCallback: IStreamTrackTransform<VideoFrame> | undefined;\n  audioStreamTransformCallback: IStreamTrackTransform<AudioData> | undefined;\n  encodedVideoStreamSink: IEncodedStreamSink<RTCEncodedVideoFrame> | undefined;\n  encodedAudioStreamSink: IEncodedStreamSink<RTCEncodedAudioFrame> | undefined;\n};\n\nexport default class StreamTransformContext {\n  readonly hasInsertableStreams: Subject<boolean>;\n  readonly hasEncodedInsertableStreams: Subject<boolean>;\n  readonly videoStreamTransformCallback: IStreamTrackTransform<VideoFrame> | undefined;\n  readonly audioStreamTransformCallback: IStreamTrackTransform<AudioData> | undefined;\n  readonly encodedVideoStreamSink: IEncodedStreamSink<RTCEncodedVideoFrame> | undefined;\n  readonly encodedAudioStreamSink: IEncodedStreamSink<RTCEncodedAudioFrame> | undefined;\n\n  constructor(options: StreamTransformContextOptions) {\n    this.hasInsertableStreams = new Subject<boolean>(options.hasInsertableStreams);\n    this.hasEncodedInsertableStreams = new Subject<boolean>(options.hasEncodedInsertableStreams);\n    this.videoStreamTransformCallback = options.videoStreamTransformCallback;\n    this.audioStreamTransformCallback = options.audioStreamTransformCallback;\n    this.encodedVideoStreamSink = options.encodedVideoStreamSink;\n    this.encodedAudioStreamSink = options.encodedAudioStreamSink;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Subject from '../../rx/Subject';\nimport IPeerConnection from '../../rtc/IPeerConnection';\n\nexport default class PeerConnectionContext {\n  mediaStream: Subject<MediaStream>;\n  peerConnection: Subject<IPeerConnection>;\n  peerConnectionReconnectAttempts: number;\n\n  constructor() {\n    this.mediaStream = new Subject<MediaStream>(null);\n    this.peerConnection = new Subject<IPeerConnection>(null);\n    this.peerConnectionReconnectAttempts = 0;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Subject from '../../rx/Subject';\n\nexport default class StateContext {\n  isStarting: Subject<boolean>;\n  isDisposed: boolean;\n\n  constructor() {\n    this.isStarting = new Subject<boolean>(false);\n    this.isDisposed = false;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {BitrateMode, BitrateModeType} from '../api/SetTemporaryMaximalBitrate';\nimport assertUnreachable from '../../lang/assertUnreachable';\n\nexport default class BitrateModeMapping {\n  static convertBitrateModeToBitrateModeType(bitrateMode: BitrateMode): BitrateModeType {\n    switch (bitrateMode) {\n      case BitrateMode.Normal:\n        return 'Normal';\n      case BitrateMode.Force:\n        return 'Force';\n      case BitrateMode.Reset:\n        return 'Reset';\n      default:\n        assertUnreachable(bitrateMode);\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {BitrateState, BitrateStateType} from '../api/SetTemporaryMaximalBitrate';\nimport assertUnreachable from '../../lang/assertUnreachable';\n\nexport default class BitrateStateMapping {\n  static convertBitrateStateToBitrateStateType(bitrateState: BitrateState): BitrateStateType {\n    switch (bitrateState) {\n      case BitrateState.Keep:\n        return 'Keep';\n      case BitrateState.Reset:\n        return 'Reset';\n      default:\n        assertUnreachable(bitrateState);\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../../logger/LoggerFactory';\nimport {ILogger} from '../../logger/LoggerInterface';\nimport EdgeAuthParser from '../../edgeAuth/EdgeAuthParser';\nimport {EncodedEdgeToken} from '../../edgeAuth/EncodedEdgeToken';\n\nimport {\n  ISubscribeResponse,\n  ISubscribeWithOfferRequest,\n  ISubscribeWithoutOfferRequest\n} from '../api/Subscribe';\nimport {ISetRemoteDescriptionRequest, ISetRemoteDescriptionResponse} from '../api/SetRemoteDescription';\nimport {IDestroyStreamRequest, IDestroyStreamResponse} from '../api/DestroyStream';\nimport {IAddIceCandidatesRequest, IAddIceCandidatesResponse} from '../api/AddIceCandidates';\nimport VersionManager from '../version/VersionManager';\nimport Parameters from '../../environment/Parameters';\nimport {BitrateMode, BitrateState, ISetTemporaryMaximalBitrate} from '../api/SetTemporaryMaximalBitrate';\nimport BitrateModeMapping from './BitrateModeMapping';\nimport BitrateStateMapping from './BitrateStateMapping';\nimport {BitsPerSecond, Millisecond} from '../../units/Units';\nimport {\n  IPublishResponse,\n  IPublishWithOfferRequest,\n  IPublishWithoutOfferRequest,\n  PublishStatus\n} from '../api/Publish';\n\nconst apiVersion = 7;\n\nexport type SubscribeStatus = 'ok' | 'no-stream' | 'not-found' | 'unauthorized' | 'geo-restricted' | 'geo-blocked' | 'rate-limited' | 'capacity' | 'timeout' | 'forbidden-tag' | 'port-in-range-not-found' | 'failed';\nexport type SetRemoteDescriptionStatus = 'ok' | 'not-found' | 'unauthorized' | 'rate-limited' | 'capacity' | 'timeout' | 'failed';\nexport type SetTemporaryMaximalBitrateStatus = 'ok' | 'not-found' | 'unauthorized' | 'rate-limited' | 'capacity' | 'timeout' | 'failed';\nexport type RemoveTemporaryMaximalBitrateStatus = 'ok' | 'not-found' | 'unauthorized' | 'rate-limited' | 'capacity' | 'timeout' | 'failed';\nexport type AddIceCandidatesStatus = 'ok' | 'not-found' | 'unauthorized' | 'rate-limited' | 'capacity' | 'timeout' | 'failed';\nexport type DestroyStreamStatus = 'ok' | 'not-found' | 'unauthorized' | 'rate-limited' | 'capacity' | 'timeout' | 'failed';\nexport interface IStream {\n  streamId: string;\n  sharedSecret: string;\n  tenancy: string;\n}\n\nexport interface ISubscribeResponseInit {\n  status: SubscribeStatus;\n  stream?: IStream;\n  lag?: Millisecond;\n  rtcConfiguration?: RTCConfiguration;\n  setRemoteDescriptionResponse?: {\n    sessionDescription: RTCSessionDescriptionInit;\n  };\n  createOfferDescriptionResponse?: {\n    sessionDescription: RTCSessionDescriptionInit;\n  };\n  createAnswerDescriptionResponse?: {\n    sessionDescription: RTCSessionDescriptionInit;\n  };\n}\n\nexport type IPublishResponseInit = {\n  status: PublishStatus;\n  stream?: IStream;\n  lag?: Millisecond;\n  rtcConfiguration?: RTCConfiguration;\n  setRemoteDescriptionResponse?: {\n    sessionDescription: RTCSessionDescriptionInit;\n  };\n  createOfferDescriptionResponse?: {\n    sessionDescription: RTCSessionDescriptionInit;\n  };\n  createAnswerDescriptionResponse?: {\n    sessionDescription: RTCSessionDescriptionInit;\n  };\n};\n\ninterface ISetRemoteDescriptionResponseInit {\n  status: SetRemoteDescriptionStatus;\n  sessionDescription?: RTCSessionDescriptionInit;\n}\n\ninterface IAddIceCandidatesResponseInit {\n  status: AddIceCandidatesStatus;\n  options?: string[];\n}\n\ninterface ISetTemporaryMaximalBitrateResponseInit {\n  status: SetTemporaryMaximalBitrateStatus;\n}\n\ninterface IDestroyStreamResponseInit {\n  status: DestroyStreamStatus;\n}\n\nexport default class EndPoint {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('EndPoint');\n  private readonly _uri: string;\n  private readonly _timeout: number;\n  private _roundTripTime: number;\n\n  constructor(uri: string, timeout: number) {\n    this._uri = uri;\n    this._timeout = timeout;\n\n    if (!timeout) {\n      throw new Error(`End point requires a timeout`);\n    }\n  }\n\n  get roundTripTime(): number {\n    return this._roundTripTime;\n  }\n\n  toString(): string {\n    return `EndPoint[uri=${this._uri}]`;\n  }\n\n  async ping(): Promise<number> {\n    const url = this.buildPingUrl();\n    const start = Date.now();\n    const response = await Promise.race([\n      fetch(url, {\n        method: 'GET',\n        cache: 'no-cache'\n      }),\n      new Promise<Response>((_, reject) =>\n        setTimeout(() => reject(new Error(`Ping timed out [${url}]`)), this._timeout)\n      )\n    ]);\n    const finished = Date.now();\n\n    if (!response.ok) { /* Handle */\n      throw new Error(`Ping failed [${url}] [${response.status}]`);\n    }\n\n    this._roundTripTime = finished - start;\n\n    return this._roundTripTime;\n  }\n\n  async subscribe(token: EncodedEdgeToken, localSessionDescription: RTCSessionDescriptionInit, failureCount: number): Promise<ISubscribeResponseInit> {\n    const tenancy = EdgeAuthParser.parseToken(token).tenancy;\n\n    if (!tenancy) {\n      this._logger.error('Failed to parse token [%s]', token);\n\n      return {status: 'unauthorized'};\n    }\n\n    const url = this.buildUrl([tenancy, 'stream', 'subscribe']).toString();\n    const formData = new FormData();\n    const clientVersion = VersionManager.sdkVersion;\n\n    if (failureCount === 0 && localSessionDescription) {\n      const bodyWithOffer: ISubscribeWithOfferRequest = {\n        apiVersion,\n        clientVersion,\n        bearerToken: token,\n        failureCount,\n        httpRoundTripTime: this._roundTripTime,\n        setRemoteDescription: {\n          apiVersion,\n          sessionDescription: {\n            type: localSessionDescription.type,\n            sdp: localSessionDescription.sdp\n          }\n        },\n        createAnswerDescription: {apiVersion}\n      };\n\n      formData.append('jsonBody', JSON.stringify(bodyWithOffer));\n    } else {\n      const bodyWithoutOffer: ISubscribeWithoutOfferRequest = {\n        apiVersion,\n        clientVersion,\n        bearerToken: token,\n        failureCount,\n        httpRoundTripTime: this._roundTripTime,\n        createOfferDescription: {apiVersion}\n      };\n\n      formData.append('jsonBody', JSON.stringify(bodyWithoutOffer));\n    }\n\n    const start = Date.now();\n    let httpResponse: Response;\n\n    try {\n      let timeout = null;\n\n      httpResponse = await Promise.race([\n        fetch(url, {\n          method: 'POST',\n          body: formData\n        }),\n        new Promise<Response>(resolve =>\n          timeout = window.setTimeout(() => {\n            this._logger.error('Failed to subscribe', new Error(`Subscribe timed out [${url}]`));\n            resolve({status: 408} as Response);\n          }, this._timeout)\n        )\n      ])\n        .finally(() => {\n          if (timeout) {\n            clearTimeout(timeout);\n          }\n        });\n    } catch (e) {\n      this._logger.error('Failed to subscribe', e);\n\n      return {status: 'failed'};\n    }\n\n    const status: SubscribeStatus = this.mapHttpStatusToSubscribeStatus(httpResponse);\n\n    if (status !== 'ok') {\n      return {status};\n    }\n\n    const finished = Date.now();\n    const subscribeResponse = await this.convertHttpResponseToSubscribeResponse(tenancy, httpResponse);\n\n    this._logger.debug('Got subscribe response [%j] in [%s] ms', subscribeResponse, finished - start);\n\n    return subscribeResponse;\n  }\n\n  async publish(name: string, token: EncodedEdgeToken, localSessionDescription: RTCSessionDescriptionInit, failureCount: number): Promise<IPublishResponseInit> {\n    const tenancy = EdgeAuthParser.parseToken(token).tenancy;\n\n    if (!tenancy) {\n      this._logger.error('Failed to parse token [%s]', token);\n\n      return {status: 'unauthorized'};\n    }\n\n    const url = this.buildUrl([tenancy, 'stream', 'publish']).toString();\n    const formData = new FormData();\n    const clientVersion = VersionManager.sdkVersion;\n\n    if (failureCount === 0 && localSessionDescription) {\n      const bodyWithOffer: IPublishWithOfferRequest = {\n        apiVersion,\n        clientVersion,\n        bearerToken: token,\n        failureCount,\n        httpRoundTripTime: this._roundTripTime,\n        name,\n        setRemoteDescription: {\n          apiVersion,\n          sessionDescription: {\n            type: localSessionDescription.type,\n            sdp: localSessionDescription.sdp\n          }\n        },\n        createAnswerDescription: {\n          streamId: '',\n          apiVersion\n        }\n      };\n\n      formData.append('jsonBody', JSON.stringify(bodyWithOffer));\n    } else {\n      const bodyWithoutOffer: IPublishWithoutOfferRequest = {\n        apiVersion,\n        clientVersion,\n        bearerToken: token,\n        failureCount,\n        httpRoundTripTime: this._roundTripTime,\n        name,\n        createOfferDescription: {\n          streamId: '',\n          apiVersion\n        }\n      };\n\n      formData.append('jsonBody', JSON.stringify(bodyWithoutOffer));\n    }\n\n    const start = Date.now();\n    let httpResponse: Response;\n\n    try {\n      let timeout = null;\n\n      httpResponse = await Promise.race([\n        fetch(url, {\n          method: 'POST',\n          body: formData\n        }),\n        new Promise<Response>(resolve =>\n          timeout = window.setTimeout(() => {\n            this._logger.error('Failed to publish', new Error(`Publish timed out [${url}]`));\n            resolve({status: 408} as Response);\n          }, this._timeout)\n        )\n      ])\n        .finally(() => {\n          if (timeout) {\n            clearTimeout(timeout);\n          }\n        });\n    } catch (e) {\n      this._logger.error('Failed to publish', e);\n\n      return {status: 'failed'};\n    }\n\n    const status: PublishStatus = this.mapHttpStatusToPublishStatus(httpResponse);\n\n    if (status !== 'ok') {\n      return {status};\n    }\n\n    const finished = Date.now();\n    const subscribeResponse = await this.convertHttpResponseToPublishResponse(tenancy, httpResponse);\n\n    this._logger.debug('Got publish response [%j] in [%s] ms', subscribeResponse, finished - start);\n\n    return subscribeResponse;\n  }\n\n  async setRemoteDescription(stream: IStream, sessionDescription: RTCSessionDescriptionInit): Promise<ISetRemoteDescriptionResponseInit> {\n    const url = this.buildUrl([stream.tenancy, 'stream', stream.streamId, 'description', 'remote']).toString();\n    const formData = new FormData();\n    const body: ISetRemoteDescriptionRequest = {\n      apiVersion,\n      sharedSecret: stream.sharedSecret,\n      sessionDescription: {\n        type: sessionDescription.type,\n        sdp: sessionDescription.sdp\n      }\n    };\n\n    formData.append('jsonBody', JSON.stringify(body));\n\n    const start = Date.now();\n    let httpResponse: Response;\n\n    try {\n      let timeout = null;\n\n      httpResponse = await Promise.race([\n        fetch(url, {\n          method: 'POST',\n          body: formData\n        }),\n        new Promise<Response>(resolve =>\n          timeout = window.setTimeout(() => {\n            this._logger.error('Failed to set remote description', new Error(`Set remote description timed out [${url}]`));\n            resolve({status: 408} as Response);\n          }, this._timeout)\n        )\n      ])\n        .finally(() => {\n          if (timeout) {\n            clearTimeout(timeout);\n          }\n        });\n    } catch (e) {\n      this._logger.error('Failed to set remote description', e);\n\n      return {status: 'failed'};\n    }\n\n    const status: SetRemoteDescriptionStatus = this.mapHttpStatusToSetRemoteDescriptionStatus(httpResponse);\n\n    if (status !== 'ok') {\n      return {status};\n    }\n\n    const finished = Date.now();\n    const setRemoteDescriptionResponse = await this.convertHttpResponseToSetRemoteDescriptionResponse(httpResponse);\n\n    this._logger.debug('Got set remote description response [%j] in [%s] ms', setRemoteDescriptionResponse, finished - start);\n\n    return setRemoteDescriptionResponse;\n  }\n\n  async limitBitrate(\n    stream: IStream,\n    elapsedInMilliseconds: number,\n    bitrateInBitsPerSecond: BitsPerSecond,\n    bitrateState: BitrateState,\n    bitrateMode: BitrateMode,\n  ): Promise<ISetTemporaryMaximalBitrateResponseInit> {\n    const url = this.buildUrl([stream.tenancy, 'stream', stream.streamId, 'bitrate']).toString();\n    const formData = new FormData();\n    const body: ISetTemporaryMaximalBitrate = {\n      apiVersion,\n      sharedSecret: stream.sharedSecret,\n      elapsedInMilliseconds,\n      bitrateInBitsPerSecond,\n      bitrateState: BitrateStateMapping.convertBitrateStateToBitrateStateType(bitrateState),\n      bitrateMode: BitrateModeMapping.convertBitrateModeToBitrateModeType(bitrateMode)\n    };\n\n    formData.append('jsonBody', JSON.stringify(body));\n\n    const start = Date.now();\n    let httpResponse: Response;\n\n    try {\n      let timeout = null;\n\n      httpResponse = await Promise.race([\n        fetch(url, {\n          method: 'POST',\n          body: formData\n        }),\n        new Promise<Response>(resolve =>\n          timeout = window.setTimeout(() => {\n            this._logger.error('Failed to set limit bitrate timed', new Error(`Set limit bitrate timed out [${url}]`));\n            resolve({status: 408} as Response);\n          }, this._timeout)\n        )\n      ])\n        .finally(() => {\n          if (timeout) {\n            clearTimeout(timeout);\n          }\n        });\n    } catch (e) {\n      this._logger.error('Failed to set limit bitrate timed', e);\n\n      return {status: 'failed'};\n    }\n\n    const status: SetTemporaryMaximalBitrateStatus = this.mapHttpStatusToSetTemporaryMaximalBitrateStatus(httpResponse);\n    const finished = Date.now();\n\n    this._logger.info('Got set limit bitrate response [%s] in [%s] ms', status, finished - start);\n\n    return {status};\n  }\n\n  async addIceCandidates(stream: IStream, candidates: RTCIceCandidate[], discoveryCompleted: boolean, options: string[] = []): Promise<IAddIceCandidatesResponseInit> {\n    const url = this.buildUrl([stream.tenancy, 'stream', stream.streamId, 'ice', 'candidates']).toString();\n    const formData = new FormData();\n    const body: IAddIceCandidatesRequest = {\n      apiVersion,\n      sharedSecret: stream.sharedSecret,\n      candidates,\n      discoveryCompleted,\n      options\n    };\n\n    formData.append('jsonBody', JSON.stringify(body));\n\n    const start = Date.now();\n    let httpResponse: Response;\n\n    try {\n      let timeout = null;\n\n      httpResponse = await Promise.race([\n        fetch(url, {\n          method: 'POST',\n          body: formData\n        }),\n        new Promise<Response>(resolve =>\n          timeout = window.setTimeout(() => {\n            this._logger.error('Failed to add ice candidates', new Error(`Add ice candidates timed out [${url}]`));\n            resolve({status: 408} as Response);\n          }, this._timeout)\n        )\n      ])\n        .finally(() => {\n          if (timeout) {\n            clearTimeout(timeout);\n          }\n        });\n    } catch (e) {\n      this._logger.error('Failed to add ice candidates', e);\n\n      return {status: 'failed'};\n    }\n\n    const status: AddIceCandidatesStatus = this.mapHttpStatusToAddIceCandidatesStatus(httpResponse);\n\n    if (status !== 'ok') {\n      return {status};\n    }\n\n    const finished = Date.now();\n    const addIceCandidatesResponse = await this.convertHttpResponseToAddIceCandidatesResponse(httpResponse);\n\n    this._logger.info('Got add ICE candidates response [%j] in [%s] ms', addIceCandidatesResponse, finished - start);\n\n    return addIceCandidatesResponse;\n  }\n\n  async destroyStream(stream: IStream, reason: string): Promise<IDestroyStreamResponseInit> {\n    const url = this.buildUrl([stream.tenancy, 'stream', stream.streamId, 'destroy']).toString();\n    const formData = new FormData();\n    const body: IDestroyStreamRequest = {\n      apiVersion,\n      sharedSecret: stream.sharedSecret,\n      reason,\n      options: []\n    };\n\n    formData.append('jsonBody', JSON.stringify(body));\n\n    const start = Date.now();\n    let httpResponse: Response;\n\n    try {\n      let timeout = null;\n\n      httpResponse = await Promise.race([\n        fetch(url, {\n          method: 'POST',\n          body: formData,\n          cache: 'no-cache'\n        }),\n        new Promise<Response>(resolve =>\n          timeout = window.setTimeout(() => {\n            this._logger.error('Failed to subscribe', new Error(`Delete stream timed out [${url}]`));\n            resolve({status: 408} as Response);\n          }, this._timeout)\n        )\n      ])\n        .finally(() => {\n          if (timeout) {\n            clearTimeout(timeout);\n          }\n        });\n    } catch (e) {\n      this._logger.error('Failed to delete stream', e);\n\n      return {status: 'failed'};\n    }\n\n    const status: DestroyStreamStatus = this.mapHttpStatusToSetDestroyStreamStatus(httpResponse);\n\n    if (status !== 'ok') {\n      return {status};\n    }\n\n    const finished = Date.now();\n    const destroyStreamResponse = await this.convertHttpResponseToDestroyStreamResponse(httpResponse);\n\n    this._logger.info('Got destroy stream response [%j] in [%s] ms', destroyStreamResponse, finished - start);\n\n    return destroyStreamResponse;\n  }\n\n  async destroyStreamOnUnmount(stream: IStream, reason: string): Promise<void> {\n    if (!navigator?.sendBeacon) {\n      const ignored = this.destroyStream(stream, reason);\n    }\n\n    const url = this.buildUrl([stream.tenancy, 'stream', stream.streamId, 'destroy']).toString();\n    const formData = new FormData();\n    const body: IDestroyStreamRequest = {\n      apiVersion,\n      sharedSecret: stream.sharedSecret,\n      reason,\n      options: []\n    };\n\n    formData.append('jsonBody', JSON.stringify(body));\n\n    navigator.sendBeacon(url, formData);\n  }\n\n  private buildUrl(path: string[]): URL {\n    const uri = new URL(this._uri);\n    const pathAsArray = uri.pathname.split('/');\n\n    pathAsArray.length = pathAsArray.length - 1;\n\n    uri.pathname = pathAsArray.concat(...path).join('/');\n\n    return uri;\n  }\n\n  private buildPingUrl(): string {\n    const uri = new URL(this._uri);\n    const sdkVersion = VersionManager.sdkVersion;\n    const intentions = Parameters.discoveryParameters.intentions;\n\n    uri.search = `?${new URLSearchParams([['type', 'http'], ['version', sdkVersion], ['intentions', intentions], ['_', `${Date.now()}`]]).toString()}`;\n\n    return uri.toString();\n  }\n\n  private mapHttpStatusToPublishStatus(response: Response): PublishStatus {\n    if (!response) {\n      return 'failed';\n    }\n\n    switch (response.status) {\n      case 200:\n        return 'ok';\n      case 401:\n        return 'unauthorized';\n      case 402:\n        return 'geo-restricted';\n      case 403:\n        return 'geo-blocked';\n      case 406:\n        return 'missing-channel-or-room-id';\n      case 408:\n        return 'timeout';\n      case 409:\n        return 'port-in-range-not-found';\n      case 415:\n        return 'forbidden-tag';\n      case 503:\n        return 'capacity';\n      case 504:\n        return 'rate-limited';\n      default:\n        return 'failed';\n    }\n  }\n\n  private mapHttpStatusToSubscribeStatus(response: Response): SubscribeStatus {\n    if (!response) {\n      return 'failed';\n    }\n\n    switch (response.status) {\n      case 200:\n        return 'ok';\n      case 401:\n        return 'unauthorized';\n      case 402:\n        return 'geo-restricted';\n      case 403:\n        return 'geo-blocked';\n      case 408:\n        return 'timeout';\n      case 409:\n        return 'port-in-range-not-found';\n      case 415:\n        return 'forbidden-tag';\n      case 503:\n        return 'capacity';\n      case 504:\n        return 'rate-limited';\n      default:\n        return 'failed';\n    }\n  }\n\n  private mapHttpStatusToSetRemoteDescriptionStatus(response: Response): SetRemoteDescriptionStatus {\n    if (!response) {\n      return 'failed';\n    }\n\n    switch (response.status) {\n      case 200:\n        return 'ok';\n      case 401:\n        return 'unauthorized';\n      case 408:\n        return 'timeout';\n      case 503:\n        return 'capacity';\n      case 504:\n        return 'rate-limited';\n      default:\n        return 'failed';\n    }\n  }\n\n  private mapHttpStatusToSetTemporaryMaximalBitrateStatus(response: Response): SetTemporaryMaximalBitrateStatus {\n    if (!response) {\n      return 'failed';\n    }\n\n    switch (response.status) {\n      case 200:\n        return 'ok';\n      case 401:\n        return 'unauthorized';\n      case 408:\n        return 'timeout';\n      case 503:\n        return 'capacity';\n      case 504:\n        return 'rate-limited';\n      default:\n        return 'failed';\n    }\n  }\n\n  private mapHttpStatusToAddIceCandidatesStatus(response: Response): AddIceCandidatesStatus {\n    if (!response) {\n      return 'failed';\n    }\n\n    switch (response.status) {\n      case 200:\n        return 'ok';\n      case 401:\n        return 'unauthorized';\n      case 408:\n        return 'timeout';\n      case 503:\n        return 'capacity';\n      case 504:\n        return 'rate-limited';\n      default:\n        return 'failed';\n    }\n  }\n\n  private mapHttpStatusToSetDestroyStreamStatus(response: Response): DestroyStreamStatus {\n    if (!response) {\n      return 'failed';\n    }\n\n    switch (response.status) {\n      case 200:\n        return 'ok';\n      case 401:\n        return 'unauthorized';\n      case 408:\n        return 'timeout';\n      case 503:\n        return 'capacity';\n      case 504:\n        return 'rate-limited';\n      default:\n        return 'failed';\n    }\n  }\n\n  private async convertHttpResponseToSubscribeResponse(tenancy: string, response: Response): Promise<ISubscribeResponseInit> {\n    const data = await response.json() as ISubscribeResponse;\n    const subscribeResponse: ISubscribeResponseInit = {status: data.status};\n\n    subscribeResponse.stream = {\n      tenancy,\n      streamId: data.streamId,\n      sharedSecret: data.sharedSecret\n    };\n\n    subscribeResponse.lag = data.lag;\n\n    if (data) {\n      if (data.rtcConfiguration) {\n        subscribeResponse.rtcConfiguration = this.convertIRtcConfigurationToRTCConfiguration(data.rtcConfiguration);\n      }\n\n      if (data.setRemoteDescriptionResponse && data.setRemoteDescriptionResponse.sessionDescription) {\n        subscribeResponse.setRemoteDescriptionResponse = {sessionDescription: data.setRemoteDescriptionResponse.sessionDescription};\n      }\n\n      if (data.createAnswerDescriptionResponse && data.createAnswerDescriptionResponse.sessionDescription) {\n        subscribeResponse.createAnswerDescriptionResponse = {sessionDescription: data.createAnswerDescriptionResponse.sessionDescription};\n      }\n\n      if (data.createOfferDescriptionResponse && data.createOfferDescriptionResponse.sessionDescription) {\n        subscribeResponse.createOfferDescriptionResponse = {sessionDescription: data.createOfferDescriptionResponse.sessionDescription};\n      }\n    }\n\n    return subscribeResponse;\n  }\n\n  private async convertHttpResponseToPublishResponse(tenancy: string, response: Response): Promise<IPublishResponseInit> {\n    const data = await response.json() as IPublishResponse;\n    const publishResponse: IPublishResponseInit = {status: data.status};\n\n    publishResponse.stream = {\n      tenancy,\n      streamId: data.streamId,\n      sharedSecret: data.sharedSecret\n    };\n\n    if (data) {\n      if (data.rtcConfiguration) {\n        publishResponse.rtcConfiguration = this.convertIRtcConfigurationToRTCConfiguration(data.rtcConfiguration);\n      }\n\n      if (data.setRemoteDescriptionResponse && data.setRemoteDescriptionResponse.sessionDescription) {\n        publishResponse.setRemoteDescriptionResponse = {sessionDescription: data.setRemoteDescriptionResponse.sessionDescription};\n      }\n\n      if (data.createAnswerDescriptionResponse && data.createAnswerDescriptionResponse.sessionDescription) {\n        publishResponse.createAnswerDescriptionResponse = {sessionDescription: data.createAnswerDescriptionResponse.sessionDescription};\n      }\n\n      if (data.createOfferDescriptionResponse && data.createOfferDescriptionResponse.sessionDescription) {\n        publishResponse.createOfferDescriptionResponse = {sessionDescription: data.createOfferDescriptionResponse.sessionDescription};\n      }\n    }\n\n    return publishResponse;\n  }\n\n  private convertIRtcConfigurationToRTCConfiguration(configuration: RTCConfiguration): RTCConfiguration {\n    const rtcConfiguration: RTCConfiguration = {iceServers: []};\n\n    if (configuration.bundlePolicy) {\n      rtcConfiguration.bundlePolicy = configuration.bundlePolicy;\n    }\n\n    if (typeof configuration.iceCandidatePoolSize === 'number') {\n      rtcConfiguration.iceCandidatePoolSize = configuration.iceCandidatePoolSize;\n    }\n\n    if (configuration.iceServers) {\n      const iceServers: RTCIceServer[] = [];\n\n      for (let i = 0; i < configuration.iceServers.length; i++) {\n        iceServers.push({\n          urls: configuration.iceServers[i].urls,\n          username: configuration.iceServers[i].username,\n          credential: configuration.iceServers[i].credential\n        });\n      }\n\n      rtcConfiguration.iceServers = iceServers;\n    }\n\n    if (configuration.iceTransportPolicy) {\n      rtcConfiguration.iceTransportPolicy = configuration.iceTransportPolicy;\n    }\n\n    if (configuration.rtcpMuxPolicy) {\n      rtcConfiguration.rtcpMuxPolicy = configuration.rtcpMuxPolicy;\n    }\n\n    return rtcConfiguration;\n  }\n  private async convertHttpResponseToSetRemoteDescriptionResponse(response: Response): Promise<ISetRemoteDescriptionResponseInit> {\n    const data = await response.json() as ISetRemoteDescriptionResponse;\n    const setRemoteDescriptionResponse: ISetRemoteDescriptionResponseInit = {status: data.status};\n\n    if (data && data.sessionDescription) {\n      setRemoteDescriptionResponse.sessionDescription = data.sessionDescription;\n    }\n\n    return setRemoteDescriptionResponse;\n  }\n\n  private async convertHttpResponseToAddIceCandidatesResponse(response: Response): Promise<IAddIceCandidatesResponseInit> {\n    const data = await response.json() as IAddIceCandidatesResponse;\n    const addIceCandidatesResponse: IAddIceCandidatesResponseInit = {\n      status: data.status,\n      options: []\n    };\n\n    if (data) {\n      if (data.options) {\n        addIceCandidatesResponse.options = data.options;\n      }\n    }\n\n    return addIceCandidatesResponse;\n  }\n\n  private async convertHttpResponseToDestroyStreamResponse(response: Response): Promise<IDestroyStreamResponseInit> {\n    const data = await response.json() as IDestroyStreamResponse;\n    const destroyStream: IDestroyStreamResponseInit = {status: data.status};\n\n    return destroyStream;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../../logger/LoggerFactory';\nimport EndPoint from './EndPoint';\nimport SDK from '../SDK';\nimport {ILogger} from '../../logger/LoggerInterface';\nimport MetricsType from '../../metrics/MetricsType';\nimport DiscoveryUri from './DiscoveryUri';\nimport MetricsService from '../../metrics/MetricsService';\nimport MetricsFactory from '../../metrics/MetricsFactory';\n\nconst defaultTimeout = 20000;\n\nexport default class DiscoveryService {\n  private _logger: ILogger = LoggerFactory.getLogger('Discovery');\n  private _metricsService: MetricsService;\n  private _uri: URL;\n\n  constructor(uri: URL) {\n    if (!uri) {\n      throw new Error('Discovery requires uri');\n    }\n\n    this._metricsService = MetricsFactory.getMetricsService(uri.toString());\n    this._uri = uri;\n  }\n\n  async discoverNearbyEndPoints(uri: URL, timeout: number): Promise<EndPoint[]> {\n    if (!timeout) {\n      throw new Error('Discovery requires timeout');\n    }\n\n    const url = uri.toString();\n    const response = await Promise.race([\n      fetch(url, {\n        method: 'GET',\n        cache: 'no-cache'\n      }),\n      new Promise<Response>((_, reject) =>\n        setTimeout(() => reject(new Error(`Discovery timed out [${url}]`)), timeout)\n      )\n    ]);\n\n    if (!response.ok) {\n      throw new Error(`Discovery failed [${url}] [${response.status}]`);\n    }\n\n    if (response.body === null) {\n      throw new Error(`Discovery failed with no data [${url}]`);\n    }\n\n    const asString = await response.text();\n    const endPoints = asString.split(',');\n\n    return endPoints.map(endPoint => new EndPoint(endPoint, timeout));\n  }\n\n  async discoverClosestEndPoint(timeout: number = defaultTimeout): Promise<EndPoint> {\n    const url = DiscoveryUri.buildDiscoveryUrl(this._uri);\n    const endPoints = await this.discoverNearbyEndPoints(new URL(url), timeout);\n    let failedRequests = 0;\n    const propagateFailureIfAllRequestsFailed = (): Promise<void> => new Promise((_, reject) => {\n      if (failedRequests >= endPoints.length) {\n        reject(`Discovery of [${endPoints.length}] endpoints from [${url}] failed, preventing it from completing`);\n      }\n    });\n    const endPoint = await Promise.race(endPoints.map(endPoint => endPoint\n      .ping()\n      .catch(e => {\n        this._logger.warn('Failed to ping end point [%s]', endPoint, e);\n\n        failedRequests++;\n\n        return propagateFailureIfAllRequestsFailed();\n      })\n      .then(time => {\n        const now = Date.now();\n\n        this._logger.info('Discovered end point [%s] with time [%s]', endPoint.toString(), time);\n        this._metricsService.push({\n          metricType: MetricsType.RoundTripTime,\n          runtime: (now - SDK.pageLoadTime) / 1000,\n          value: {uint64: time || 0},\n          resource: endPoint.toString(),\n          kind: 'ping'\n        });\n\n        return endPoint;\n      })));\n\n    return endPoint;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport EndPoint from './EndPoint';\nimport SDK from '../SDK';\nimport DiscoveryService from './DiscoveryService';\n\nconst discoveryCacheInterval = 60000;\n\ninterface IPerURIEndpoint { [x: string]: Promise<EndPoint> }\n\nexport default class Discovery {\n  private static _cache: IPerURIEndpoint = {};\n\n  static async precacheClosestEndPointDiscovery(): Promise<EndPoint> {\n    const uri = new URL(SDK.discoveryUri.value);\n\n    return Discovery.discoverClosestEndPointWithCaching(uri);\n  }\n\n  static async discoverClosestEndPointWithCaching(uri: URL): Promise<EndPoint> {\n    const url = uri.toString();\n\n    if (Discovery._cache[url]) {\n      return Discovery._cache[url];\n    }\n\n    const discoveryService = new DiscoveryService(uri);\n    const cachedValue = Discovery._cache[url] = discoveryService.discoverClosestEndPoint();\n    const ignored = Discovery._cache[url].then(() => {\n      const ignored = setTimeout(() => {\n        if (Discovery._cache[url] === cachedValue) {\n          delete Discovery._cache[url];\n        }\n      }, discoveryCacheInterval);\n    }).catch(() => {\n      delete Discovery._cache[url];\n    });\n\n    return cachedValue;\n  }\n\n  static clearCachedClosestEndpoint(uri: URL): void {\n    const url = uri.toString();\n\n    if (Discovery._cache[url]) {\n      delete Discovery._cache[url];\n    }\n  }\n\n  private constructor() {\n    throw new Error('Discovery is a static class that may not be instantiated');\n  }\n}\n\nconst ignored = Discovery.precacheClosestEndPointDiscovery();","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nexport enum NetworkStates {\n  NetworkEmpty,\n  NetworkIdle,\n  NetworkLoading,\n  NetworkNoSource\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {ILogger} from '../../logger/LoggerInterface';\nimport LoggerFactory from '../../logger/LoggerFactory';\nimport {ChunkedStreaming} from './ChunkedStreaming';\nimport {ChunkedStreamingOptions, ChunkedStreamingStatistics} from './StreamTypes';\nimport {NetworkStates} from './NetworkStates';\n\nconst bandwidthToStartAt = 3000000; // Corresponds to 720p in most setups\nconst minTimeBeforeNextReload = 15000;\n\ntype EventListenerForWebPlayer = (evt: WebPlayerEvent) => void;\ntype WebPlayerEvent = {\n  code: number;\n  severity: number;\n  error: string;\n};\n\nexport interface IWebPlayer {\n  start: (url: string) => void;\n  addEventListener(name: string, listener: EventListenerForWebPlayer): void;\n  dispose(): void;\n  errors: {\n    severity: {\n      RECOVERABLE: number;\n    };\n  };\n  getStats(): ChunkedStreamingStatistics;\n}\n\nexport default class WebPlayer {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('WebPlayer');\n  private readonly _videoElement: HTMLVideoElement;\n  private readonly _kind: string;\n  private readonly _streamId: string;\n  private readonly _manifestURI: string;\n  private readonly _options: ChunkedStreamingOptions;\n  private _player: IWebPlayer;\n  private _lastReloadTime: number;\n\n  constructor(videoElement: HTMLVideoElement, kind: string, streamId: string, manifestURI: string, options: ChunkedStreamingOptions) {\n    this._videoElement = videoElement;\n    this._kind = kind;\n    this._streamId = streamId;\n    this._manifestURI = encodeURI(manifestURI).replace(/[#]/g, '%23');\n    this._options = options;\n  }\n\n  start(): void {\n    if (ChunkedStreaming.phenixWebPlayer) {\n      const playerOptions = {\n        ...this._options,\n        bandwidthToStartAt\n      };\n\n      this._player = new ChunkedStreaming.phenixWebPlayer.WebPlayer(this._logger, this._videoElement, playerOptions);\n      this._player.start(this._manifestURI);\n\n      this._player.addEventListener('error', errorObject => {\n        if (this.canReload() && errorObject && (errorObject.code === 3 || errorObject.severity === ChunkedStreaming.phenixWebPlayer.errors.severity.RECOVERABLE)) {\n          this._logger.warn('Reloading unhealthy stream after error event [%j]', errorObject);\n          this.reloadIfAble();\n        }\n\n        this._logger.error('Cannot reload with error [%j]', errorObject);\n      });\n\n      return;\n    }\n  }\n\n  isSupported(): boolean {\n    return ChunkedStreaming.phenixWebPlayer && ChunkedStreaming.phenixWebPlayer.isSupported;\n  }\n\n  getStats(): ChunkedStreamingStatistics {\n    if (!this._player) {\n      return {\n        width: 0,\n        height: 0,\n        currentTime: 0.0,\n        lag: 0.0,\n        networkState: NetworkStates.NetworkNoSource,\n        dataBuffered: 0.0\n      };\n    }\n\n    const statistics = this._player.getStats();\n    const currentTime = statistics.currentTime || this._videoElement['currentTime'];\n    const trueCurrentTime = (Date.now() - this._options.originStartTime) / 1000;\n\n    if (this._videoElement.buffered && this._videoElement.buffered.length) {\n      statistics.dataBuffered = this._videoElement.buffered.end(0);\n    }\n\n    if (statistics.isNative && statistics.deliveryType === 'Hls') {\n      statistics.currentTime = currentTime - statistics.lag;\n    }\n\n    if (!statistics.currentTime) {\n      statistics.currentTime = currentTime;\n    }\n\n    if (!statistics.isNative) {\n      statistics.lag = Math.max(0.0, trueCurrentTime - currentTime);\n    }\n\n    if (statistics.estimatedBandwidth > 0) {\n      statistics.networkState = NetworkStates.NetworkLoading;\n    } else if (statistics.playTime > 0) {\n      statistics.networkState = NetworkStates.NetworkIdle;\n    } else if (statistics.video) {\n      statistics.networkState = NetworkStates.NetworkEmpty;\n    } else {\n      statistics.networkState = NetworkStates.NetworkNoSource;\n    }\n\n    return statistics;\n  }\n\n  dispose(): void {\n    if (this._player) {\n      this._player.dispose();\n    }\n\n    this._player = null;\n  }\n\n  private canReload(): boolean {\n    const hasElapsedMinTimeSinceLastReload = !this._lastReloadTime || Date.now() - this._lastReloadTime > minTimeBeforeNextReload;\n\n    return this._videoElement && this._player && this._videoElement.buffered.length !== 0 && hasElapsedMinTimeSinceLastReload;\n  }\n\n  private reloadIfAble(): void {\n    if (!this.canReload()) {\n      return;\n    }\n\n    this._logger.warn('[%s] Reloading unhealthy stream that was active for at least [%s] seconds', this._streamId, minTimeBeforeNextReload / 1000);\n\n    this._lastReloadTime = Date.now();\n\n    this.reload();\n  }\n\n  private reload(): void {\n    this._player.dispose();\n\n    this._player = null;\n\n    this.start();\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {ILogger} from '../../logger/LoggerInterface';\nimport LoggerFactory from '../../logger/LoggerFactory';\nimport {ChunkedStreaming} from './ChunkedStreaming';\nimport {ChunkedStreamingOptions, ChunkedStreamingStatistics} from './StreamTypes';\nimport {NetworkStates} from './NetworkStates';\n\ntype ShakaOptions = {\n  abr: {\n    defaultBandwidthEstimate: number;\n  };\n  manifest: {\n    retryParameters: {\n      timeout: number;\n    };\n  };\n  streaming: {\n    rebufferingGoal: number;\n    bufferingGoal: number;\n    bufferBehind: number;\n    retryParameters: {\n      timeout: number;\n      maxAttempts: number;\n      backoffFactor: number;\n    };\n  };\n};\n\nexport interface IShaka {\n  configure: (o: ShakaOptions) => void;\n  load: (uri: string) => Promise<void>;\n  getStats: () => ChunkedStreamingStatistics;\n  destroy: () => void;\n  unload: () => void;\n}\n\nexport default class ShakaPlayer {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('ShakaPlayer');\n  private readonly _videoElement: HTMLVideoElement;\n  private readonly _kind: string;\n  private readonly _streamId: string;\n  private readonly _manifestURI: string;\n  private readonly _options: ChunkedStreamingOptions;\n  private _player: IShaka;\n\n  constructor(videoElement: HTMLVideoElement, kind: string, streamId: string, manifestURI: string, options: ChunkedStreamingOptions) {\n    this._videoElement = videoElement;\n    this._kind = kind;\n    this._streamId = streamId;\n    this._manifestURI = encodeURI(manifestURI).replace(/[#]/g, '%23');\n    this._options = options;\n  }\n\n  start(): void {\n    if (ChunkedStreaming.shaka) {\n      const playerOptions: ShakaOptions = {\n        abr: {defaultBandwidthEstimate: 2000000},\n        manifest: {retryParameters: {timeout: 10000}},\n        streaming: {\n          rebufferingGoal: 2,\n          bufferingGoal: 10,\n          bufferBehind: 30,\n          retryParameters: {\n            timeout: 10000,\n            maxAttempts: 10,\n            backoffFactor: 1.1\n          }\n        }\n      };\n\n      this._player = new ChunkedStreaming.shaka.Player(this._videoElement);\n      this.loadPlayer(playerOptions);\n\n      return;\n    }\n  }\n\n  getStats(): ChunkedStreamingStatistics {\n    if (!this._player) {\n      return {\n        width: 0,\n        height: 0,\n        currentTime: 0,\n        lag: 0,\n        networkState: NetworkStates.NetworkNoSource\n      };\n    }\n\n    const statistics = {\n      ...this._player.getStats(),\n      currentTime: 0,\n      lag: 0\n    };\n    const currentTime = this._videoElement['currentTime'] || 0;\n    const trueCurrentTime = (Date.now() - this._options.originStartTime) / 1000;\n    const lag = Math.max(0.0, trueCurrentTime - currentTime);\n\n    if (this._videoElement) {\n      statistics.currentTime = currentTime;\n      statistics.lag = lag;\n\n      if (this._videoElement.buffered && this._videoElement.buffered.length) {\n        statistics.dataBuffered = this._videoElement.buffered.end(0);\n      }\n    }\n\n    if (statistics.estimatedBandwidth > 0) {\n      statistics.networkState = NetworkStates.NetworkLoading;\n    } else if (statistics.playTime > 0) {\n      statistics.networkState = NetworkStates.NetworkIdle;\n    } else if (statistics.video) {\n      statistics.networkState = NetworkStates.NetworkEmpty;\n    } else {\n      statistics.networkState = NetworkStates.NetworkNoSource;\n    }\n\n    return statistics;\n  }\n\n  dispose(): void {\n    if (this._player) {\n      this._player.unload();\n      this._player.destroy();\n    }\n\n    this._player = null;\n  }\n\n  private loadPlayer(playerConfig: ShakaOptions): void {\n    this._player.configure(playerConfig);\n\n    const ignored = this._player.load(this._manifestURI).then(() => {\n      this._logger.info('[%s] DASH live stream has been loaded', this._streamId);\n\n      if (this._videoElement.play) {\n        this._videoElement.play();\n      }\n    }).catch(e => {\n      this._logger.error('[%s] Error while loading DASH live stream [%s]', this._streamId, e.code, e);\n    });\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {ChunkedStreaming} from './ChunkedStreaming';\nimport {ChunkedStreamingOptions, ChunkedStreamingStatistics} from './StreamTypes';\nimport {IHlsPlayerType} from './IHlsPlayer';\nimport {NetworkStates} from './NetworkStates';\n\nexport default class HlsPlayer {\n  private readonly _videoElement: HTMLVideoElement;\n  private readonly _kind: string;\n  private readonly _streamId: string;\n  private readonly _manifestURI: string;\n  private readonly _options: ChunkedStreamingOptions;\n  private _player: IHlsPlayerType;\n\n  constructor(videoElement: HTMLVideoElement, kind: string, streamId: string, manifestURI: string, options: ChunkedStreamingOptions) {\n    this._videoElement = videoElement;\n    this._kind = kind;\n    this._streamId = streamId;\n    this._manifestURI = encodeURI(manifestURI).replace(/[#]/g, '%23');\n    this._options = options;\n  }\n\n  start(): void {\n    if (ChunkedStreaming.hlsPlayer) {\n      if (ChunkedStreaming.hlsPlayer.isSupported()) {\n        this._player = new ChunkedStreaming.hlsPlayer({\n          enableWorker: true,\n          maxBufferLength: 1,\n          liveBackBufferLength: 0,\n          liveSyncDuration: 7,\n          liveDurationInfinity: true,\n          liveMaxLatencyDuration: Infinity,\n          highBufferWatchdogPeriod: 1\n        });\n        this._player.loadSource(this._manifestURI);\n        this._player.attachMedia(this._videoElement);\n      } else if (this._videoElement.canPlayType('application/vnd.apple.mpegurl')) {\n        this._videoElement.src = this._manifestURI;\n      }\n    }\n  }\n\n  isSupported(): boolean {\n    return ChunkedStreaming.hlsPlayer && ChunkedStreaming.hlsPlayer.isSupported();\n  }\n\n  getStats(): ChunkedStreamingStatistics {\n    if (!this._player) {\n      return {\n        width: 0,\n        height: 0,\n        currentTime: 0.0,\n        lag: 0.0,\n        networkState: NetworkStates.NetworkNoSource\n      };\n    }\n\n    const statistics = {\n      width: this._player.media.offsetWidth,\n      height: this._player.media.offsetHeight,\n      currentTime: this._player.media.currentTime,\n      lag: 0.0,\n      networkState: NetworkStates.NetworkIdle,\n      dataBuffered: 0.0\n    };\n\n    if (this._videoElement.buffered && this._videoElement.buffered.length) {\n      statistics.dataBuffered = this._videoElement.buffered.end(0);\n    }\n\n    if (this._player.streamController.state === 'IDLE') {\n      statistics.networkState = NetworkStates.NetworkIdle;\n    } else if (this._player.streamController.state === 'ERROR' || this._player.streamController.state === 'ENDED') {\n      statistics.networkState = NetworkStates.NetworkNoSource;\n    } else if (this._player.streamController.state.includes('LOADING') || this._player.streamController.state.includes('WAITING')) {\n      statistics.networkState = NetworkStates.NetworkLoading;\n    } else {\n      statistics.networkState = NetworkStates.NetworkEmpty;\n    }\n\n    const currentTime = this._videoElement['currentTime'] || 0;\n    const trueCurrentTime = (Date.now() - this._options.originStartTime) / 1000;\n\n    statistics.lag = Math.max(0.0, (currentTime + (this._options.lag / 1000)) - trueCurrentTime);\n\n    return statistics;\n  }\n\n  dispose(): void {\n    if (this._player && this._player.destroy) {\n      this._player.destroy();\n\n      this._player = null;\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport FeatureEnablement from '../../environment/FeatureEnablement';\nimport WebPlayer from './WebPlayer';\nimport SDK from '../SDK';\nimport ShakaPlayer from './ShakaPlayer';\nimport HlsPlayer from './HlsPlayer';\nimport IDisposable from '../../lang/IDisposable';\nimport {HlsPlayerType, ChunkedStreamingOptions, ChunkedStreamingStatistics, ShakaType, WebPlayerType} from './StreamTypes';\n\nexport class ChunkedStreaming {\n  private static _pending = false;\n  private static _hlsPlayer: HlsPlayerType;\n  private static _phenixWebPlayer: WebPlayerType;\n  private static _shaka: ShakaType;\n  private static _options: ChunkedStreamingOptions;\n  private static _player: ShakaPlayer | WebPlayer | HlsPlayer;\n\n  static get hlsPlayer(): HlsPlayerType {\n    return this._hlsPlayer;\n  }\n\n  static get phenixWebPlayer(): WebPlayerType {\n    return this._phenixWebPlayer;\n  }\n\n  static get shaka(): ShakaType {\n    return this._shaka;\n  }\n\n  static async start(videoElement: HTMLVideoElement, streamId: string, offerSdp: string, options: ChunkedStreamingOptions): Promise<IDisposable> {\n    this._options = options;\n\n    if (this._hlsPlayer || this._shaka || this._phenixWebPlayer) {\n      return this.loaded(videoElement, streamId, offerSdp);\n    }\n\n    if (!SDK.webPlayerLoader && !SDK.shakaPlayerLoader && !SDK.hlsJsLoader) {\n      throw new Error('No player is provided');\n    }\n\n    if (!SDK.webPlayerLoader && !SDK.shakaPlayerLoader && !SDK.hlsJsLoader) {\n      throw new Error('Unsupported-feature, add stream player');\n    }\n\n    return new Promise(resolve => {\n      if (SDK.hlsJsLoader) {\n        this._pending = true;\n        SDK.hlsJsLoader(player => {\n          this._hlsPlayer = player;\n\n          if (this._pending) {\n            this._pending = false;\n\n            resolve(this.loaded(videoElement, streamId, offerSdp));\n          }\n        });\n      }\n\n      if (SDK.webPlayerLoader) {\n        this._pending = true;\n        SDK.webPlayerLoader(player => {\n          this._phenixWebPlayer = player;\n\n          if (this._pending) {\n            this._pending = false;\n\n            resolve(this.loaded(videoElement, streamId, offerSdp));\n          }\n        });\n      }\n\n      if (SDK.shakaPlayerLoader) {\n        this._pending = true;\n        SDK.shakaPlayerLoader(player => {\n          this._shaka = player;\n\n          if (this._pending) {\n            this._pending = false;\n\n            resolve(this.loaded(videoElement, streamId, offerSdp));\n          }\n        });\n      }\n    });\n  }\n\n  static getStats(): ChunkedStreamingStatistics {\n    if (this._player) {\n      return this._player.getStats();\n    }\n\n    return null;\n  }\n\n  private static play(Player: typeof WebPlayer | typeof ShakaPlayer | typeof HlsPlayer, videoElement: HTMLVideoElement, streamId: string, offerSdp: string, options: ChunkedStreamingOptions): IDisposable {\n    const dashManifestUrlMatch = offerSdp.match(/a=x-playlist:([^\\n]*[.]mpd\\??[^\\s]*)/m);\n    const hlsManifestUrlMatch = offerSdp.match(/a=x-playlist:([^\\n]*[.]m3u8\\??[^\\s]*)/m);\n    const manifestUrl = dashManifestUrlMatch && dashManifestUrlMatch[1] ? dashManifestUrlMatch[1] : '';\n    const playlistUrl = hlsManifestUrlMatch && hlsManifestUrlMatch[1] ? hlsManifestUrlMatch[1] : '';\n\n    if (FeatureEnablement.shouldUseNativeHls || (this._hlsPlayer && this._hlsPlayer.isSupported())) {\n      this._player = new Player(videoElement, 'hls', streamId, playlistUrl, options);\n\n      this._player.start();\n\n      return this._player;\n    }\n\n    this._player = new Player(videoElement, 'dash', streamId, manifestUrl, options);\n\n    this._player.start();\n\n    return this._player;\n  }\n\n  private static loaded(videoElement: HTMLVideoElement, streamId: string, offerSdp: string): IDisposable {\n    if (!this._shaka && !this._phenixWebPlayer && !this._hlsPlayer) {\n      return;\n    }\n\n    if (this._hlsPlayer) {\n      return this.play(HlsPlayer, videoElement, streamId, offerSdp, {\n        ...this._options,\n        preferNative: FeatureEnablement.shouldUseNativeHls\n      });\n    }\n\n    if (this._phenixWebPlayer) {\n      return this.play(WebPlayer, videoElement, streamId, offerSdp, {\n        ...this._options,\n        preferNative: FeatureEnablement.shouldUseNativeHls\n      });\n    }\n\n    if (this._shaka) {\n      return this.play(ShakaPlayer, videoElement, streamId, offerSdp, {\n        ...this._options,\n        preferNative: FeatureEnablement.shouldUseNativeHls\n      });\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport ChannelContext from '../context/ChannelContext';\nimport Discovery from '../discovery/Discovery';\nimport Disposable from '../../lang/Disposable';\nimport DisposableList from '../../lang/DisposableList';\nimport LoggerFactory from '../../logger/LoggerFactory';\nimport ChannelState from '../channels/ChannelState';\nimport {ChunkedStreaming} from './ChunkedStreaming';\nimport {ChunkedStreamingStatistics} from './StreamTypes';\nimport IDisposable from '../../lang/IDisposable';\nimport {IStream} from './IStream';\nimport {ILogger} from '../../logger/LoggerInterface';\n\nexport default class ChunkedStream implements IStream {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('ChunkedStream');\n  private readonly _channelContext: ChannelContext;\n  private readonly _monitorDisposables = new DisposableList();\n  private readonly _handleStreamFailure: () => Promise<void>;\n  private _streamStatistics: ChunkedStreamingStatistics;\n  private _monitorFailureCount = 0;\n\n  constructor(channelContext, handleStreamFailure: () => Promise<void>) {\n    this._channelContext = channelContext;\n    this._handleStreamFailure = handleStreamFailure;\n    this._channelContext.disposables.add(this);\n  }\n\n  start(uri: URL, token: string): Promise<void | IDisposable> {\n    return Discovery.discoverClosestEndPointWithCaching(uri)\n      .then(endPoint => {\n        this._channelContext.online.value = true;\n        this._channelContext.endPoint.value = endPoint;\n        this._logger.info('Connecting to [%s]', endPoint.toString());\n\n        return endPoint.subscribe(token, null, this._channelContext.failureCount.value);\n      })\n      .then(({status, stream, createOfferDescriptionResponse, lag}) => {\n        this._channelContext.stream.value = stream;\n        this._channelContext.lag.value = lag;\n\n        this._channelContext.applySessionAndStreamPropertiesToVideoElement();\n\n        this._logger.debug(\n          '[%s] Subscribe completed [%s] [%j] [%j] [%j] [%j]',\n          this._channelContext.streamId,\n          status,\n          createOfferDescriptionResponse,\n        );\n\n        this._channelContext.state.value = this._channelContext.mapSubscribeStatusToChannelStatus(status);\n\n        this._channelContext.applyStatus(status);\n\n        if (status !== 'ok') {\n          return;\n        }\n\n        const offerSdp = createOfferDescriptionResponse.sessionDescription.sdp;\n        const options = {\n          originStartTime: Date.now() - lag + this._channelContext.endPoint.value.roundTripTime / 2,\n          lag\n        };\n\n        return ChunkedStreaming.start(this._channelContext.videoElement.value, this._channelContext.streamId, offerSdp, options)\n          .then(player => {\n            this.monitor(player);\n\n            return player;\n          })\n          .catch(e => {\n            this._logger.error('ChunkedStreaming failed', e);\n            this._channelContext.loading.value = false;\n            this._channelContext.playing.value = false;\n            this._channelContext.state.value = ChannelState.Stopped;\n          });\n      });\n  }\n\n  private monitor(player: IDisposable): void {\n    this._monitorDisposables.dispose();\n\n    const timeout = window.setTimeout(() => {\n      const newStreamStatistics = ChunkedStreaming.getStats();\n\n      if (this._streamStatistics &&\n        this._streamStatistics.currentTime >= newStreamStatistics.currentTime &&\n        this._streamStatistics.dataBuffered >= newStreamStatistics.dataBuffered\n      ) {\n        this._monitorFailureCount++;\n\n        if (this._monitorFailureCount > 6) {\n          this._monitorFailureCount = 0;\n          this._channelContext.state.value = ChannelState.ConnectionError;\n\n          this._channelContext.playing.value = false;\n          this._channelContext.loading.value = true;\n          player.dispose();\n          this._monitorDisposables.dispose();\n\n          const ignored = this._handleStreamFailure()\n            .catch(e => {\n              this._logger.error('Failed handling stream failure', e);\n            });\n\n          return;\n        }\n      } else {\n        this._monitorFailureCount = 0;\n      }\n\n      if (this._channelContext.videoElement.value.paused && this._channelContext.state.value === ChannelState.Playing) {\n        this._channelContext.state.value = ChannelState.Paused;\n      }\n\n      if (!this._channelContext.videoElement.value.paused && this._channelContext.state.value !== ChannelState.Playing) {\n        this._channelContext.state.value = ChannelState.Playing;\n      }\n\n      this._streamStatistics = newStreamStatistics;\n      this.monitor(player);\n    }, 1000);\n\n    this._monitorDisposables.add(new Disposable(() => {\n      clearTimeout(timeout);\n    }));\n  }\n\n  dispose(): void {\n    this._monitorDisposables.dispose();\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nexport default class SdpParser {\n  private readonly _sdp: string;\n  private readonly _audioCodec: string;\n  private readonly _videoCodec: string;\n  private readonly _isAudioTrackEnabled: boolean;\n  private readonly _isVideoTrackEnabled: boolean;\n\n  constructor(sdp: string) {\n    this._sdp = sdp;\n\n    const sdpSplitByLines = this._sdp.split(/(\\r\\n|\\r|\\n)/);\n    const sdpSplitByTracks = this._sdp.split(/(?:^|[\\r\\n])m=/);\n\n    this._audioCodec = this.applyCodec('audio', sdpSplitByLines);\n    this._videoCodec = this.applyCodec('video', sdpSplitByLines);\n    this._isAudioTrackEnabled = this.isTrackByTypeEnabled('audio', sdpSplitByTracks);\n    this._isVideoTrackEnabled = this.isTrackByTypeEnabled('video', sdpSplitByTracks);\n  }\n\n  get audioCodec(): string {\n    return this._audioCodec;\n  }\n\n  get videoCodec(): string {\n    return this._videoCodec;\n  }\n\n  get isAudioTrackEnabled(): boolean {\n    return this._isAudioTrackEnabled;\n  }\n\n  get isVideoTrackEnabled(): boolean {\n    return this._isVideoTrackEnabled;\n  }\n\n  private isTrackByTypeEnabled(type: string, sdpSplitByTracks: string[]): boolean {\n    const sdpSectionForType = sdpSplitByTracks.find(sdpTrack => sdpTrack.startsWith(type));\n\n    if (!sdpSectionForType) {\n      return false;\n    }\n\n    return !sdpSectionForType.includes(`a=inactive`);\n  }\n\n  private applyCodec(type: string, sdpSplitByLines: string []): string {\n    const usedCodecLine = sdpSplitByLines.find(sdpLine => sdpLine.includes(`a=rtpmap:${sdpSplitByLines.find(i => i.includes(`m=${type}`)).split(' ')[3]}`));\n    const usedCodec = usedCodecLine.split(' ')[1];\n    const codecName = usedCodec.split('/')[0];\n\n    return codecName;\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport IPeerConnection from './IPeerConnection';\nimport Subject from '../rx/Subject';\nimport FeatureEnablement from '../environment/FeatureEnablement';\nimport SdpParser from './SdpParser';\nimport IDisposable from '../lang/IDisposable';\n\nexport interface IRtcMonitorStatistic {\n  [kind: string]: IRtcStatistic;\n}\n\nexport interface ILegacyRTCStatsReport {\n  result: () => ILegacyRTCStatsReportItem[];\n}\n\nexport interface ILegacyRTCStatsReportItem extends RTCStatsReport {\n  type: string;\n  names: () => string[];\n  stat: (name) => number;\n}\n\nexport interface IRtcStatistic {\n  ssrc?: string;\n  mediaType?: string;\n  timestamp: number;\n  bitrate?: number;\n  bytesReceived?: number;\n  framesDecoded?: number;\n  packetsLost?: number;\n  packetsReceived?: number;\n  codec?: string;\n  fps?: number;\n  roundTripTime?: number;\n  lastPacketReceivedTimestamp?: number;\n}\n\nconst updateStatisticTimeout = 1000;\n\nexport default class RtcConnectionMonitor implements IDisposable {\n  private readonly _estimatedRoundTripTime: number;\n  private readonly _estimatedVideoCodec: string;\n  private readonly _estimatedAudioCodec: string;\n  private readonly _rtcStatistic: Subject<IRtcMonitorStatistic> = new Subject<IRtcMonitorStatistic>({});\n  private _peerConnection: IPeerConnection;\n  private _isMonitorRunning = true;\n  private _updateTimeout: number;\n  private _tracksToMonitor: string[];\n\n  constructor(peerConnection: IPeerConnection, mediaStream: MediaStream, estimatedRoundTripTime: number) {\n    this._peerConnection = peerConnection;\n    this._estimatedRoundTripTime = estimatedRoundTripTime;\n    this._tracksToMonitor = mediaStream.getTracks().map(track => track.kind) || [];\n\n    if (this._peerConnection) {\n      if (!FeatureEnablement.getCurrentOfferDisabled) {\n        const parsedSDP = new SdpParser(this._peerConnection.currentRemoteDescription.sdp);\n\n        this._estimatedAudioCodec = parsedSDP.audioCodec;\n        this._estimatedVideoCodec = parsedSDP.videoCodec;\n      }\n\n      this.updateStatistic();\n    }\n  }\n\n  get rtcStatistic(): Subject<IRtcMonitorStatistic> {\n    return this._rtcStatistic;\n  }\n\n  dispose(): void {\n    this._isMonitorRunning = false;\n    this._peerConnection = null;\n\n    if (this._updateTimeout) {\n      clearTimeout(this._updateTimeout);\n      this._updateTimeout = null;\n    }\n  }\n\n  private async updateStatistic(): Promise<void> {\n    if (FeatureEnablement.getStatsPromiseBasedDisabled) {\n      const ignored = await this.updateStatisticLegacy();\n\n      return;\n    }\n\n    // Safari 11 doesnt have kind or mediaType so we need to take it from the inbound-rtp object id\n    const getKindForSafari11 = (item): string => item.id.includes('Audio') ? 'audio' : item.id.includes('Video') ? 'video' : '';\n    const ignored = await this._peerConnection.getStats(null)\n      .then(stats => {\n        const rtcStatistics: IRtcMonitorStatistic = {};\n\n        if (stats) {\n          let roundTripTime = this._estimatedRoundTripTime;\n          let lastPacketReceivedTimestamp;\n\n          stats.forEach(report => {\n            if (report.type === 'candidate-pair' && report.currentRoundTripTime) {\n              roundTripTime = report.currentRoundTripTime * 1000;\n\n              if (rtcStatistics['audio']) {\n                rtcStatistics['audio'].roundTripTime = roundTripTime;\n              }\n\n              if (rtcStatistics['video']) {\n                rtcStatistics['video'].roundTripTime = roundTripTime;\n              }\n            }\n\n            if (report.type === 'candidate-pair' && report.lastPacketReceivedTimestamp) {\n              lastPacketReceivedTimestamp = report.lastPacketReceivedTimestamp;\n\n              if (rtcStatistics['audio']) {\n                rtcStatistics['audio'].lastPacketReceivedTimestamp = lastPacketReceivedTimestamp;\n              }\n\n              if (rtcStatistics['video']) {\n                rtcStatistics['video'].lastPacketReceivedTimestamp = lastPacketReceivedTimestamp;\n              }\n            }\n\n            if (report.type === 'inbound-rtp') {\n              const kind = report.kind || report.mediaType || getKindForSafari11(report);\n              let codec = '';\n\n              stats.forEach(item => {\n                if (item.id === report.codecId) {\n                  codec = item.mimeType;\n                }\n              });\n\n              if (kind && this._tracksToMonitor.includes(kind)) {\n                const bytes = report.bytesReceived || 0;\n                const previousBytesReceived = this._rtcStatistic.value?.[kind]?.bytesReceived ?? 0;\n                const bytesDelta = bytes - previousBytesReceived;\n                const timeDelta = report.timestamp - this._rtcStatistic.value?.[kind]?.timestamp;\n                const bitrate = bytesDelta && timeDelta ? Math.floor(8 * bytesDelta /\n                  timeDelta * 1000) : 0;\n\n                rtcStatistics[kind] = {\n                  ssrc: report.ssrc,\n                  mediaType: kind,\n                  timestamp: report.timestamp,\n                  bitrate,\n                  bytesReceived: report.bytesReceived,\n                  packetsLost: report.packetsLost,\n                  packetsReceived: report.packetsReceived,\n                  codec: codec || this.getCodecByType(kind),\n                  roundTripTime\n                };\n\n                if (report.lastPacketReceivedTimestamp || lastPacketReceivedTimestamp) {\n                  rtcStatistics[kind].lastPacketReceivedTimestamp = report.lastPacketReceivedTimestamp || lastPacketReceivedTimestamp;\n                }\n\n                if (kind === 'video' && this._rtcStatistic.value && this._rtcStatistic.value.video) {\n                  rtcStatistics[kind]['framesDecoded'] = report.framesDecoded;\n\n                  const fps = (report.framesDecoded - this._rtcStatistic.value.video.framesDecoded) /\n                    (rtcStatistics[kind].timestamp - this._rtcStatistic.value.video.timestamp) *\n                    1000;\n\n                  rtcStatistics[kind]['fps'] = fps ? Math.round(fps * 100) / 100 : 0;\n                }\n              }\n            }\n          });\n        }\n\n        this._rtcStatistic.value = rtcStatistics;\n      }).then(() => {\n        if (this._isMonitorRunning) {\n          this._updateTimeout = window.setTimeout(() => this.updateStatistic(), updateStatisticTimeout);\n        }\n      });\n  }\n\n  private async updateStatisticLegacy(): Promise<void> {\n    const ignored = await this._peerConnection.getStatsLegacy().then(stats => {\n      const rtcStatistics: IRtcMonitorStatistic = {};\n      let roundTripTime = this._estimatedRoundTripTime;\n\n      stats.result().forEach(report => {\n        report.names().forEach(name => {\n          if (name === 'googRTT') {\n            roundTripTime = report.stat(name);\n          }\n        });\n\n        if (report.type === 'ssrc') {\n          const mediaType = report.stat('mediaType').toString();\n\n          rtcStatistics[mediaType] = {timestamp: Date.now()};\n          rtcStatistics[mediaType]['ssrc'] = report.stat('ssrc').toString();\n          rtcStatistics[mediaType]['mediaType'] = mediaType;\n          rtcStatistics[mediaType]['bytesReceived'] = report.stat('bytesReceived');\n          rtcStatistics[mediaType]['packetsLost'] = report.stat('packetsLost');\n          rtcStatistics[mediaType]['packetsReceived'] = report.stat('packetsReceived');\n          rtcStatistics[mediaType]['codec'] = report.stat('googCodecName').toString() || this.getCodecByType(mediaType);\n          rtcStatistics[mediaType]['roundTripTime'] = roundTripTime;\n\n          if (mediaType === 'video' && this._rtcStatistic.value && this._rtcStatistic.value.video) {\n            rtcStatistics[mediaType]['framesDecoded'] = report.stat('framesDecoded');\n            rtcStatistics[mediaType]['fps'] = (rtcStatistics[mediaType].framesDecoded - this._rtcStatistic.value.video.framesDecoded) /\n              (rtcStatistics[mediaType].timestamp - this._rtcStatistic.value.video.timestamp) *\n            1000 || 0;\n          }\n        }\n      });\n      this._rtcStatistic.value = rtcStatistics;\n    }).then(() => {\n      if (this._isMonitorRunning) {\n        this._updateTimeout = window.setTimeout(() => this.updateStatistic(), updateStatisticTimeout);\n      }\n    });\n  }\n\n  private getCodecByType(type: string): string {\n    switch (type) {\n      case 'audio':\n        return this._estimatedAudioCodec;\n      case 'video':\n        return this._estimatedVideoCodec;\n      default:\n        return 'unknown';\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nexport default class RtcConfigurationManager {\n  static truncateIceServers(configuration: RTCConfiguration): RTCConfiguration {\n    const iceServers: RTCIceServer[] = [];\n\n    for (let i = 0; i < configuration.iceServers.length; i++) {\n      const urls: string[] = [];\n\n      for (let index = 0; index < 2; index++) {\n        const url = configuration.iceServers[i].urls[index];\n\n        if (url) {\n          urls.push(configuration.iceServers[i].urls[index]);\n        }\n      }\n\n      iceServers.push({\n        urls: urls,\n        username: configuration.iceServers[i].username,\n        credential: configuration.iceServers[i].credential\n      });\n    }\n\n    configuration.iceServers = iceServers;\n\n    return configuration;\n  }\n\n  private constructor() {\n    throw new Error('RtcConfigurationManager is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport BrowserDetector from '../../dom/BrowserDetector';\n\nconst _dummy2x2VideoIFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x67, 0xf4, 0x00, 0x0a, 0x91, 0x9b, 0x2b, 0xf1, 0xf1, 0xf8, 0x08, 0x80, 0x00, 0x00, 0x03, 0x00, 0x80, 0x00, 0x00, 0x19, 0x07, 0x89, 0x12, 0xcb, // Sequence parameter set\n    0x00, 0x00, 0x00, 0x01, 0x68, 0xeb, 0xe3, 0xc4, 0x48, 0x44, // Picture paramter set\n    /* */ 0x00, 0x00, 0x01, 0x65, 0x88, 0x82, 0x00, 0x3f, 0x70, 0x23, 0x86, 0xe6, 0xd1, 0x80, 0x09, 0xaf, 0x0a, 0x41, 0x66, 0x6b, 0x54, 0x46, 0xfb, 0x71, 0xd9, 0x7f, 0xff, 0xff, 0xf9]), // Slice layer: idr data\n  VP8: new Uint8Array([0xb0, 0x02, 0x00, 0x9d, 0x01, 0x2a, 0x01, 0x00, 0x01, 0x00, 0x39, 0x6b, 0x00, 0x27, 0x1c, 0x24, 0x0c, 0x2c, 0x2c, 0x44, 0xcc, 0x24, 0x41, 0xa8, 0x00, 0x13, 0xa7, 0xa3, 0x7a, 0x50, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x82, 0x49, 0x83, 0x42, 0x00, 0x00, 0x00, 0x00, 0x06, 0x76, 0x38, 0x24, 0x1c, 0x19, 0xa0, 0x00, 0x00, 0x20, 0x40, 0x00, 0x11, 0xbf, 0xdd, 0x77, 0xff, 0x40, 0x7f, 0xb1, 0x00])\n};\nconst _dummy2x2VideoPFramePerCodec = {\n  H264: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x09, 0xf0, // Access unit delimiter\n    0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x68, 0x49, 0xa8, 0x41, 0x68, 0x99, 0x4c, 0x0f, 0xff, 0x92, 0x81]), // Slice layer: non idr data\n  VP8: new Uint8Array([0x31, 0x03, 0x00, 0xe4, 0xe0, 0xa8, 0x9b, 0x37, 0xaf, 0x10, 0x4f, 0x4f, 0xb1, 0x0a, 0x2f, 0xe4, 0x92, 0xc0, 0x1f, 0xe7, 0x4f, 0x46, 0xff, 0xee, 0x51, 0xc1, 0x5d, 0x00, 0xfe, 0xeb, 0xde, 0x2f, 0x8a, 0x1e, 0x6b, 0x7b, 0x07, 0x72, 0x63, 0x09, 0xa4, 0x8e, 0xc0]),\n  VP9: new Uint8Array([0x86, 0x00, 0x40, 0x92, 0x9c, 0x24, 0x48, 0x00, 0x00, 0x03, 0x70, 0x00, 0x00, 0x4b, 0x40])\n};\nconst _dummy82x82H264 = {\n  I: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x67, 0x42, 0xc0, 0x0d, 0xda, 0x18, 0xde, 0x22, 0x22, 0x10, 0x00, 0x00, 0x03, 0x00, 0x10, 0x00, 0x00, 0x03, 0x03, 0xc8, 0xf1, 0x42, 0xaa, // Sequence parameter set\n    0x00, 0x00, 0x00, 0x01, 0x68, 0xce, 0x0f, 0xc8, // Picture parameter set\n    0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0x5f, ...new Uint8Array(10295).fill(0xff), 0x80, // Supplemental enhancement information (SEI)\n    0x00, 0x00, 0x00, 0x01, 0x65, 0x88, 0x84, 0x05, ...new Uint8Array(3).fill(0xff), 0x0f, 0x45, 0x00, 0x01, 0x57, 0x9f, 0x27, 0x27, 0x27, 0x27, 0x27, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x75, 0xd7, 0x5d, 0x78]), // Slice layer: Idr data\n  P: new Uint8Array([\n    0x00, 0x00, 0x00, 0x01, 0x06, 0x03, ...new Uint8Array(40).fill(0xff), 0xa4, ...new Uint8Array(10364).fill(0xff), 0x80, // SEI\n    0x00, 0x00, 0x00, 0x01, 0x41, 0x9a, 0x20, 0x15, 0xf0, 0x4b]) // Slice layer: non idr data\n  // FRAME NUMBER:       last bit ---^    ^-- first 3 bits\n  // X             0100 0001 1001 1010 0010 0000 // 0x41 0x9a 0x20\n  // X             zrru uuuu 1sss sspf fff. ....\n};\nconst _dummy82x82H264PFrameFrameNumberIndex = 10418;\nconst _dummyAudioSilentPerCodec = {opus: new Uint8Array([0x68, 0x07, 0xd9, 0xab, 0xbc, 0x79, 0x87, 0xab, 0x8e, 0x4a, 0x14, 0xf3, 0xa7, 0x1c, 0xf2, 0x9a, 0x7a, 0x45, 0xa7, 0x2d, 0x44, 0x25, 0x74, 0x4c, 0xad, 0x16, 0xb3, 0x0e, 0x51, 0x57, 0xea, 0xe7, 0xad, 0x2a, 0x38, 0xce, 0x33])};\nconst _singleZeroByte = new Uint8Array([0x00]);\nconst isMacDesktopChrome = BrowserDetector.browserName === 'Chrome' && (/Macintosh/i).test(navigator?.userAgent);\nconst isAndroidChrome = BrowserDetector.browserName === 'Chrome' && (/Android/i).test(navigator?.userAgent);\nlet _pFrameNumber = 1;\n\nfunction surrogateVideoIFramePerCodec(codec: string) : ArrayBuffer | undefined {\n  switch (codec) {\n    case 'H264': {\n      if (isMacDesktopChrome) {\n        return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n      }\n\n      if (isAndroidChrome) {\n        _pFrameNumber = 1;\n      }\n\n      return _dummy82x82H264['I']['buffer'];\n    }\n\n    case 'VP8': {\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP9': {\n      return _dummy2x2VideoIFramePerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction surrogateVideoPFramePerCodec(codec: string) : ArrayBuffer | undefined {\n  switch (codec) {\n    case 'H264': {\n      if (isMacDesktopChrome) { // NOTE: may not need this if( ! isAndroidChrome) defaults to this\n        return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n      }\n\n      // X if (isAndroidChrome) {\n      const buffer = setDummy82x82H264PFrameFrameNumber(_pFrameNumber);\n\n      _pFrameNumber++;\n\n      return buffer;\n      // X }\n      // X\n      // X return _dummy82x82H264['P']['buffer'];\n    }\n\n    case 'VP8': {\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    case 'VP9': {\n      return _dummy2x2VideoPFramePerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction surrogateAudioSilentPerCodec(codec: string) : ArrayBuffer | undefined {\n  switch (codec) {\n    case 'opus': {\n      return _dummyAudioSilentPerCodec[codec]['buffer'];\n    }\n\n    default: {\n      return undefined;\n    }\n  }\n}\n\nfunction invalidFrame(codec: string, type: string) : ArrayBuffer | undefined {\n  // X if (codec === 'H264' && isAndroidChrome) {\n  if (codec === 'H264') {\n    if (type === 'key') {\n      console.log('NIKNIK: KEY _pFrameNumber:', _pFrameNumber);\n      // X_pFrameNumber = 1;\n      // Xreturn undefined;\n    }\n\n    if (_pFrameNumber > 2) {\n      console.log('NIKNIK: DELTA _pFrameNumber:', _pFrameNumber);\n      _pFrameNumber = 1;\n\n      return undefined;\n    }\n\n    const buffer = setDummy82x82H264PFrameFrameNumber(_pFrameNumber);\n\n    _pFrameNumber++;\n\n    return buffer;\n  }\n\n  return _singleZeroByte['buffer'];\n}\n\nlet firstTimeHere = 0;\n\nfunction setDummy82x82H264PFrameFrameNumber(frameNumber) {\n  const byte1 = 0x9a | ((frameNumber & 0x0e) >> 1);\n  const byte2 = 0x20 | ((frameNumber & 0x01) << 7);\n  const buffer = _dummy82x82H264['P']['buffer'];\n\n  if (!firstTimeHere) {\n    firstTimeHere = 1;\n    console.log('NIKBYTES: b1:', buffer[_dummy82x82H264PFrameFrameNumberIndex], ' b2:', buffer[_dummy82x82H264PFrameFrameNumberIndex + 1]);\n  }\n\n  buffer[_dummy82x82H264PFrameFrameNumberIndex] = byte1;\n  buffer[_dummy82x82H264PFrameFrameNumberIndex + 1] = byte2;\n\n  return buffer;\n}\n\nexport {\n  surrogateVideoIFramePerCodec,\n  surrogateVideoPFramePerCodec,\n  surrogateAudioSilentPerCodec,\n  invalidFrame\n};","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Disposable from '../../lang/Disposable';\nimport DisposableList from '../../lang/DisposableList';\nimport {IStreamTrackTransform} from '../transformation/StreamTrackTransform';\nimport {IEncodedStreamSink} from '../transformation/EncodedStreamSink';\nimport FeatureEnablement from '../../environment/FeatureEnablement';\nimport {surrogateVideoIFramePerCodec, surrogateVideoPFramePerCodec, surrogateAudioSilentPerCodec, invalidFrame} from './SurrogateFrameDataPerCodec';\n\nexport default class InsertableStreams {\n  static applyEncodedStreamTransformation(stream: MediaStream, receivers: RTCRtpReceiver[], encodedVideoStreamSink: IEncodedStreamSink<RTCEncodedVideoFrame>, encodedAudioStreamSink: IEncodedStreamSink<RTCEncodedAudioFrame>, videoCodec: string, audioCodec: string) : {disposables: DisposableList} {\n    const disposables: DisposableList = new DisposableList();\n\n    stream.getTracks().forEach(track => {\n      const receiver = receivers.filter(receive => receive.track === track)[0];\n\n      switch (track.kind) {\n        case 'video': {\n          if (encodedVideoStreamSink) {\n            if (FeatureEnablement.isRTCRtpScriptTransformSupported) {\n              const worker = new Worker(new URL('./WorkerTransformStream.ts', import.meta.url), {type: 'classic'});\n\n              worker.onmessage = event => {\n                if (encodedVideoStreamSink(track, event.data.chunk) === false) {\n                  worker.postMessage({forceInvalidFrame: true});\n                }\n              };\n\n              receiver.transform = new RTCRtpScriptTransform(worker, {\n                kind: track.kind,\n                codec: videoCodec\n              });\n              disposables.add(new Disposable(() => {\n                worker.terminate();\n              }));\n\n              break;\n            }\n\n            const encodedStreamTransformCallback : TransformerTransformCallback<RTCEncodedVideoFrame, RTCEncodedVideoFrame> = (chunk, controller) => {\n              if (encodedVideoStreamSink(track, chunk) === false) {\n                const buffer = invalidFrame(videoCodec, chunk.type);\n\n                if (buffer === undefined) {\n                  return;\n                }\n\n                chunk.data = buffer;\n              } else {\n                if (chunk.type === 'key') {\n                  chunk.data = surrogateVideoIFramePerCodec(videoCodec) || chunk.data;\n                } else {\n                  chunk.data = surrogateVideoPFramePerCodec(videoCodec) || chunk.data;\n                }\n              }\n\n              controller.enqueue(chunk);\n            };\n\n            const transformer = new TransformStream({transform: encodedStreamTransformCallback});\n            const receiverStreams = receiver.createEncodedStreams();\n            const source = receiverStreams.readable;\n            const sink = receiverStreams.writable;\n\n            source\n              .pipeThrough(transformer)\n              .pipeTo(sink);\n          }\n\n          break;\n        }\n\n        case 'audio':\n        default: {\n          if (encodedAudioStreamSink) {\n            if (FeatureEnablement.isRTCRtpScriptTransformSupported) {\n              const worker = new Worker(new URL('./WorkerTransformStream.ts', import.meta.url), {type: 'classic'});\n\n              worker.onmessage = event => {\n                if (encodedAudioStreamSink(track, event.data.chunk) === false) {\n                  worker.postMessage({forceInvalidFrame: true});\n                }\n              };\n\n              receiver.transform = new RTCRtpScriptTransform(worker, {\n                kind: track.kind,\n                codec: audioCodec\n              });\n\n              const mediaStream = new MediaStream();\n              const audioPumper = new Audio();\n\n              audioPumper.srcObject = mediaStream;\n              document.body.appendChild(audioPumper);\n\n              disposables.add(new Disposable(() => {\n                worker.terminate();\n                document.body.removeChild(audioPumper);\n              }));\n\n              break;\n            }\n\n            const encodedStreamTransformCallback : TransformerTransformCallback<RTCEncodedAudioFrame, RTCEncodedAudioFrame> = (chunk, controller) => {\n              if (encodedAudioStreamSink(track, chunk) === false) {\n                chunk.data = invalidFrame(videoCodec, '');\n              } else {\n                chunk.data = surrogateAudioSilentPerCodec(audioCodec) || chunk.data;\n              }\n\n              controller.enqueue(chunk);\n            };\n\n            const transformer = new TransformStream({transform: encodedStreamTransformCallback});\n            const receiverStreams = receiver.createEncodedStreams();\n            const source = receiverStreams.readable;\n            const sink = receiverStreams.writable;\n\n            source\n              .pipeThrough(transformer)\n              .pipeTo(sink);\n          }\n\n          break;\n        }\n      }\n    });\n\n    return {disposables};\n  }\n\n  static applyInsertableStreamTransformation(stream: MediaStream, videoStreamTransformCallback: IStreamTrackTransform<VideoFrame>, audioStreamTransformCallback: IStreamTrackTransform<AudioData>) : {transformedStream: MediaStream; disposables: DisposableList} {\n    const transformedStream = new MediaStream();\n    const disposables: DisposableList = new DisposableList();\n\n    stream.getTracks().forEach(track => {\n      switch (track.kind) {\n        case 'video': {\n          if (videoStreamTransformCallback) {\n            const insertableStreamTransformCallback: TransformerTransformCallback<VideoFrame, VideoFrame> = (chunk, controller) => {\n              videoStreamTransformCallback(track, chunk, controller);\n            };\n\n            const videoTrack = track as MediaStreamVideoTrack;\n            const transformer = new TransformStream({transform: insertableStreamTransformCallback});\n            const processor = new MediaStreamTrackProcessor({track: videoTrack});\n            const generator = new MediaStreamTrackGenerator({kind: videoTrack.kind});\n            const source = processor.readable;\n            const sink = generator.writable;\n\n            source\n              .pipeThrough(transformer)\n              .pipeTo(sink);\n\n            transformedStream.addTrack(generator);\n            disposables.add(new Disposable(() => {\n              transformedStream.removeTrack(generator);\n            }));\n          } else {\n            transformedStream.addTrack(track);\n          }\n\n          break;\n        }\n\n        case 'audio':\n        default: {\n          if (audioStreamTransformCallback) {\n            const insertableStreamTransformCallback: TransformerTransformCallback<AudioData, AudioData> = (chunk, controller) => {\n              audioStreamTransformCallback(track, chunk, controller);\n            };\n\n            const audioTrack = track as MediaStreamAudioTrack;\n            const transformer = new TransformStream({transform: insertableStreamTransformCallback});\n            const processor = new MediaStreamTrackProcessor({track: audioTrack});\n            const generator = new MediaStreamTrackGenerator({kind: audioTrack.kind});\n            const source = processor.readable;\n            const sink = generator.writable;\n\n            source\n              .pipeThrough(transformer)\n              .pipeTo(sink);\n\n            transformedStream.addTrack(generator);\n\n            const mediaStream = new MediaStream();\n            const audioPumper = new Audio();\n\n            mediaStream.addTrack(track);\n            audioPumper.srcObject = mediaStream;\n            document.body.appendChild(audioPumper);\n            disposables.add(new Disposable(() => {\n              transformedStream.removeTrack(generator);\n              document.body.removeChild(audioPumper);\n            }));\n          } else {\n            transformedStream.addTrack(track);\n          }\n\n          break;\n        }\n      }\n    });\n\n    return {\n      transformedStream,\n      disposables\n    };\n  }\n\n  constructor() {\n    throw new Error('InsertableStreams is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport IPeerConnection from '../../rtc/IPeerConnection';\nimport SDK from '../SDK';\nimport GarbageCollectorManager from '../../dom/GarbageCollectorManager';\nimport {IStream} from './IStream';\nimport {SetRemoteDescriptionStatus} from '../discovery/EndPoint';\nimport PeerConnectionService from '../../rtc/PeerConnectionService';\nimport Discovery from '../discovery/Discovery';\nimport FeatureEnablement from '../../environment/FeatureEnablement';\nimport ChannelState from '../channels/ChannelState';\nimport assertUnreachable from '../../lang/assertUnreachable';\nimport RtcConnectionMonitor from '../../rtc/RtcConnectionMonitor';\nimport Durations from '../../time/Duration';\nimport {ILogger} from '../../logger/LoggerInterface';\nimport LoggerFactory from '../../logger/LoggerFactory';\nimport ChannelContext from '../context/ChannelContext';\nimport RtcConfigurationManager from '../../rtc/RtcConfigurationManager';\nimport PeerConnectionContext from '../context/PeerConnectionContext';\nimport StreamTransformContext from '../context/StreamTransformContext';\nimport InsertableStreams from '../transformation/InsertableStreams';\nimport SdpParser from '../../rtc/SdpParser';\n\nconst iceCandidateAccumulationInterval = 100;\nconst defaultStreamSetupTimeout = 30000;\n\nexport default class RealTimeStream implements IStream {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('RealTimeStream');\n  private readonly _channelContext: ChannelContext;\n  private readonly _peerConnectionContext: PeerConnectionContext;\n  private readonly _streamTransformContext: StreamTransformContext;\n  private readonly _handleStreamFailure: () => Promise<void>;\n\n  constructor(channelContext, peerConnectionContext, streamTransformContext, handleStreamFailure: () => Promise<void>) {\n    this._channelContext = channelContext;\n    this._peerConnectionContext = peerConnectionContext;\n    this._streamTransformContext = streamTransformContext;\n    this._handleStreamFailure = handleStreamFailure;\n  }\n\n  start(uri, token, listenOnStreamSetup, playMediaStreamInVideoElement): Promise<void> {\n    const encodedInsertableStreams = typeof this._streamTransformContext.encodedVideoStreamSink === 'function' || typeof this._streamTransformContext.encodedAudioStreamSink === 'function';\n\n    return Promise.all([\n      Discovery.discoverClosestEndPointWithCaching(uri),\n      PeerConnectionService.createPeerConnectionOffer('recvonly', encodedInsertableStreams)\n        .then(({localOffer, peerConnection}) => {\n          this._peerConnectionContext.peerConnection.value = peerConnection;\n\n          return {\n            localOffer,\n            peerConnection\n          };\n        })\n    ])\n      .then(([endPoint, {localOffer, peerConnection}]) => {\n        this._channelContext.online.value = true;\n        this._channelContext.endPoint.value = endPoint;\n        this._logger.info('Connecting to [%s]', endPoint.toString());\n        this._logger.info('Local offer:\\n' + localOffer.sdp);\n\n        if (FeatureEnablement.clientOfferDisabled || !peerConnection.supportsSetConfiguration || !peerConnection.supportsGetConfiguration) {\n          peerConnection.close();\n          peerConnection.dispose();\n\n          if (SDK.forceGarbageCollectionOnRestart && !(FeatureEnablement.isMobile && SDK.skipGarbageCollectionOnMobileDevices)) {\n            GarbageCollectorManager.forceGarbageCollection();\n          }\n\n          peerConnection = null;\n          localOffer = null;\n          this._peerConnectionContext.peerConnection.value = peerConnection;\n        }\n\n        return endPoint.subscribe(token, localOffer, this._channelContext.failureCount.value);\n      })\n      .then(({status, stream, rtcConfiguration, setRemoteDescriptionResponse, createOfferDescriptionResponse, createAnswerDescriptionResponse, lag}) => {\n        this._channelContext.stream.value = stream;\n        this._channelContext.lag.value = lag;\n\n        this._channelContext.applySessionAndStreamPropertiesToVideoElement();\n\n        this._logger.debug(\n          '[%s] Subscribe completed [%s] [%j] [%j] [%j] [%j]',\n          this._channelContext.streamId,\n          status,\n          rtcConfiguration,\n          setRemoteDescriptionResponse,\n          createOfferDescriptionResponse,\n          createAnswerDescriptionResponse\n        );\n\n        this._channelContext.state.value = this._channelContext.mapSubscribeStatusToChannelStatus(status);\n\n        this._channelContext.applyStatus(status);\n\n        if (status !== 'ok') {\n          return;\n        }\n\n        return this.applyRtcConfiguration(this._peerConnectionContext.peerConnection.value, rtcConfiguration)\n          .then(peerConnection => {\n            let submitCandidatesTimeout;\n            let cancelDiscovery = false;\n            let discoveryCompleted = false;\n            const candidates: RTCIceCandidate[] = [];\n\n            if (!this._peerConnectionContext.peerConnection.value) {\n              this._peerConnectionContext.peerConnection.value = peerConnection;\n            }\n\n            peerConnection.onicecandidate = (e): void => {\n              if (this._channelContext.stream.value !== stream) {\n                return;\n              }\n\n              if (this._peerConnectionContext.peerConnection.value !== peerConnection) {\n                return;\n              }\n\n              if (cancelDiscovery) {\n                return;\n              }\n\n              if (!SDK.sendLocalCandidates.value) {\n                return;\n              }\n\n              if (e.candidate && e.candidate.candidate) {\n                candidates.push(e.candidate);\n              } else {\n                discoveryCompleted = true;\n              }\n\n              if (!submitCandidatesTimeout) {\n                submitCandidatesTimeout = setTimeout(() => {\n                  if (this._channelContext.stream.value !== stream) {\n                    return;\n                  }\n\n                  if (cancelDiscovery) {\n                    return;\n                  }\n\n                  const ignored = this._channelContext.endPoint.value.addIceCandidates(stream, candidates, discoveryCompleted)\n                    .then(({status, options}) => {\n                      if (status !== 'ok') {\n                        this._logger.warn('[%s] Failed to add ICE candidates with reason [%s]', this._channelContext.streamId, status);\n\n                        return;\n                      }\n\n                      if (options.includes('cancel')) {\n                        cancelDiscovery = true;\n                      }\n\n                      this._logger.info('[%s] Added ICE candidates with reason [%s] and options [%s]', this._channelContext.streamId, status, options);\n                    })\n                    .catch(e => {\n                      this._logger.error('[%s] Failed to add ICE candidates', this._channelContext.streamId, e);\n                    });\n                }, iceCandidateAccumulationInterval);\n              }\n            };\n\n            peerConnection.oniceconnectionstatechange = (): void => {\n              if (this._channelContext.stream.value !== stream) {\n                return;\n              }\n\n              if (this._peerConnectionContext.peerConnection.value !== peerConnection) {\n                return;\n              }\n\n              const retryCallback = (): void => {\n                // If we stop normally the peer connection is unregistered first.\n                // Thus anytime we see a closed peer connection that is still valid, it is an error.\n                this._channelContext.state.value = ChannelState.ConnectionError;\n\n                if (this._channelContext.videoElement.value) {\n                  this._channelContext.videoElement.value.pause();\n                  this._channelContext.videoElement.value.srcObject = null;\n                }\n\n                this._channelContext.playing.value = false;\n                this._channelContext.loading.value = true;\n\n                const ignored = this._handleStreamFailure()\n                  .catch(e => {\n                    this._logger.error(\n                      '[%s] Failed handling stream failure after peer connection stopped with state [%s]',\n                      this._channelContext.streamId,\n                      peerConnection.iceConnectionState,\n                      e\n                    );\n                  });\n              };\n\n              switch (peerConnection.iceConnectionState) {\n                case 'checking':\n                case 'completed':\n                case 'connected':\n                case 'new':\n                  return;\n\n                case 'disconnected':\n                case 'failed':\n                  if (navigator.onLine) {\n                    this._logger.info('[%s] ICE connection state changed to [%s], trying to reconnect', this._channelContext.streamId, peerConnection.iceConnectionState);\n                    this.reconnectPeerConnection(peerConnection, retryCallback);\n                  }\n\n                  return;\n                case 'closed':\n                  this._logger.info('[%s] ICE connection state changed to [%s], retrying to connect', this._channelContext.streamId, peerConnection.iceConnectionState);\n\n                  retryCallback();\n\n                  return;\n                default:\n                  assertUnreachable(peerConnection.iceConnectionState);\n              }\n            };\n\n            const mediaStreamPromise = new Promise<MediaStream>((resolve, reject) => {\n              if (!FeatureEnablement.onTrackDisabled) {\n                const timeoutId = setTimeout(() => reject(new Error('Stream setup timed out')), defaultStreamSetupTimeout);\n\n                peerConnection.ontrack = (e): void => {\n                  clearTimeout(timeoutId);\n                  resolve(e.streams[0]);\n                };\n\n                return;\n              }\n\n              const trackListener = (e): void => {\n                // eslint-disable-next-line @typescript-eslint/no-use-before-define\n                clearTimeout(timeoutId);\n                peerConnection.removeEventListener('track', trackListener);\n                peerConnection.removeEventListener('addstream', trackListener);\n\n                if (e.streams) {\n                  resolve(e.streams[0]);\n                } else {\n                  resolve(e.stream);\n                }\n              };\n\n              const timeoutId = setTimeout(() => {\n                peerConnection.removeEventListener('track', trackListener);\n                peerConnection.removeEventListener('addstream', trackListener);\n                reject(new Error('Stream setup timed out'));\n              }, defaultStreamSetupTimeout);\n\n              peerConnection.addEventListener('track', trackListener);\n              peerConnection.addEventListener('addstream', trackListener);\n\n              return;\n            });\n\n            return new Promise<void>(resolve => {\n              resolve();\n            }).then(() => {\n              if (!setRemoteDescriptionResponse) {\n                return;\n              }\n\n              this._logger.info('[%s] Set local SDP offer [%s]', this._channelContext.streamId, setRemoteDescriptionResponse.sessionDescription.sdp);\n\n              return peerConnection.setLocalDescription(setRemoteDescriptionResponse.sessionDescription)\n                .catch(e => {\n                  this._logger.info('[%s] Failed to set local description [%j] with message [%s]', this._channelContext.streamId, setRemoteDescriptionResponse.sessionDescription, e.message);\n\n                  throw e;\n                });\n            }).then(() => {\n              if (!createAnswerDescriptionResponse) {\n                return;\n              }\n\n              this._logger.info('[%s] Set remote SDP answer [%s]', this._channelContext.streamId, createAnswerDescriptionResponse.sessionDescription.sdp);\n\n              return peerConnection.setRemoteDescription(createAnswerDescriptionResponse.sessionDescription)\n                .catch(e => {\n                  this._logger.info('[%s] Failed to set remote description [%j] with message [%s]', this._channelContext.streamId, createAnswerDescriptionResponse.sessionDescription, e.message);\n\n                  throw e;\n                });\n            }).then(() => {\n              if (!createOfferDescriptionResponse) {\n                return;\n              }\n\n              this._logger.info('[%s] Set remote SDP offer [%s]', this._channelContext.streamId, createOfferDescriptionResponse.sessionDescription.sdp);\n\n              return peerConnection.setRemoteDescription(createOfferDescriptionResponse.sessionDescription)\n                .catch(e => {\n                  this._logger.info('[%s] Failed to set remote description [%j] with message [%s]', this._channelContext.streamId, createOfferDescriptionResponse.sessionDescription, e.message);\n\n                  throw e;\n                })\n                .then(() => {\n                  return peerConnection.createAnswer({\n                    offerToReceiveAudio: true,\n                    offerToReceiveVideo: true\n                  });\n                }).then(answer => {\n                  this._logger.info('[%s] Set local SDP answer [%j]', this._channelContext.streamId, answer);\n\n                  return this._channelContext.endPoint.value.setRemoteDescription(stream, answer);\n                }).then(({status, sessionDescription}) => {\n                  this._channelContext.state.value = this.mapSetRemoteDescriptionStatusToChannelStatus(status);\n\n                  if (status !== 'ok') {\n                    this._channelContext.playing.value = false;\n                    this._channelContext.standby.value = true;\n                    this._channelContext.stopped.value = false;\n\n                    return;\n                  }\n\n                  return peerConnection.setLocalDescription(sessionDescription)\n                    .catch(e => {\n                      this._logger.info('[%s] Failed to set local description [%j] with message [%s]', this._channelContext.streamId, sessionDescription, e.message);\n\n                      throw e;\n                    });\n                });\n            }).then(() => {\n              listenOnStreamSetup.success(this._channelContext.streamId);\n\n              return mediaStreamPromise;\n            }).then(mediaStream => {\n              if (this._streamTransformContext.hasEncodedInsertableStreams.value) {\n                const parsedRemoteDescription = new SdpParser(peerConnection.currentRemoteDescription.sdp);\n                const {disposables} = InsertableStreams.applyEncodedStreamTransformation(mediaStream, peerConnection.getReceivers(), this._streamTransformContext.encodedVideoStreamSink, this._streamTransformContext.encodedAudioStreamSink, parsedRemoteDescription.videoCodec, parsedRemoteDescription.audioCodec);\n\n                this._channelContext.disposables.add(disposables);\n              }\n\n              if (this._streamTransformContext.hasInsertableStreams.value) {\n                const {transformedStream, disposables} = InsertableStreams.applyInsertableStreamTransformation(mediaStream, this._streamTransformContext.videoStreamTransformCallback, this._streamTransformContext.audioStreamTransformCallback);\n\n                this._channelContext.disposables.add(disposables);\n                mediaStream = transformedStream;\n              }\n\n              this._peerConnectionContext.mediaStream.value = mediaStream;\n\n              const rtcConnectionMonitor = new RtcConnectionMonitor(peerConnection, mediaStream, this._channelContext.endPoint.value.roundTripTime / 4);\n\n              this._channelContext.disposables.add(rtcConnectionMonitor);\n\n              const ignored = rtcConnectionMonitor.rtcStatistic.subscribe(statistics => {\n                this._channelContext.rtcStatistics.value = statistics;\n\n                if (!this._channelContext.rtcVideoStatistic && !this._channelContext.rtcAudioStatistic) {\n                  this._channelContext.rtcAudioStatistic = statistics.audio;\n                  this._channelContext.rtcVideoStatistic = statistics.video;\n\n                  return;\n                }\n\n                let audioTrackFailed = false;\n                let videoTrackFailed = false;\n\n                if (statistics.audio) {\n                  if (this._channelContext.rtcAudioStatistic && this._channelContext.rtcAudioStatistic.timestamp !== statistics.audio.timestamp) {\n                    audioTrackFailed = this._channelContext.rtcAudioStatistic && this._channelContext.rtcAudioStatistic.bytesReceived === statistics.audio.bytesReceived;\n\n                    if (audioTrackFailed && navigator.onLine) {\n                      this._logger.info(\n                        '[%s] Audio track failed with last bytesReceived [%s] is equal to previous bytesReceived [%s] within [%s]',\n                        this._channelContext.streamId,\n                        statistics.audio.bytesReceived,\n                        this._channelContext.rtcAudioStatistic.bytesReceived,\n                        new Durations(statistics.audio.timestamp - this._channelContext.rtcAudioStatistic.timestamp).toIsoString()\n                      );\n                    }\n\n                    this._channelContext.rtcAudioStatistic = statistics.audio;\n                  }\n                }\n\n                if (statistics.video) {\n                  if (this._channelContext.rtcVideoStatistic && this._channelContext.rtcVideoStatistic.timestamp !== statistics.video.timestamp) {\n                    videoTrackFailed = this._channelContext.rtcVideoStatistic && this._channelContext.rtcVideoStatistic.bytesReceived === statistics.video.bytesReceived;\n\n                    if (videoTrackFailed && navigator.onLine) {\n                      this._logger.info(\n                        '[%s] Video track failed with last bytesReceived [%s] is equal to previous bytesReceived [%s] within [%s]',\n                        this._channelContext.streamId,\n                        statistics.video.bytesReceived,\n                        this._channelContext.rtcVideoStatistic.bytesReceived,\n                        new Durations(statistics.video.timestamp - this._channelContext.rtcVideoStatistic.timestamp).toIsoString()\n                      );\n                    }\n\n                    this._channelContext.rtcVideoStatistic = statistics.video;\n                  }\n                }\n\n                if ((videoTrackFailed || audioTrackFailed) && navigator.onLine) {\n                  const retryCallback = (): void => {\n                    this._channelContext.state.value = ChannelState.ConnectionError;\n\n                    if (this._channelContext.videoElement.value) {\n                      this._channelContext.videoElement.value.pause();\n                      this._channelContext.videoElement.value.srcObject = null;\n                    }\n\n                    this._channelContext.playing.value = false;\n                    this._channelContext.loading.value = true;\n\n                    rtcConnectionMonitor.dispose();\n\n                    const ignored = this._handleStreamFailure()\n                      .catch(e => {\n                        this._logger.error(\n                          '[%s] Failed handling stream failure after track stopped with state [%s]',\n                          this._channelContext.streamId,\n                          peerConnection.iceConnectionState,\n                          e\n                        );\n                      });\n                  };\n\n                  this.reconnectPeerConnection(peerConnection, retryCallback);\n                } else {\n                  this._peerConnectionContext.peerConnectionReconnectAttempts = 0;\n                }\n              });\n\n              if (!SDK.automaticallyPlayMediaStream) {\n                this._channelContext.autoMuted.value = false;\n                this._channelContext.autoPaused.value = true;\n                this._channelContext.loading.value = false;\n                this._channelContext.playing.value = false;\n                this._channelContext.state.value = ChannelState.Paused;\n\n                return;\n              }\n\n              return playMediaStreamInVideoElement(mediaStream);\n            });\n          });\n      });\n  }\n\n  private async applyRtcConfiguration(\n    optionalPeerConnection: IPeerConnection | null,\n    rtcConfiguration: RTCConfiguration): Promise<IPeerConnection> {\n    if (!optionalPeerConnection) {\n      rtcConfiguration = RtcConfigurationManager.truncateIceServers(rtcConfiguration);\n\n      return SDK.peerConnectionFactory.value.createPeerConnection(rtcConfiguration);\n    }\n\n    const newRtcConfiguration = {\n      ...optionalPeerConnection.getConfiguration(),\n      ...rtcConfiguration\n    };\n\n    optionalPeerConnection.setConfiguration(newRtcConfiguration);\n\n    return optionalPeerConnection;\n  }\n\n  private reconnectPeerConnection(peerConnection: IPeerConnection, retryCallback: () => void): void {\n    if (peerConnection.iceConnectionState === 'closed') {\n      return;\n    }\n\n    this._channelContext.state.value = ChannelState.Reconnecting;\n\n    if (this._peerConnectionContext.peerConnectionReconnectAttempts < SDK.maximalNumberOfPeerConnectionReconnectAttempts || !SDK.automaticallyReconnectPeerConnection) {\n      this._peerConnectionContext.peerConnectionReconnectAttempts++;\n\n      const isClientOfferFlow = peerConnection.currentLocalDescription?.type === 'offer';\n\n      if (FeatureEnablement.clientOfferDisabled ||\n        !peerConnection.supportsSetConfiguration ||\n        !peerConnection.supportsGetConfiguration ||\n        !isClientOfferFlow\n      ) {\n        return;\n      }\n\n      this._logger.info('Reconnecting peer connection by restarting ICE');\n\n      const currentLocalDescription = peerConnection.currentLocalDescription;\n      const ignored = peerConnection.createOffer({iceRestart: true}).then(offer => {\n        return peerConnection.setLocalDescription(offer).then(() => {\n          return peerConnection.setLocalDescription(currentLocalDescription);\n        });\n      })\n        .catch(e => {\n          this._logger.error('Failed to reconnect peer connection', e);\n          this._peerConnectionContext.peerConnectionReconnectAttempts = 0;\n          retryCallback();\n        });\n\n      return;\n    }\n\n    this._logger.info('Failed to reconnect peer connection after [%s] attempts, performing full recovery', this._peerConnectionContext.peerConnectionReconnectAttempts);\n    this._peerConnectionContext.peerConnectionReconnectAttempts = 0;\n    retryCallback();\n  }\n\n  private mapSetRemoteDescriptionStatusToChannelStatus(status: SetRemoteDescriptionStatus): ChannelState {\n    switch (status) {\n      case 'ok':\n        return ChannelState.Starting;\n      case 'unauthorized':\n        return ChannelState.Unauthorized;\n      case 'not-found':\n      case 'capacity':\n      case 'rate-limited':\n      case 'timeout':\n        return ChannelState.Recovering;\n      case 'failed':\n        return ChannelState.Error;\n      default:\n        assertUnreachable(status);\n    }\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport {IStream} from './IStream';\nimport EdgeAuthParser from '../../edgeAuth/EdgeAuthParser';\nimport ChunkedStream from './ChunkedStream';\nimport RealTimeStream from './RealTimeStream';\nimport {ILogger} from '../../logger/LoggerInterface';\nimport LoggerFactory from '../../logger/LoggerFactory';\n\nexport default class StreamFactory {\n  private static _logger: ILogger = LoggerFactory.getLogger('Streaming');\n\n  static create(token: string, channelContext, peerConnectionContext, streamTransformContext, handleStreamFailure: () => Promise<void>): IStream {\n    const tokenCapabilities = EdgeAuthParser.parseToken(token).capabilities;\n\n    if (tokenCapabilities.includes('streaming') || tokenCapabilities.includes('on-demand')) {\n      return new ChunkedStream(channelContext, handleStreamFailure);\n    }\n\n    return new RealTimeStream(channelContext, peerConnectionContext, streamTransformContext, handleStreamFailure);\n  }\n\n  constructor() {\n    throw new Error('StreamFactory is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport LoggerFactory from '../../logger/LoggerFactory';\nimport IDisposable from '../../lang/IDisposable';\nimport ReadOnlySubject from '../../rx/ReadOnlySubject';\nimport Dimension from '../../video/Dimension';\nimport ExponentialBackoff from '../../time/ExponentialBackoff';\nimport EndPoint, {IStream} from '../discovery/EndPoint';\nimport SDK from '../SDK';\nimport GarbageCollectorManager from '../../dom/GarbageCollectorManager';\nimport IPeerConnection from '../../rtc/IPeerConnection';\nimport ChannelState from './ChannelState';\nimport assertUnreachable from '../../lang/assertUnreachable';\nimport Disposable from '../../lang/Disposable';\nimport {ILogger} from '../../logger/LoggerInterface';\nimport VideoTelemetry from '../../video/VideoTelemetry';\nimport SessionTelemetry from '../../video/SessionTelemetry';\nimport {IRtcMonitorStatistic} from '../../rtc/RtcConnectionMonitor';\nimport {BitrateMode, BitrateState} from '../api/SetTemporaryMaximalBitrate';\nimport EdgeAuthParser from '../../edgeAuth/EdgeAuthParser';\nimport {EncodedEdgeToken} from '../../edgeAuth/EncodedEdgeToken';\nimport {BitsPerSecond, Millisecond} from '../../units/Units';\nimport TokenContext from '../context/TokenContext';\nimport ChannelContext, {ChannelContextOptions} from '../context/ChannelContext';\nimport EncodedStreamSink, {IEncodedStreamSink} from '../transformation/EncodedStreamSink';\nimport StreamTrackTransform, {IStreamTrackTransform} from '../transformation/StreamTrackTransform';\nimport StreamTransformContext, {StreamTransformContextOptions} from '../context/StreamTransformContext';\nimport PeerConnectionContext from '../context/PeerConnectionContext';\nimport StateContext from '../context/StateContext';\nimport StreamFactory from '../streaming/StreamFactory';\nimport Discovery from '../discovery/Discovery';\nimport DiscoveryUri from '../discovery/DiscoveryUri';\nimport MetricsFactory from '../../metrics/MetricsFactory';\nimport MetricsService from '../../metrics/MetricsService';\nimport FeatureEnablement from '../../environment/FeatureEnablement';\n\nconst defaultStreamTerminationReason = 'client:termination';\nconst failureCountCleanUpIntervalInMilliseconds = 3000;\nconst standbyPollingIntervalInMilliseconds = 15000;\n\nexport type ChannelOptions = {\n  targetLag?: Millisecond;\n  videoStreamTransformCallback?: IStreamTrackTransform<VideoFrame>;\n  audioStreamTransformCallback?: IStreamTrackTransform<AudioData>;\n  encodedVideoStreamSink?: IEncodedStreamSink<RTCEncodedVideoFrame>;\n  encodedAudioStreamSink?: IEncodedStreamSink<RTCEncodedAudioFrame>;\n};\n\nexport default class Channel implements IDisposable {\n  private readonly _logger: ILogger = LoggerFactory.getLogger('Channel');\n  private readonly _tokenContext: TokenContext;\n  private readonly _channelContext: ChannelContext;\n  private readonly _peerConnectionContext: PeerConnectionContext;\n  private readonly _streamTransformContext: StreamTransformContext;\n  private readonly _stateContext: StateContext;\n  private readonly _exponentialBackoff: ExponentialBackoff;\n  private readonly _channelStartTime: number;\n  private readonly _readOnlyVideoElement: ReadOnlySubject<HTMLVideoElement>;\n  private readonly _readOnlyToken: ReadOnlySubject<EncodedEdgeToken>;\n  private readonly _readOnlyPeerConnection: ReadOnlySubject<IPeerConnection>;\n  private readonly _readOnlyState: ReadOnlySubject<ChannelState>;\n  private readonly _readOnlyAutoMuted: ReadOnlySubject<boolean>;\n  private readonly _readOnlyAutoPaused: ReadOnlySubject<boolean>;\n  private readonly _readOnlyTokenExpiring: ReadOnlySubject<boolean>;\n  private readonly _readOnlyAuthorized: ReadOnlySubject<boolean>;\n  private readonly _readOnlyOnline: ReadOnlySubject<boolean>;\n  private readonly _readOnlyLoading: ReadOnlySubject<boolean>;\n  private readonly _readOnlyPlaying: ReadOnlySubject<boolean>;\n  private readonly _readOnlyStandby: ReadOnlySubject<boolean>;\n  private readonly _readOnlyStopped: ReadOnlySubject<boolean>;\n  private readonly _readOnlyTargetLag: ReadOnlySubject<Millisecond>;\n  private readonly _readOnlyLag: ReadOnlySubject<Millisecond>;\n  private readonly _readOnlyBitrateLimit: ReadOnlySubject<BitsPerSecond>;\n  private readonly _readOnlyResolution: ReadOnlySubject<Dimension>;\n  private readonly _readOnlyFailureCount: ReadOnlySubject<number>;\n  private readonly _readOnlyEndPoint: ReadOnlySubject<EndPoint>;\n  private readonly _readOnlyStream: ReadOnlySubject<IStream>;\n  private readonly _readOnlyRtcStatistics: ReadOnlySubject<IRtcMonitorStatistic>;\n  private readonly _readOnlyMediaStream: ReadOnlySubject<MediaStream>;\n\n  private _metricsService: MetricsService;\n  private readonly _sessionTelemetry: SessionTelemetry;\n  private readonly _videoMetaDataChangedHandler: () => void;\n\n  constructor(videoElement: HTMLVideoElement, token: EncodedEdgeToken, options?: ChannelOptions) {\n    const edgeToken = EdgeAuthParser.parseToken(token);\n    const channelContextOptions: ChannelContextOptions = {targetLag: options?.targetLag};\n    const streamTransformContextOptions: StreamTransformContextOptions = {\n      hasInsertableStreams: edgeToken.capabilities.includes('insertable-streams'),\n      hasEncodedInsertableStreams: edgeToken.capabilities.includes('encoded-insertable-streams'),\n      videoStreamTransformCallback: options?.videoStreamTransformCallback,\n      audioStreamTransformCallback: options?.audioStreamTransformCallback,\n      encodedVideoStreamSink: options?.encodedVideoStreamSink,\n      encodedAudioStreamSink: options?.encodedAudioStreamSink\n    };\n\n    this._tokenContext = new TokenContext(token);\n    this._channelContext = new ChannelContext(channelContextOptions);\n    this._peerConnectionContext = new PeerConnectionContext();\n    this._streamTransformContext = new StreamTransformContext(streamTransformContextOptions);\n    this._stateContext = new StateContext();\n    this._exponentialBackoff = new ExponentialBackoff();\n    this._channelStartTime = Date.now();\n    this._readOnlyVideoElement = new ReadOnlySubject<HTMLVideoElement>(this._channelContext.videoElement);\n    this._readOnlyToken = new ReadOnlySubject<string>(this._tokenContext.token);\n    this._readOnlyPeerConnection = new ReadOnlySubject<IPeerConnection>(this._peerConnectionContext.peerConnection);\n    this._readOnlyState = new ReadOnlySubject<ChannelState>(this._channelContext.state);\n    this._readOnlyAutoMuted = new ReadOnlySubject<boolean>(this._channelContext.autoMuted);\n    this._readOnlyAutoPaused = new ReadOnlySubject<boolean>(this._channelContext.autoPaused);\n    this._readOnlyTokenExpiring = new ReadOnlySubject<boolean>(this._tokenContext.tokenExpiring);\n    this._readOnlyAuthorized = new ReadOnlySubject<boolean>(this._channelContext.authorized);\n    this._readOnlyOnline = new ReadOnlySubject<boolean>(this._channelContext.online);\n    this._readOnlyLoading = new ReadOnlySubject<boolean>(this._channelContext.loading);\n    this._readOnlyPlaying = new ReadOnlySubject<boolean>(this._channelContext.playing);\n    this._readOnlyStandby = new ReadOnlySubject<boolean>(this._channelContext.standby);\n    this._readOnlyStopped = new ReadOnlySubject<boolean>(this._channelContext.stopped);\n    this._readOnlyTargetLag = new ReadOnlySubject<number>(this._channelContext.targetLag);\n    this._readOnlyLag = new ReadOnlySubject<number>(this._channelContext.lag);\n    this._readOnlyBitrateLimit = new ReadOnlySubject<number>(this._channelContext.bitrateLimit);\n    this._readOnlyResolution = new ReadOnlySubject<Dimension>(this._channelContext.resolution);\n    this._readOnlyFailureCount = new ReadOnlySubject<number>(this._channelContext.failureCount);\n    this._readOnlyEndPoint = new ReadOnlySubject<EndPoint>(this._channelContext.endPoint);\n    this._readOnlyStream = new ReadOnlySubject<IStream>(this._channelContext.stream);\n    this._readOnlyRtcStatistics = new ReadOnlySubject<IRtcMonitorStatistic>(this._channelContext.rtcStatistics);\n    this._readOnlyMediaStream = new ReadOnlySubject<MediaStream>(this._peerConnectionContext.mediaStream);\n\n    const discoveryUri = (edgeToken.uri || SDK.discoveryUri.value).toString();\n\n    SDK.tenancy.value = edgeToken.tenancy || SDK.tenancy.value;\n    DiscoveryUri.uri.value = discoveryUri;\n    this._metricsService = MetricsFactory.getMetricsService(discoveryUri);\n    this._sessionTelemetry = new SessionTelemetry(SDK.pageLoadTime, this._metricsService);\n    this._channelContext.channelDisposables.add(this._sessionTelemetry);\n    this._videoMetaDataChangedHandler = this.handleVideoMetaDataChanged.bind(this);\n    this.videoElement = videoElement;\n\n    this._channelContext.channelDisposables.add(\n      this._channelContext.videoElement.subscribe(videoElement => {\n        this._channelContext.rendererDisposables.dispose();\n\n        if (!videoElement) {\n          return;\n        }\n\n        this._channelContext.rendererDisposables.add(this._channelContext.stream.subscribe(stream => {\n          if (this._channelContext.videoTelemetry) {\n            this._channelContext.videoTelemetry.dispose();\n          }\n\n          if (!stream) {\n            return;\n          }\n\n          if (!this.videoElement) {\n            return;\n          }\n\n          if (this.videoElement.dataset) {\n            this.videoElement.dataset.sessionId = SDK.clientSessionId;\n            this.videoElement.dataset.streamId = this.streamId;\n          }\n\n          this._channelContext.videoTelemetry = new VideoTelemetry(this.streamId, SDK.pageLoadTime, this._channelStartTime, this._metricsService);\n          this._channelContext.videoTelemetry.setupListenerForTimeToFirstTime(this.videoElement);\n          this._channelContext.videoTelemetry.setupListenerForRebuffering(this.videoElement);\n\n          if (this._channelContext.state.value === ChannelState.Stopped) {\n            const ignored = this.restartAfterStop();\n          }\n        }));\n\n        this._channelContext.channelDisposables.add(this._channelContext.rendererDisposables);\n      }));\n    this._channelContext.channelDisposables.add(\n      this._channelContext.state.subscribe(state => {\n        if (this._channelContext.clearFailureCountTimeout) {\n          clearTimeout(this._channelContext.clearFailureCountTimeout);\n        }\n\n        if (!this._channelContext.failureCount.value) {\n          return;\n        }\n\n        if (state !== ChannelState.Playing) {\n          return;\n        }\n\n        this._channelContext.clearFailureCountTimeout = window.setTimeout(() => {\n          this._channelContext.failureCount.value = 0;\n        }, failureCountCleanUpIntervalInMilliseconds);\n      }));\n    this._channelContext.channelDisposables.add(\n      this._channelContext.resolution.subscribe(resolution => {\n        if (this._channelContext.videoTelemetry) {\n          this._channelContext.videoTelemetry.onVideoResolutionChanges(resolution.toString());\n        }\n      }));\n    this._channelContext.channelDisposables.add(\n      this._channelContext.bitrateLimit.subscribe(bitrateLimit => {\n        if (bitrateLimit && this._channelContext.endPoint.value && this._channelContext.stream.value) {\n          const elapsedInMilliseconds = Date.now() - this._channelContext.channelInitialization.getTime();\n          const ignored = this._channelContext.endPoint.value.limitBitrate(\n            this._channelContext.stream.value,\n            elapsedInMilliseconds,\n            bitrateLimit,\n            BitrateState.Keep,\n            BitrateMode.Normal\n          )\n            .catch(e => {\n              this._logger.error('Error while setting limit bitrate', e);\n            });\n        }\n      })\n    );\n\n    const destroyStreamOnUnmount = () => {\n      if (this._channelContext.stream.value && this._channelContext.endPoint.value) {\n        const ignored = this._channelContext.endPoint.value.destroyStreamOnUnmount(this._channelContext.stream.value, 'client:termination-on-window-unload');\n      }\n    };\n\n    window.addEventListener('beforeunload', destroyStreamOnUnmount);\n\n    this._channelContext.channelDisposables.add(new Disposable(() => {\n      window.removeEventListener('beforeunload', destroyStreamOnUnmount);\n    }));\n\n    this.start();\n  }\n\n  get videoElement(): HTMLVideoElement {\n    return this._channelContext.videoElement.value;\n  }\n\n  set videoElement(videoElement: HTMLVideoElement) {\n    if (this._channelContext.videoElement.value) {\n      this._channelContext.videoElement.value.removeEventListener('loadeddata', this._videoMetaDataChangedHandler);\n      this._channelContext.videoElement.value.removeEventListener('loadedmetadata', this._videoMetaDataChangedHandler);\n      this._channelContext.videoElement.value.removeEventListener('resize', this._videoMetaDataChangedHandler);\n\n      if (this._channelContext.videoElement.value.dataset) {\n        this._channelContext.videoElement.value.dataset.sessionId = '';\n        this._channelContext.videoElement.value.dataset.streamId = '';\n      }\n\n      this._channelContext.rendererDisposables.dispose();\n\n      this._channelContext.videoElement.value.pause();\n      this._channelContext.videoElement.value.srcObject = null;\n    }\n\n    this._channelContext.autoMuted.value = false;\n    this._channelContext.autoPaused.value = false;\n    this._channelContext.loading.value = false;\n    this._channelContext.playing.value = false;\n    this._channelContext.state.value = ChannelState.Stopped;\n\n    this._channelContext.videoElement.value = videoElement;\n\n    if (this._channelContext.videoElement.value) {\n      this._channelContext.videoElement.value.addEventListener('loadeddata', this._videoMetaDataChangedHandler);\n      this._channelContext.videoElement.value.addEventListener('loadedmetadata', this._videoMetaDataChangedHandler);\n      this._channelContext.videoElement.value.addEventListener('resize', this._videoMetaDataChangedHandler);\n    }\n  }\n\n  private handleVideoMetaDataChanged(): void {\n    const videoElement = this._channelContext.videoElement.value;\n\n    if (videoElement) {\n      if (this.resolution.value.width !== videoElement.videoWidth || this.resolution.value.height !== videoElement.videoHeight) {\n        this._channelContext.resolution.value = new Dimension(videoElement.videoWidth, videoElement.videoHeight);\n      }\n    } else {\n      this._channelContext.resolution.value = Dimension.empty;\n    }\n  }\n\n  get token(): EncodedEdgeToken {\n    return this._tokenContext.token.value;\n  }\n\n  set token(token: EncodedEdgeToken) {\n    this._channelContext.disposables.dispose();\n\n    this._tokenContext.token.value = token;\n    this._tokenContext.tokenExpiring.value = false;\n\n    const edgeToken = EdgeAuthParser.parseToken(this._tokenContext.token.value);\n    const discoveryUri = (edgeToken.uri || SDK.discoveryUri.value).toString();\n\n    SDK.tenancy.value = edgeToken.tenancy || SDK.tenancy.value;\n    DiscoveryUri.uri.value = discoveryUri;\n\n    this._metricsService = MetricsFactory.getMetricsService(discoveryUri);\n\n    this._streamTransformContext.hasInsertableStreams.value = edgeToken.capabilities.includes('insertable-streams');\n    this._streamTransformContext.hasEncodedInsertableStreams.value = edgeToken.capabilities.includes('encoded-insertable-streams');\n\n    this.start();\n  }\n\n  get peerConnection(): ReadOnlySubject<IPeerConnection> {\n    return this._readOnlyPeerConnection;\n  }\n\n  get state(): ReadOnlySubject<ChannelState> {\n    return this._readOnlyState;\n  }\n\n  get autoMuted(): ReadOnlySubject<boolean> {\n    return this._readOnlyAutoMuted;\n  }\n\n  get autoPaused(): ReadOnlySubject<boolean> {\n    return this._readOnlyAutoPaused;\n  }\n\n  get tokenExpiring(): ReadOnlySubject<boolean> {\n    return this._readOnlyTokenExpiring;\n  }\n\n  get authorized(): ReadOnlySubject<boolean> {\n    return this._readOnlyAuthorized;\n  }\n\n  get online(): ReadOnlySubject<boolean> {\n    return this._readOnlyOnline;\n  }\n\n  get loading(): ReadOnlySubject<boolean> {\n    return this._readOnlyLoading;\n  }\n\n  get playing(): ReadOnlySubject<boolean> {\n    return this._readOnlyPlaying;\n  }\n\n  get standby(): ReadOnlySubject<boolean> {\n    return this._readOnlyStandby;\n  }\n\n  get stopped(): ReadOnlySubject<boolean> {\n    return this._readOnlyStopped;\n  }\n\n  get targetLag(): ReadOnlySubject<Millisecond> {\n    return this._readOnlyTargetLag;\n  }\n\n  get lag(): ReadOnlySubject<Millisecond> {\n    return this._readOnlyLag;\n  }\n\n  get bitrateLimit(): number {\n    return this._readOnlyBitrateLimit.value;\n  }\n\n  get resolution(): ReadOnlySubject<Dimension> {\n    return this._readOnlyResolution;\n  }\n\n  get failureCount(): ReadOnlySubject<number> {\n    return this._readOnlyFailureCount;\n  }\n\n  get endPoint(): ReadOnlySubject<EndPoint> {\n    return this._readOnlyEndPoint;\n  }\n\n  get stream(): ReadOnlySubject<IStream> {\n    return this._readOnlyStream;\n  }\n\n  get streamId(): string {\n    return this._channelContext.streamId;\n  }\n\n  get rtcStatistics(): ReadOnlySubject<IRtcMonitorStatistic> {\n    return this._readOnlyRtcStatistics;\n  }\n\n  get mediaStream(): ReadOnlySubject<MediaStream> {\n    return this._readOnlyMediaStream;\n  }\n\n  setBitrateLimit(bitrateLimit: BitsPerSecond): void {\n    this._channelContext.bitrateLimit.value = bitrateLimit;\n  }\n\n  clearBitrateLimit(): void {\n    if (this._channelContext.bitrateLimit.value && this._channelContext.endPoint.value && this._channelContext.stream.value) {\n      const elapsedInMilliseconds = Date.now() - this._channelContext.channelInitialization.getTime();\n      const bitrateInBitsPerSecond = 0;\n      const ignored = this._channelContext.endPoint.value.limitBitrate(\n        this._channelContext.stream.value,\n        elapsedInMilliseconds,\n        bitrateInBitsPerSecond,\n        BitrateState.Keep,\n        BitrateMode.Reset\n      )\n        .then(({status}) => {\n          if (status === 'ok') {\n            this._channelContext.bitrateLimit.value = 0;\n          }\n        })\n        .catch(e => {\n          this._logger.error('Error while setting limit bitrate', e);\n        });\n    }\n  }\n\n  updateTargetLag(lag: Millisecond): void {\n    this._channelContext.targetLag.value = lag;\n  }\n\n  async stop(reason: string): Promise<void> {\n    return new Promise(resolve => {\n      if (!this._stateContext.isStarting.value) {\n        this.processStop(reason);\n\n        resolve();\n\n        return;\n      }\n\n      this._channelContext.rendererDisposables.add(this._stateContext.isStarting.subscribe(isStarting => {\n        if (!isStarting) {\n          this.processStop(reason);\n          resolve();\n        }\n      }));\n    });\n  }\n\n  private processStop(reason: string): void {\n    if (this._channelContext.videoElement.value) {\n      this._channelContext.videoElement.value.pause();\n      this._channelContext.videoElement.value.srcObject = null;\n    }\n\n    this._channelContext.rendererDisposables.dispose();\n\n    this.cleanUpResources(reason);\n\n    this._channelContext.state.value = ChannelState.Stopped;\n  }\n\n  async resume(): Promise<void> {\n    if (this._peerConnectionContext.mediaStream.value) {\n      this._channelContext.autoPaused.value = false;\n\n      return this.playMediaStreamInVideoElement(this._peerConnectionContext.mediaStream.value);\n    }\n  }\n\n  mute(): void {\n    const videoElement = this._channelContext.videoElement.value;\n\n    if (videoElement) {\n      videoElement.muted = true;\n    }\n  }\n\n  unmute(): void {\n    const videoElement = this._channelContext.videoElement.value;\n\n    if (videoElement) {\n      videoElement.muted = false;\n      this._channelContext.autoMuted.value = false;\n    }\n  }\n\n  async dispose(): Promise<void> {\n    return this.stop('client:channel-dispose').then(() => {\n      this._channelContext.channelDisposables.dispose();\n      this._stateContext.isDisposed = true;\n    });\n  }\n\n  getUri(token: EncodedEdgeToken): URL {\n    const url = EdgeAuthParser.parseToken(token).uri;\n\n    if (url) {\n      return url;\n    }\n\n    this._logger.info('Fall back to the default discover URI [%s]', SDK.discoveryUri.value);\n\n    return new URL(SDK.discoveryUri.value);\n  }\n\n  async start(): Promise<void> {\n    if (this._stateContext.isDisposed) {\n      throw new Error('Channel was already disposed');\n    }\n\n    if (this._stateContext.isStarting.value) {\n      this._logger.info('Channel is already starting, skipping start');\n\n      return;\n    }\n\n    this._stateContext.isStarting.value = true;\n\n    return this.processStart();\n  }\n\n  private async processStart(): Promise<void> {\n    const token: EncodedEdgeToken = this._tokenContext.token.value;\n    const listenOnStreamSetup = this._sessionTelemetry.listenOnStreamSetup();\n\n    if (!EdgeAuthParser.isEncodedEdgeTokenValid(token)) {\n      this._logger.error('Failed to parse token [%s]', token);\n      this._channelContext.state.value = ChannelState.Unauthorized;\n      this._channelContext.authorized.value = false;\n      this._stateContext.isStarting.value = false;\n\n      return;\n    }\n\n    if (this._streamTransformContext.videoStreamTransformCallback) {\n      const {valid, validationResult} = StreamTrackTransform.validateMediaStreamTrackTransform('video', this._streamTransformContext.videoStreamTransformCallback);\n\n      if (!valid) {\n        this._logger.error(validationResult);\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    }\n\n    if (this._streamTransformContext.audioStreamTransformCallback) {\n      const {valid, validationResult} = StreamTrackTransform.validateMediaStreamTrackTransform('audio', this._streamTransformContext.audioStreamTransformCallback);\n\n      if (!valid) {\n        this._logger.error(validationResult);\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    }\n\n    if (this._streamTransformContext.encodedVideoStreamSink) {\n      const {valid, validationResult} = EncodedStreamSink.validateEncodedStreamSink('video', this._streamTransformContext.encodedVideoStreamSink);\n\n      if (!valid) {\n        this._logger.error(validationResult);\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    }\n\n    if (this._streamTransformContext.encodedAudioStreamSink) {\n      const {valid, validationResult} = EncodedStreamSink.validateEncodedStreamSink('audio', this._streamTransformContext.encodedAudioStreamSink);\n\n      if (!valid) {\n        this._logger.error(validationResult);\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    }\n\n    if (this._streamTransformContext.hasInsertableStreams.value && this._streamTransformContext.hasEncodedInsertableStreams.value) {\n      this._logger.error('Both insertable-streams and encoded-insertable-streams are enabled, only use one or the other');\n      this._channelContext.state.value = ChannelState.ConfigurationError;\n      this._channelContext.authorized.value = false;\n      this._stateContext.isStarting.value = false;\n\n      return;\n    }\n\n    const hasTransformStreamCallback = typeof this._streamTransformContext.videoStreamTransformCallback === 'function' || typeof this._streamTransformContext.audioStreamTransformCallback === 'function';\n    const hasEncodedStreamSink = typeof this._streamTransformContext.encodedVideoStreamSink === 'function' || typeof this._streamTransformContext.encodedAudioStreamSink === 'function';\n\n    if (hasTransformStreamCallback && hasEncodedStreamSink) {\n      this._logger.error('Both Media Stream Track transform callback and encodedInsertableStreams sink function found, only use one type or the other');\n      this._channelContext.state.value = ChannelState.ConfigurationError;\n      this._channelContext.authorized.value = false;\n      this._stateContext.isStarting.value = false;\n\n      return;\n    }\n\n    if (this._streamTransformContext.hasInsertableStreams.value) {\n      if (!FeatureEnablement.isInsertableStreamsSupported) {\n        this._logger.error('Browser does not support Media Stream Track API');\n        this._channelContext.state.value = ChannelState.UnsupportedFeature;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n\n      if (!hasTransformStreamCallback) {\n        this._logger.error('CreateChannelOptions transform callback function is missing; however, insertable-streams is enabled');\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    } else {\n      if (hasTransformStreamCallback) {\n        this._logger.error(`CreateChannelOptions transform callback function found; however, insertable-streams is not enabled`);\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    }\n\n    if (this._streamTransformContext.hasEncodedInsertableStreams.value) {\n      if (!(FeatureEnablement.isEncodedInsertableStreamsSupported || FeatureEnablement.isRTCRtpScriptTransformSupported)) {\n        this._logger.error('Browser does not support encodedInsertableStreams API');\n        this._channelContext.state.value = ChannelState.UnsupportedFeature;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n\n      if (!hasEncodedStreamSink) {\n        this._logger.error('CreateChannelOptions transform sink function is missing; however, encoded-insertable-streams is enabled');\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    } else {\n      if (hasEncodedStreamSink) {\n        this._logger.error(`CreateChannelOptions transform sink function found; however, encoded-insertable-streams is not enabled`);\n        this._channelContext.state.value = ChannelState.ConfigurationError;\n        this._channelContext.authorized.value = false;\n        this._stateContext.isStarting.value = false;\n\n        return;\n      }\n    }\n\n    this.cleanUpResources('client:start');\n    this._channelContext.state.value = ChannelState.Starting;\n    this._channelContext.loading.value = true;\n\n    const uri = this.getUri(token);\n\n    this._channelContext.disposables.add(\n      this._channelContext.state.subscribe(state => {\n        if (state === ChannelState.Error || state === ChannelState.Recovering) {\n          Discovery.clearCachedClosestEndpoint(uri);\n        }\n      })\n    );\n\n    const handleStreamFailureCallback: () => Promise<void> = () => new Promise((resolve): void => {\n      // Need to set isStarting to false and call handleStreamFailure if stream monitors found an issue\n      this._stateContext.isStarting.value = false;\n\n      return resolve(this.handleStreamFailure());\n    });\n    const streamPlayer = StreamFactory.create(token, this._channelContext, this._peerConnectionContext, this._streamTransformContext, handleStreamFailureCallback);\n\n    if (!streamPlayer) {\n      this._stateContext.isStarting.value = false;\n\n      return;\n    }\n\n    return streamPlayer.start(\n      uri,\n      token,\n      listenOnStreamSetup,\n      this.playMediaStreamInVideoElement.bind(this))\n      .then(() => {\n        this._channelContext.loading.value = false;\n      })\n      .catch(e => {\n        listenOnStreamSetup.fail();\n\n        this._channelContext.failureCount.value++;\n\n        this._channelContext.online.value = false;\n\n        this.cleanUpResources('client:cleanup-after-failed-setup');\n\n        this._channelContext.state.value = ChannelState.ClientStartError;\n\n        this._logger.error('Failed to start channel', e);\n      })\n      .finally(() => {\n        this._stateContext.isStarting.value = false;\n\n        if (this._channelContext.state.value === ChannelState.Playing || !SDK.automaticRetryOnFailure) {\n          return;\n        }\n\n        const timeoutId = setTimeout(() => {\n          const ignored = this.handleStreamFailure()\n            .catch(e => {\n              this._logger.error('Failed handling stream failure', e);\n            });\n        }, this.getRetryInterval());\n\n        this._channelContext.disposables.add(new Disposable(() => {\n          clearTimeout(timeoutId);\n        }));\n      });\n  }\n\n  private async restartAfterStop(): Promise<void> {\n    if (this._stateContext.isDisposed) {\n      throw new Error('Channel was already disposed');\n    }\n\n    if (this._peerConnectionContext.mediaStream.value) {\n      return this.playMediaStreamInVideoElement(this._peerConnectionContext.mediaStream.value);\n    }\n\n    if (this._tokenContext.token.value) {\n      const ignored = this.start();\n    }\n  }\n\n  public async play(): Promise<void> {\n    const mediaStream = this._peerConnectionContext.mediaStream.value;\n\n    if (!mediaStream) {\n      return this.start();\n    }\n\n    return this.playMediaStreamInVideoElement(mediaStream);\n  }\n\n  private getRetryInterval(): number {\n    switch (this._channelContext.state.value) {\n      case ChannelState.StandBy:\n      case ChannelState.Offline:\n        return standbyPollingIntervalInMilliseconds;\n      case ChannelState.Error:\n      case ChannelState.Recovering:\n      case ChannelState.Unauthorized:\n      case ChannelState.GeoRestricted:\n      case ChannelState.GeoBlocked:\n      case ChannelState.Stopped:\n      case ChannelState.Starting:\n      case ChannelState.Playing:\n      case ChannelState.Paused:\n      case ChannelState.Reconnecting:\n      case ChannelState.UnsupportedFeature:\n      case ChannelState.ConfigurationError:\n      case ChannelState.TransientConfigurationError:\n      case ChannelState.ConnectionError:\n      case ChannelState.ClientStartError:\n        // First and second attempt fast, after that exponential with backoff interval\n        return this._exponentialBackoff.getExponentialBackoffIntervalByFailureCount(this._channelContext.failureCount.value);\n      default:\n        assertUnreachable(this._channelContext.state.value);\n    }\n  }\n\n  private async handleStreamFailure(): Promise<void> {\n    switch (this._channelContext.state.value) {\n      case ChannelState.Error:\n      case ChannelState.Reconnecting:\n      case ChannelState.StandBy:\n      case ChannelState.Offline:\n      case ChannelState.Recovering:\n      case ChannelState.TransientConfigurationError:\n      case ChannelState.ConnectionError:\n      case ChannelState.ClientStartError:\n        this._logger.info('Retry start with initial state [%s] [%s]', this._channelContext.state.value, ChannelState[this._channelContext.state.value]);\n\n        break;\n      case ChannelState.Unauthorized:\n        this._logger.info('Channel is unauthorized, skipping retry of start. Please provide a new token and invoke start()');\n\n        return;\n      case ChannelState.GeoRestricted:\n        this._logger.info('Channel is geo restricted, skipping retry of start. Please provide a new token and invoke start()');\n\n        return;\n      case ChannelState.GeoBlocked:\n        this._logger.info('Channel is geo blocked, skipping retry of start. Please provide a new token and invoke start()');\n\n        return;\n      case ChannelState.Stopped:\n        this._logger.info('Channel is stopped, skipping retry of start.');\n\n        return;\n      case ChannelState.Playing:\n        this._logger.info('Channel is playing, skipping retry of start');\n\n        return;\n      case ChannelState.Paused:\n        this._logger.info('Channel is paused, skipping retry of start. Please invoke play()');\n\n        return;\n      case ChannelState.Starting:\n        this._logger.info('Channel is already starting, skipping retry of start');\n\n        return;\n      case ChannelState.UnsupportedFeature:\n        this._logger.info('Channel is stopped due to unsupported feature, skipping retry of start.');\n\n        return;\n      case ChannelState.ConfigurationError:\n        this._logger.info('Channel is stopped due to configuration error, skipping retry of start.');\n\n        return;\n      default:\n        assertUnreachable(this._channelContext.state.value);\n    }\n\n    return this.start();\n  }\n\n  private cleanUpResources(reason: string = defaultStreamTerminationReason): void {\n    this._channelContext.disposables.dispose();\n\n    const peerConnection = this._peerConnectionContext.peerConnection.value;\n\n    if (peerConnection) {\n      this._peerConnectionContext.peerConnection.value = null;\n      peerConnection.close();\n      peerConnection.dispose();\n\n      if (SDK.forceGarbageCollectionOnRestart && !(FeatureEnablement.isMobile && SDK.skipGarbageCollectionOnMobileDevices)) {\n        GarbageCollectorManager.forceGarbageCollection();\n      }\n    }\n\n    if (this._peerConnectionContext.mediaStream.value) {\n      this._peerConnectionContext.mediaStream.value.getTracks().forEach(track => track.stop());\n      this._peerConnectionContext.mediaStream.value = null;\n    }\n\n    this._channelContext.autoPaused.value = false;\n    this._channelContext.autoMuted.value = false;\n    this._channelContext.playing.value = false;\n    this._channelContext.stopped.value = true;\n    this._channelContext.standby.value = false;\n\n    if (this._channelContext.stream.value && this._channelContext.endPoint.value) {\n      const ignored = this._channelContext.endPoint.value.destroyStream(this._channelContext.stream.value, reason)\n        .then(({status}) => {\n          if (status !== 'ok') {\n            this._logger.warn('[%s] Failed to destroy stream with reason [%s]', this.streamId, status);\n\n            return;\n          }\n\n          this._logger.info('[%s] Destroyed stream with reason [%s]', this.streamId, status);\n        })\n        .catch(e => {\n          this._logger.error('[%s] Failed to destroy stream', this.streamId, e);\n        });\n    }\n\n    if (this.videoElement && this.videoElement.dataset) {\n      this.videoElement.dataset.sessionId = '';\n      this.videoElement.dataset.streamId = '';\n    }\n\n    this._channelContext.stream.value = null;\n    this._channelContext.endPoint.value = null;\n    this._peerConnectionContext.peerConnectionReconnectAttempts = 0;\n  }\n\n  private async playMediaStreamInVideoElement(mediaStream: MediaStream): Promise<void> {\n    const videoElement = this._channelContext.videoElement.value;\n\n    if (!videoElement) {\n      this._channelContext.autoMuted.value = false;\n      this._channelContext.autoPaused.value = false;\n      this._channelContext.loading.value = false;\n      this._channelContext.playing.value = false;\n      this._channelContext.state.value = ChannelState.Stopped;\n\n      return;\n    }\n\n    // TESTING: if (!this._streamTransformContext.hasEncodedInsertableStreams.value) {\n    videoElement.srcObject = mediaStream;\n    // TESTING: }\n\n    const playPromise = videoElement.play();\n\n    if (playPromise === undefined) {\n      this._channelContext.autoMuted.value = false;\n      this._channelContext.autoPaused.value = false;\n      this._channelContext.loading.value = false;\n      this._channelContext.playing.value = true;\n      this._channelContext.state.value = ChannelState.Playing;\n\n      return;\n    }\n\n    return playPromise.then(() => {\n      this._channelContext.autoMuted.value = false;\n      this._channelContext.autoPaused.value = false;\n      this._channelContext.loading.value = false;\n      this._channelContext.playing.value = true;\n      this._channelContext.state.value = ChannelState.Playing;\n    }).catch(e => {\n      const hasAudioTrack = !!mediaStream.getTracks().filter(track => {\n        return track.kind === 'audio';\n      });\n      const automaticallyMuteVideoOnPlayFailureOff = !SDK.automaticallyMuteVideoOnPlayFailure;\n\n      if (automaticallyMuteVideoOnPlayFailureOff || videoElement.muted || !hasAudioTrack) {\n        this._channelContext.autoMuted.value = false;\n        this._channelContext.autoPaused.value = true;\n        this._channelContext.loading.value = false;\n        this._channelContext.playing.value = false;\n        this._channelContext.state.value = ChannelState.Paused;\n\n        if (automaticallyMuteVideoOnPlayFailureOff) {\n          this._logger.info('[%s] Paused video after play failed. Manual user action required.', this.streamId, e);\n          videoElement.srcObject = null;\n\n          return;\n        }\n\n        if (hasAudioTrack) {\n          this._logger.info('[%s] Failed to play video. Manual user action required.', this.streamId, e);\n\n          return;\n        }\n\n        this._logger.info('[%s] Failed to play muted video. Manual user action required.', this.streamId, e);\n\n        return;\n      }\n\n      videoElement.muted = true;\n\n      return videoElement.play()\n        .then(() => {\n          this._logger.info('[%s] Played video after auto muting. Manual user action required to unmute.', this.streamId);\n\n          this._channelContext.autoMuted.value = true;\n          this._channelContext.autoPaused.value = false;\n          this._channelContext.loading.value = false;\n          this._channelContext.playing.value = true;\n          this._channelContext.state.value = ChannelState.Playing;\n        }).catch(e => {\n          videoElement.muted = false;\n\n          this._logger.info('[%s] Failed to play video. Manual user action required.', this.streamId, e);\n\n          this._channelContext.autoMuted.value = false;\n          this._channelContext.autoPaused.value = true;\n          this._channelContext.loading.value = false;\n          this._channelContext.playing.value = false;\n          this._channelContext.state.value = ChannelState.Paused;\n        });\n    });\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\nimport Channel, {ChannelOptions} from './Channel';\nimport {IEncodedStreamSink} from '../transformation/EncodedStreamSink';\nimport {IStreamTrackTransform} from '../transformation/StreamTrackTransform';\nimport SDK from '../SDK';\nimport {EncodedEdgeToken} from '../../edgeAuth/EncodedEdgeToken';\nimport {Millisecond} from '../../units/Units';\n\ntype CreateChannelOptions = {\n  videoElement: HTMLVideoElement;\n  token: EncodedEdgeToken;\n  targetLag?: Millisecond;\n  videoStreamTransformCallback?: IStreamTrackTransform<VideoFrame>;\n  audioStreamTransformCallback?: IStreamTrackTransform<AudioData>;\n  encodedVideoStreamSink?: IEncodedStreamSink<RTCEncodedVideoFrame>;\n  encodedAudioStreamSink?: IEncodedStreamSink<RTCEncodedAudioFrame>;\n};\n\nexport default class Channels {\n  static createChannel(options: CreateChannelOptions): Channel {\n    if (!SDK.initialized.value) {\n      throw new Error('SDK is not loaded.');\n    }\n\n    const channelOptions: ChannelOptions = {\n      targetLag: options.targetLag,\n      videoStreamTransformCallback: options.videoStreamTransformCallback,\n      audioStreamTransformCallback: options.audioStreamTransformCallback,\n      encodedVideoStreamSink: options.encodedVideoStreamSink,\n      encodedAudioStreamSink: options.encodedAudioStreamSink\n    };\n\n    return new Channel(options.videoElement, options.token, channelOptions);\n  }\n\n  private constructor() {\n    throw new Error('Channels is a static class that may not be instantiated');\n  }\n}","/**\n * Copyright 2023 Phenix Real Time Solutions, Inc. Confidential and Proprietary. All Rights Reserved.\n */\n\nimport SDK from '../SDK';\nimport Channels from './Channels';\nimport ChannelState from './ChannelState';\n\nexport {\n  SDK,\n  Channels,\n  ChannelState\n};\n\nexport default {\n  SDK,\n  Channels,\n  ChannelState\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(402);\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// Promise = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t595: 0\n};\n\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no deferred startup\n\n// no jsonp function"],"sourceRoot":""}